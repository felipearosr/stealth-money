"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[510],{3129:(e,a,t)=>{t.d(a,{A:()=>S});var n=t(4568),s=t(7620),i=t(6181),r=t(3353),c=t(7227),l=t(5165),o=t(2555),d=t(4675),u=t(4148),m=t(5191),h=t(9690),x=t(6678),f=t(9388),p=t(8262),b=t(4529),y=t(8442),g=t(5945),N=t(3367),v=t(7469),j=t(9513);function C(e){let{account:a,onVerificationComplete:t,onSkip:d}=e,{getToken:x}=(0,i.d)(),[,f]=(0,s.useState)(null),[p,b]=(0,s.useState)(!1),[y,g]=(0,s.useState)(null),[C,A]=(0,s.useState)(null),[B,k]=(0,s.useState)(["",""]),[S,w]=(0,s.useState)("pending");(0,s.useEffect)(()=>{"micro_deposits"===a.verificationMethod&&a.verificationStartedAt&&(f("micro_deposits"),w("deposits_sent"))},[a]);let X=async()=>{b(!0),g(null);try{let e=await x(),t=await fetch("".concat("http://localhost:4000","/api/users/me/bank-accounts/").concat(a.id,"/verify/micro-deposits"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.message||"Failed to start verification")}f("micro_deposits"),w("deposits_sent"),A("Micro-deposits have been sent to your account. They will appear within 1-2 business days.")}catch(e){console.error("Micro-deposit verification error:",e),g(e instanceof Error?e.message:"Failed to start verification")}finally{b(!1)}},T=async()=>{if(!B[0]||!B[1])return void g("Please enter both deposit amounts");b(!0),g(null),w("verifying");try{let e=await x(),n=await fetch("".concat("http://localhost:4000","/api/users/me/bank-accounts/").concat(a.id,"/verify/micro-deposits/confirm"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({amounts:B.map(e=>parseFloat(e))})});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error(e.message||"Verification failed")}w("verified"),A("Account verified successfully!"),setTimeout(()=>{t(a.id)},2e3)}catch(e){console.error("Micro-deposit confirmation error:",e),g(e instanceof Error?e.message:"Verification failed"),w("failed")}finally{b(!1)}},M=async()=>{b(!0),g(null);try{A("Instant verification would launch here (Plaid integration)"),setTimeout(()=>{t(a.id)},3e3)}catch(e){console.error("Instant verification error:",e),g("Instant verification is not available for this account")}finally{b(!1)}},P=e=>{switch(e){case"micro_deposits":return{name:"Micro-Deposits",description:"We send small deposits to verify account ownership",icon:(0,n.jsx)(N.A,{className:"h-5 w-5"})};case"instant":return{name:"Instant Verification",description:"Connect securely through your online banking",icon:(0,n.jsx)(m.A,{className:"h-5 w-5"})};default:return{name:"Unknown",description:"Unknown verification method",icon:(0,n.jsx)(h.A,{className:"h-5 w-5"})}}},U=()=>(0,n.jsxs)("div",{className:"text-center space-y-4",children:[(0,n.jsx)(m.A,{className:"h-16 w-16 text-green-500 mx-auto"}),(0,n.jsx)("h3",{className:"text-xl font-semibold text-green-700",children:"Account Verified!"}),(0,n.jsxs)("p",{className:"text-gray-600",children:["Your ",a.bankName," account has been successfully verified. You can now send and receive money."]}),(0,n.jsxs)(u.E,{className:"bg-green-100 text-green-800",children:["Verified ",a.verificationMethod&&P(a.verificationMethod).name]})]});return(0,n.jsxs)(r.Zp,{className:"w-full max-w-2xl mx-auto",children:[(0,n.jsxs)(r.aR,{children:[(0,n.jsx)(r.ZB,{className:"flex items-center space-x-2",children:(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[a.isVerified?(0,n.jsx)(m.A,{className:"h-5 w-5 text-green-500"}):(0,n.jsx)(j.A,{className:"h-5 w-5 text-yellow-500"}),(0,n.jsxs)("span",{children:[a.accountName," (",a.currency,")"]})]})}),(0,n.jsxs)("div",{className:"text-sm text-gray-600",children:[a.bankName," • ",a.accountHolderName]})]}),(0,n.jsxs)(r.Wu,{className:"space-y-6",children:[y&&(0,n.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 text-red-700",children:[(0,n.jsx)(h.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"font-medium",children:"Verification Error"})]}),(0,n.jsx)("p",{className:"text-red-600 mt-1",children:y})]}),C&&(0,n.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 text-green-700",children:[(0,n.jsx)(m.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"font-medium",children:"Success"})]}),(0,n.jsx)("p",{className:"text-green-600 mt-1",children:C})]}),a.isVerified?U():"failed"===S?(0,n.jsxs)("div",{className:"text-center space-y-4",children:[(0,n.jsx)(h.A,{className:"h-16 w-16 text-red-500 mx-auto"}),(0,n.jsx)("h3",{className:"text-xl font-semibold text-red-700",children:"Verification Failed"}),(0,n.jsx)("p",{className:"text-gray-600",children:"The amounts you entered don't match our records. Please check your account statement and try again."}),(0,n.jsxs)("p",{className:"text-sm text-gray-500",children:["Attempts remaining: ",3-a.verificationFailures]}),(0,n.jsxs)("div",{className:"flex space-x-3 justify-center",children:[(0,n.jsx)(c.$,{onClick:()=>{w("deposits_sent"),k(["",""]),g(null)},disabled:a.verificationFailures>=3,children:"Try Again"}),a.verificationFailures>=3&&(0,n.jsx)(c.$,{variant:"outline",onClick:()=>f(null),children:"Choose Different Method"})]})]}):"deposits_sent"===S?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"text-center mb-6",children:[(0,n.jsx)(m.A,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),(0,n.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Micro-Deposits Sent"}),(0,n.jsx)("p",{className:"text-gray-600",children:"We've sent 2 small deposits to your {account.bankName} account ending in {account.accountNumber?.slice(-4) || '****'}."}),(0,n.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Check your account statement and enter the exact amounts below."})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(o.J,{htmlFor:"deposit1",children:"First Deposit Amount"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),(0,n.jsx)(l.p,{id:"deposit1",type:"number",step:"0.01",min:"0",max:"1",placeholder:"0.XX",className:"pl-8",value:B[0],onChange:e=>k([e.target.value,B[1]])})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(o.J,{htmlFor:"deposit2",children:"Second Deposit Amount"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),(0,n.jsx)(l.p,{id:"deposit2",type:"number",step:"0.01",min:"0",max:"1",placeholder:"0.XX",className:"pl-8",value:B[1],onChange:e=>k([B[0],e.target.value])})]})]})]}),(0,n.jsxs)("div",{className:"flex space-x-3",children:[(0,n.jsx)(c.$,{onClick:T,disabled:p||!B[0]||!B[1],className:"flex-1",children:p?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Verifying..."]}):"Verify Account"}),(0,n.jsx)(c.$,{variant:"outline",onClick:()=>{f(null),w("pending"),k(["",""])},children:"Back"})]}),(0,n.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm",children:(0,n.jsxs)("p",{className:"text-blue-800",children:[(0,n.jsx)("strong",{children:"Can't find the deposits?"})," They may take up to 2 business days to appear.",'Look for deposits from "Stealth Money" or "SM Verify" in your transaction history.']})})]}):"verified"===S?U():(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"text-center mb-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Verify Your Bank Account"}),(0,n.jsx)("p",{className:"text-gray-600",children:"To send and receive money, we need to verify that you own this account."})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)(r.Zp,{className:"cursor-pointer hover:shadow-md transition-shadow border-2 hover:border-blue-200",onClick:()=>!p&&X(),children:(0,n.jsx)(r.Wu,{className:"p-4",children:(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)(N.A,{className:"h-6 w-6 text-green-600"})}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h4",{className:"font-semibold",children:"Micro-Deposits (Recommended)"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"We'll send 2 small deposits (under $1) to your account. Verify the amounts to complete setup."}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Takes 1-2 business days • Most secure method"})]})]})})}),(0,n.jsx)(r.Zp,{className:"cursor-pointer hover:shadow-md transition-shadow border-2 hover:border-blue-200",onClick:()=>!p&&M(),children:(0,n.jsx)(r.Wu,{className:"p-4",children:(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)(m.A,{className:"h-6 w-6 text-blue-600"})}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h4",{className:"font-semibold",children:"Instant Verification"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Connect through your online banking for immediate verification."}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Instant setup • Powered by Plaid"})]}),(0,n.jsx)(u.E,{variant:"secondary",className:"text-xs",children:"Coming Soon"})]})})})]})]}),d&&!a.isVerified&&"pending"===S&&(0,n.jsx)("div",{className:"pt-4 border-t",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"You can verify this account later, but you won't be able to send or receive money until it's verified."}),(0,n.jsx)(c.$,{variant:"outline",onClick:d,children:"Skip for Now"})]})})]})]})}var A=t(5652),B=t(6257);function k(e){let{onComplete:a,onSkip:t,requireVerification:N=!1,requireChileanVerification:v=!1,onAccountAdded:j}=e,{getToken:k}=(0,i.d)(),[S,w]=(0,s.useState)([]),[X,T]=(0,s.useState)(!0),[M,P]=(0,s.useState)(!1),[U,E]=(0,s.useState)(null),[F,I]=(0,s.useState)(!1),[R,L]=(0,s.useState)(""),[V,H]=(0,s.useState)(null),[q,D]=(0,s.useState)({accountName:"",country:"",bankId:"",accountHolderName:"",accountType:"",isPrimary:!1}),[G,K]=(0,s.useState)({}),[O,$]=(0,s.useState)(""),[Y,z]=(0,s.useState)(null),W=R?A.qS[R]:null,_=(0,s.useCallback)(e=>{var a;L(e),H(null);let t=A.qS[e];D({accountName:"",country:e,bankId:"",accountHolderName:"",accountType:(null==t||null==(a=t.accountTypes[0])?void 0:a.value)||"",isPrimary:!Array.isArray(S)||0===S.length}),K({})},[S]),J=(0,s.useCallback)(async()=>{try{let e=await k(),a=await fetch("".concat("http://localhost:4000","/api/users/me/bank-accounts"),{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){let e=await a.json(),t=e.bankAccounts||e;w(Array.isArray(t)?t:[])}else w([])}catch(e){console.error("Error fetching bank accounts:",e),w([])}finally{T(!1)}},[k]);(0,s.useEffect)(()=>{J()},[J]),(0,s.useEffect)(()=>{v&&!R&&_("CL")},[v,R,_]);let Z=()=>{let e={};if(q.accountName.trim()||(e.accountName="Account name is required"),R||(e.country="Please select a country"),V||(e.bankId="Please select a bank"),q.accountHolderName.trim()||(e.accountHolderName="Account holder name is required"),q.accountType||(e.accountType="Account type is required"),W)for(let a of W.requiredFields){let t=q[a.field];if(!t||"string"!=typeof t||!t.trim()){e[a.field]="".concat(a.label," is required");continue}switch(a.validation){case"Chilean RUT":(0,B.validateRUT)(t)||(e[a.field]=(0,B.getRUTValidationError)(t));break;case"IBAN":(0,A.vQ)(t)||(e[a.field]="Invalid IBAN format");break;case"CLABE":(0,A.Ol)(t)||(e[a.field]="CLABE must be 18 digits");break;case"US Routing Number":(0,A.Kt)(t)||(e[a.field]="Routing number must be 9 digits");break;case"UK Sort Code":(0,A.Qc)(t)||(e[a.field]="Sort code must be 6 digits")}}return K(e),0===Object.keys(e).length},Q=async e=>{if(e.preventDefault(),Z()&&V&&W){I(!0);try{let e=await k(),a={accountName:q.accountName,currency:W.currency,country:R,bankName:V.name,bankCode:V.code,accountHolderName:q.accountHolderName,accountType:q.accountType,isPrimary:q.isPrimary};W.requiredFields.forEach(e=>{q[e.field]&&(a[e.field]=q[e.field])});let t=U?"".concat("http://localhost:4000","/api/users/me/bank-accounts/").concat(U.id):"".concat("http://localhost:4000","/api/users/me/bank-accounts"),n=U?"PUT":"POST",s=await fetch(t,{method:n,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(a)});if(s.ok){let e=await s.json();console.log("Bank account created successfully:",e),await J(),ea(),P(!1),E(null),$("✅ ".concat(e.bankName," account added successfully! Verification required to start sending money.")),setTimeout(()=>$(""),5e3),j&&j(),console.log("Bank account creation completed, form closed")}else{let e=await s.json();console.error("Failed to save bank account:",e),K({general:e.message||"Failed to save bank account"})}}catch(e){console.error("Error saving bank account:",e),K({general:"Failed to save bank account. Please try again."})}finally{I(!1)}}},ee=async e=>{if(confirm("Are you sure you want to delete this bank account?"))try{let a=await k();(await fetch("".concat("http://localhost:4000","/api/users/me/bank-accounts/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}})).ok?await J():console.error("Failed to delete bank account")}catch(e){console.error("Error deleting bank account:",e)}},ea=()=>{L(""),H(null),D({accountName:"",country:"",bankId:"",accountHolderName:"",accountType:"",isPrimary:!1}),K({}),$("")},et=e=>{let a=e.country,t=A.qS[a],n=null==t?void 0:t.banks.find(a=>a.code===e.bankCode);L(a),H(n||null);let s={accountName:e.accountName,country:a,bankId:(null==n?void 0:n.id)||"",accountHolderName:e.accountHolderName,accountType:e.accountType||"",isPrimary:e.isPrimary};e.iban&&(s.iban=e.iban),e.accountNumber&&(s.accountNumber=e.accountNumber),e.routingNumber&&(s.routingNumber=e.routingNumber),e.rut&&(s.rut=e.rut),e.clabe&&(s.clabe=e.clabe),e.sortCode&&(s.sortCode=e.sortCode),e.ukAccountNumber&&(s.ukAccountNumber=e.ukAccountNumber),D(s),E(e),P(!0)},en=Array.isArray(S)&&S.some(e=>e.isVerified),es=Array.isArray(S)&&S.some(e=>e.isVerified&&"CL"===e.country&&"CLP"===e.currency),ei=Array.isArray(S)&&S.length>0&&!en,er=Array.isArray(S)&&S.some(e=>!e.isVerified&&"CL"===e.country&&"CLP"===e.currency),ec=async e=>{console.log("Verification completed for account:",e),z(null),await J();let t=await fetch("".concat("http://localhost:4000","/api/users/me/bank-accounts"),{headers:{Authorization:"Bearer ".concat(await k())}});if(t.ok){let e=await t.json(),n=e.bankAccounts||e,s=!1;v?console.log("Chilean verification requirements met:",s=Array.isArray(n)&&n.some(e=>e.isVerified&&"CL"===e.country&&"CLP"===e.currency)):console.log("General verification requirements met:",s=Array.isArray(n)&&n.some(e=>e.isVerified)),s&&a&&(console.log("All requirements met, calling onComplete"),a())}};return X?(0,n.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):Y?(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Verify Bank Account"}),(0,n.jsxs)("p",{className:"text-gray-600",children:["Complete verification for ",Y.bankName," to start sending money."]})]}),(0,n.jsx)(C,{account:Y,onVerificationComplete:ec,onSkip:()=>z(null)}),(0,n.jsx)(c.$,{variant:"outline",onClick:()=>z(null),children:"← Back to Account List"})]}):(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-bold mb-2",children:v?er?"Verify Your Chilean Bank Account":"Chilean Bank Account Setup":ei?"Verify Your Bank Account":"Bank Account Setup"}),(0,n.jsx)("p",{className:"text-gray-600",children:v?er?"Complete Chilean bank account verification to start sending money to other Chilean users.":"Add and verify your Chilean bank account to start sending money to other Chilean users.":ei?"Complete bank account verification to start sending money globally.":"Add and verify your bank accounts to start sending money globally."})]}),O&&(0,n.jsx)(r.Zp,{className:"border-green-200 bg-green-50",children:(0,n.jsx)(r.Wu,{className:"py-4",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(m.A,{className:"h-5 w-5 text-green-600"}),(0,n.jsx)("span",{className:"font-medium text-green-700",children:O})]})})}),ei&&(0,n.jsx)(r.Zp,{className:"border-blue-200 bg-blue-50",children:(0,n.jsx)(r.Wu,{className:"py-6",children:(0,n.jsxs)("div",{className:"text-center space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,n.jsx)(h.A,{className:"h-6 w-6 text-blue-600"}),(0,n.jsx)("span",{className:"text-lg font-semibold text-blue-700",children:"Bank Account Added Successfully!"})]}),(0,n.jsx)("p",{className:"text-blue-600",children:'Your account has been added but needs verification to send money. Click "Verify Account" below to start the verification process.'})]})})}),Array.isArray(S)&&S.length>0&&(0,n.jsx)(r.Zp,{className:(v?es:en)?"border-green-200 bg-green-50":"border-amber-200 bg-amber-50",children:(0,n.jsx)(r.Wu,{className:"py-4",children:(0,n.jsx)("div",{className:"flex items-center gap-2",children:(v?es:en)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.A,{className:"h-5 w-5 text-green-600"}),(0,n.jsx)("span",{className:"font-medium text-green-700",children:v?"You have ".concat(S.filter(e=>e.isVerified&&"CL"===e.country).length," verified Chilean account(s)"):"You have ".concat(S.filter(e=>e.isVerified).length," verified account(s)")})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.A,{className:"h-5 w-5 text-amber-600"}),(0,n.jsx)("span",{className:"font-medium text-amber-700",children:v?"Chilean bank account verification required":"Verification required for your bank account(s)"})]})})})}),Array.isArray(S)&&S.length>0&&(0,n.jsx)("div",{className:"space-y-3",children:S.map(e=>{var a;return(0,n.jsx)(r.Zp,{className:"relative",children:(0,n.jsx)(r.Wu,{className:"py-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(x.A,{className:"h-8 w-8 text-gray-400"}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("h4",{className:"font-semibold",children:e.accountName}),e.isPrimary&&(0,n.jsx)(u.E,{variant:"secondary",children:"Primary"}),(0,n.jsx)(u.E,{variant:e.isVerified?"default":"outline",children:e.isVerified?"Verified":"Pending"})]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[e.bankName," • ",e.currency," •","checking"===e.accountType?" Checking":" Savings"]}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:null==(a=A.qS[e.country])?void 0:a.countryName}),!e.isVerified&&(0,n.jsxs)("p",{className:"text-xs text-amber-600 mt-1 flex items-center gap-1",children:[(0,n.jsx)(h.A,{className:"h-3 w-3"}),"Verification required to send money"]})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[!e.isVerified&&(0,n.jsx)(c.$,{variant:"outline",size:"sm",className:"border-blue-500 text-blue-600 hover:bg-blue-50",onClick:()=>{z(e)},children:"Verify Account"}),(0,n.jsx)(c.$,{variant:"ghost",size:"sm",onClick:()=>et(e),children:(0,n.jsx)(f.A,{className:"h-4 w-4"})}),(0,n.jsx)(c.$,{variant:"ghost",size:"sm",onClick:()=>ee(e.id),children:(0,n.jsx)(p.A,{className:"h-4 w-4 text-red-500"})})]})]})})},e.id)})}),!M&&(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsxs)(c.$,{onClick:()=>{ea(),P(!0)},className:"flex-1",variant:ei?"ghost":"outline",children:[(0,n.jsx)(b.A,{className:"h-4 w-4 mr-2"}),ei?"Add Another Account":"Add Bank Account"]}),t&&!N&&!v&&!ei&&(0,n.jsx)(c.$,{onClick:t,variant:"ghost",children:"Skip for now"})]}),M&&(0,n.jsxs)(r.Zp,{children:[(0,n.jsxs)(r.aR,{children:[(0,n.jsx)(r.ZB,{children:U?"Edit Bank Account":"Add New Bank Account"}),(0,n.jsx)(r.BT,{children:"Select your country first, then choose your bank and provide account details."})]}),(0,n.jsx)(r.Wu,{children:(0,n.jsxs)("form",{onSubmit:Q,className:"space-y-6",children:[G.general&&(0,n.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,n.jsx)("p",{className:"text-sm text-red-600",children:G.general})}),(0,n.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[(0,n.jsx)(y.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{children:"Step 1: Select Your Country"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(o.J,{htmlFor:"country",children:"Country"}),(0,n.jsxs)(d.l6,{value:R,onValueChange:_,children:[(0,n.jsx)(d.bq,{className:G.country?"border-red-500":"",children:(0,n.jsx)(d.yv,{placeholder:"Choose your country"})}),(0,n.jsx)(d.gC,{children:Object.values(A.qS).filter(e=>!v||"CL"===e.countryCode).sort((e,a)=>e.countryName.localeCompare(a.countryName)).map(e=>(0,n.jsx)(d.eb,{value:e.countryCode,children:(0,n.jsxs)("span",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{children:e.flag}),(0,n.jsx)("span",{children:e.countryName}),(0,n.jsxs)("span",{className:"text-gray-500",children:["(",e.currency,")"]})]})},e.countryCode))})]}),G.country&&(0,n.jsx)("p",{className:"text-sm text-red-500 mt-1",children:G.country})]})]}),R&&W&&(0,n.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[(0,n.jsx)(x.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{children:"Step 2: Select Your Bank"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(o.J,{htmlFor:"bank",children:"Bank"}),(0,n.jsxs)(d.l6,{value:q.bankId,onValueChange:e=>{W&&(H(W.banks.find(a=>a.id===e)||null),D(a=>({...a,bankId:e})))},children:[(0,n.jsx)(d.bq,{className:G.bankId?"border-red-500":"",children:(0,n.jsx)(d.yv,{placeholder:"Choose your bank"})}),(0,n.jsx)(d.gC,{children:W.banks.map(e=>(0,n.jsx)(d.eb,{value:e.id,children:e.name},e.id))})]}),G.bankId&&(0,n.jsx)("p",{className:"text-sm text-red-500 mt-1",children:G.bankId})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(o.J,{htmlFor:"accountType",children:"Account Type"}),(0,n.jsxs)(d.l6,{value:q.accountType,onValueChange:e=>D(a=>({...a,accountType:e})),children:[(0,n.jsx)(d.bq,{className:G.accountType?"border-red-500":"",children:(0,n.jsx)(d.yv,{placeholder:"Select account type"})}),(0,n.jsx)(d.gC,{children:W.accountTypes.map(e=>(0,n.jsx)(d.eb,{value:e.value,children:e.label},e.value))})]}),G.accountType&&(0,n.jsx)("p",{className:"text-sm text-red-500 mt-1",children:G.accountType})]})]}),V&&W&&(0,n.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[(0,n.jsx)(g.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{children:"Step 3: Account Details"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(o.J,{htmlFor:"accountName",children:"Account Nickname"}),(0,n.jsx)(l.p,{id:"accountName",value:q.accountName,onChange:e=>D(a=>({...a,accountName:e.target.value})),placeholder:"e.g., My Chilean Account",className:G.accountName?"border-red-500":""}),G.accountName&&(0,n.jsx)("p",{className:"text-sm text-red-500 mt-1",children:G.accountName})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(o.J,{htmlFor:"accountHolderName",children:"Account Holder Name"}),(0,n.jsx)(l.p,{id:"accountHolderName",value:q.accountHolderName,onChange:e=>D(a=>({...a,accountHolderName:e.target.value})),placeholder:"Full name as it appears on the account",className:G.accountHolderName?"border-red-500":""}),G.accountHolderName&&(0,n.jsx)("p",{className:"text-sm text-red-500 mt-1",children:G.accountHolderName})]}),W?W.requiredFields.map(e=>(0,n.jsxs)("div",{children:[(0,n.jsx)(o.J,{htmlFor:e.field,children:e.label}),(0,n.jsx)(l.p,{id:e.field,type:e.type,value:String(q[e.field]||""),onChange:a=>{let t=a.target.value;"rut"===e.field?t=(0,B.formatRUTInput)(t):"sortCode"===e.field&&(t=(0,A.RB)(t)),D(a=>({...a,[e.field]:t}))},placeholder:e.placeholder,maxLength:e.maxLength,className:G[e.field]?"border-red-500":""}),G[e.field]&&(0,n.jsx)("p",{className:"text-sm text-red-500 mt-1",children:G[e.field]})]},e.field)):null,Array.isArray(S)&&S.length>0&&(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("input",{type:"checkbox",id:"isPrimary",checked:q.isPrimary,onChange:e=>D(a=>({...a,isPrimary:e.target.checked})),className:"rounded border-gray-300"}),(0,n.jsxs)(o.J,{htmlFor:"isPrimary",className:"text-sm font-normal",children:["Set as primary account for ",W.currency]})]})]}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)(c.$,{type:"submit",disabled:F,className:"flex-1",children:F?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):U?"Update Account":"Add Account"}),(0,n.jsx)(c.$,{type:"button",variant:"outline",onClick:()=>{P(!1),E(null),ea()},children:"Cancel"})]})]})})]})]})}function S(e){let{children:a,requireVerification:t=!1,onOnboardingComplete:r,skipCheckOnPublicPages:c=!1,blockTransfersUntilVerified:l=!1,requireChileanVerification:o=!1}=e,{getToken:d}=(0,i.d)(),[u,m]=(0,s.useState)(!0),[h,x]=(0,s.useState)(!1),[,f]=(0,s.useState)([]),p=s.useCallback(async()=>{try{m(!0);let e=await d();if(!e)return void x(!1);let a=new AbortController,n=setTimeout(()=>a.abort(),5e3);try{let s=await fetch("".concat("http://localhost:4000","/api/users/me/bank-accounts"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},signal:a.signal});if(clearTimeout(n),s.ok){let e=await s.json();console.log("OnboardingGate: Fetched response:",e);let a=e.bankAccounts||e,n=Array.isArray(a)?a:[];f(n);let i=n.length>0,r=n.some(e=>e.isVerified),c=n.some(e=>e.isVerified&&"CL"===e.country&&"CLP"===e.currency);if(console.log("OnboardingGate: Has accounts:",i,"Has verified:",r,"Has verified Chilean:",c),o){let e=!c;console.log("OnboardingGate: Chilean flow - needs onboarding:",e),x(e)}else if(t||l){let e=!r;console.log("OnboardingGate: Transfer flow - needs onboarding:",e),x(e)}else{let e=!i;console.log("OnboardingGate: Regular flow - needs onboarding:",e),x(e)}}else 401===s.status||console.warn("Onboarding status check failed:",s.status,s.statusText),x(!1)}catch(e){throw clearTimeout(n),e}}catch(e){e instanceof Error&&"AbortError"===e.name?console.warn("Onboarding status check timed out (API may be slow or unavailable)"):console.warn("Onboarding status check error (API may not be running):",e),x(!1)}finally{m(!1)}},[d,o,t,l]);return((0,s.useEffect)(()=>{c?(m(!1),x(!1)):p()},[c,p]),u)?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[200px]",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Checking account status..."})]})}):h?(0,n.jsx)(k,{onComplete:()=>{console.log("OnboardingGate: Onboarding completed, refreshing status..."),p(),r&&r()},onSkip:t||l||o?void 0:()=>{l||o||x(!1)},requireVerification:t||l||o,requireChileanVerification:o,onAccountAdded:()=>{console.log("OnboardingGate: Account added, refreshing status..."),p()}}):(0,n.jsx)(n.Fragment,{children:a})}},5652:(e,a,t)=>{t(6257),a.qS=void 0,a.vQ=function(e){let a=e.replace(/\s/g,"").toUpperCase();if(!/^[A-Z]{2}[0-9]{2}[A-Z0-9]+$/.test(a))return!1;let t={DE:22,ES:24,FR:27,IT:27,GB:22},n=a.substring(0,2);return!t[n]||a.length===t[n]},a.Ol=function(e){let a=e.replace(/\s/g,"");return!!/^\d{18}$/.test(a)},a.Kt=function(e){return/^\d{9}$/.test(e)},a.Qc=function(e){let a=e.replace(/-/g,"");return/^\d{6}$/.test(a)},a.RB=function(e){let a=e.replace(/-/g,"");return a.length>=4?"".concat(a.slice(0,2),"-").concat(a.slice(2,4),"-").concat(a.slice(4,6)):a},a.qS={CL:{countryCode:"CL",countryName:"Chile",currency:"CLP",flag:"\uD83C\uDDE8\uD83C\uDDF1",banks:[{id:"cl-001",name:"Banco de Chile",code:"001"},{id:"cl-012",name:"Banco del Estado (BancoEstado)",code:"012"},{id:"cl-016",name:"Banco de Cr\xe9dito e Inversiones (BCI)",code:"016"},{id:"cl-037",name:"Banco Santander Chile",code:"037"},{id:"cl-039",name:"Banco Ita\xfa Chile",code:"039"},{id:"cl-049",name:"Banco Security",code:"049"},{id:"cl-051",name:"Banco Falabella",code:"051"},{id:"cl-053",name:"Banco Ripley",code:"053"},{id:"cl-054",name:"Banco Consorcio",code:"054"},{id:"cl-055",name:"Banco BICE",code:"055"},{id:"cl-504",name:"Scotiabank Chile",code:"504"}],accountTypes:[{value:"checking",label:"Cuenta Corriente"},{value:"savings",label:"Cuenta de Ahorro"},{value:"vista",label:"Cuenta Vista"},{value:"rut",label:"Cuenta RUT (BancoEstado)"}],requiredFields:[{field:"rut",label:"RUT del Titular",type:"text",placeholder:"12.345.678-9",validation:"Chilean RUT",maxLength:12},{field:"accountNumber",label:"N\xfamero de Cuenta",type:"text",placeholder:"0123456789",maxLength:20}]},US:{countryCode:"US",countryName:"United States",currency:"USD",flag:"\uD83C\uDDFA\uD83C\uDDF8",banks:[{id:"us-boa",name:"Bank of America",code:"BOFAUS3N",swift:"BOFAUS3N"},{id:"us-chase",name:"JPMorgan Chase",code:"CHASUS33",swift:"CHASUS33"},{id:"us-wells",name:"Wells Fargo",code:"WFBIUS6S",swift:"WFBIUS6S"},{id:"us-citi",name:"Citibank",code:"CITIUS33",swift:"CITIUS33"},{id:"us-pnc",name:"PNC Bank",code:"PNCCUS33",swift:"PNCCUS33"},{id:"us-usbank",name:"U.S. Bank",code:"USBKUS44",swift:"USBKUS44"},{id:"us-capital",name:"Capital One",code:"HIBKUS44",swift:"HIBKUS44"},{id:"us-td",name:"TD Bank",code:"NRTHUS33",swift:"NRTHUS33"},{id:"us-regions",name:"Regions Bank",code:"UPNBUS44",swift:"UPNBUS44"},{id:"us-fifth",name:"Fifth Third Bank",code:"FTBCUS3C",swift:"FTBCUS3C"}],accountTypes:[{value:"checking",label:"Checking Account"},{value:"savings",label:"Savings Account"},{value:"money_market",label:"Money Market Account"}],requiredFields:[{field:"routingNumber",label:"Routing Number (ABA)",type:"text",placeholder:"123456789",validation:"US Routing Number",maxLength:9},{field:"accountNumber",label:"Account Number",type:"text",placeholder:"1234567890",maxLength:17}]},DE:{countryCode:"DE",countryName:"Germany",currency:"EUR",flag:"\uD83C\uDDE9\uD83C\uDDEA",banks:[{id:"de-deutsche",name:"Deutsche Bank",code:"DEUTDEFF",swift:"DEUTDEFF"},{id:"de-commerzbank",name:"Commerzbank",code:"COBADEFF",swift:"COBADEFF"},{id:"de-dkb",name:"DKB (Deutsche Kreditbank)",code:"BYLADEM1",swift:"BYLADEM1"},{id:"de-postbank",name:"Postbank",code:"PBNKDEFF",swift:"PBNKDEFF"},{id:"de-sparkasse",name:"Sparkasse",code:"VARIES",swift:"VARIES"},{id:"de-volksbank",name:"Volksbank",code:"VARIES",swift:"VARIES"},{id:"de-hypovereins",name:"HypoVereinsbank",code:"HYVEDEMMXXX",swift:"HYVEDEMMXXX"}],accountTypes:[{value:"girokonto",label:"Girokonto (Checking)"},{value:"sparkonto",label:"Sparkonto (Savings)"},{value:"tagesgeld",label:"Tagesgeldkonto (Daily Savings)"}],requiredFields:[{field:"iban",label:"IBAN",type:"text",placeholder:"DE89 3704 0044 0532 0130 00",validation:"IBAN",maxLength:34}]},ES:{countryCode:"ES",countryName:"Spain",currency:"EUR",flag:"\uD83C\uDDEA\uD83C\uDDF8",banks:[{id:"es-santander",name:"Banco Santander",code:"BSCHESMMXXX",swift:"BSCHESMMXXX"},{id:"es-bbva",name:"BBVA",code:"BBVAESMMXXX",swift:"BBVAESMMXXX"},{id:"es-caixa",name:"CaixaBank",code:"CAIXESBBXXX",swift:"CAIXESBBXXX"},{id:"es-sabadell",name:"Banco Sabadell",code:"BSABESBBXXX",swift:"BSABESBBXXX"},{id:"es-bankinter",name:"Bankinter",code:"BKBKESMMXXX",swift:"BKBKESMMXXX"},{id:"es-unicaja",name:"Unicaja Banco",code:"UCJAES2MXXX",swift:"UCJAES2MXXX"}],accountTypes:[{value:"corriente",label:"Cuenta Corriente"},{value:"ahorro",label:"Cuenta de Ahorro"},{value:"nomina",label:"Cuenta N\xf3mina"}],requiredFields:[{field:"iban",label:"IBAN",type:"text",placeholder:"ES91 2100 0418 4502 0005 1332",validation:"IBAN",maxLength:34}]},FR:{countryCode:"FR",countryName:"France",currency:"EUR",flag:"\uD83C\uDDEB\uD83C\uDDF7",banks:[{id:"fr-bnp",name:"BNP Paribas",code:"BNPAFRPPXXX",swift:"BNPAFRPPXXX"},{id:"fr-credit-agricole",name:"Cr\xe9dit Agricole",code:"AGRIFRPPXXX",swift:"AGRIFRPPXXX"},{id:"fr-societe",name:"Soci\xe9t\xe9 G\xe9n\xe9rale",code:"SOGEFRPPXXX",swift:"SOGEFRPPXXX"},{id:"fr-credit-mutuel",name:"Cr\xe9dit Mutuel",code:"CMCIFRPPXXX",swift:"CMCIFRPPXXX"},{id:"fr-banque-postale",name:"La Banque Postale",code:"PSSTFRPPXXX",swift:"PSSTFRPPXXX"},{id:"fr-lcl",name:"LCL",code:"CRLYFRPPXXX",swift:"CRLYFRPPXXX"}],accountTypes:[{value:"courant",label:"Compte Courant"},{value:"epargne",label:"Compte \xc9pargne"},{value:"livret_a",label:"Livret A"}],requiredFields:[{field:"iban",label:"IBAN",type:"text",placeholder:"FR14 2004 1010 0505 0001 3M02 606",validation:"IBAN",maxLength:34}]},IT:{countryCode:"IT",countryName:"Italy",currency:"EUR",flag:"\uD83C\uDDEE\uD83C\uDDF9",banks:[{id:"it-unicredit",name:"UniCredit",code:"UNCRITMMXXX",swift:"UNCRITMMXXX"},{id:"it-intesa",name:"Intesa Sanpaolo",code:"BCITITMM",swift:"BCITITMM"},{id:"it-mps",name:"Monte dei Paschi di Siena",code:"PASCITMMXXX",swift:"PASCITMMXXX"},{id:"it-bnl",name:"BNL (BNP Paribas)",code:"BNLIITRR",swift:"BNLIITRR"},{id:"it-banco-bpm",name:"Banco BPM",code:"BAPPIT21",swift:"BAPPIT21"}],accountTypes:[{value:"corrente",label:"Conto Corrente"},{value:"risparmio",label:"Conto di Risparmio"},{value:"deposito",label:"Conto Deposito"}],requiredFields:[{field:"iban",label:"IBAN",type:"text",placeholder:"IT60 X054 2811 1010 0000 0123 456",validation:"IBAN",maxLength:34}]},MX:{countryCode:"MX",countryName:"Mexico",currency:"MXN",flag:"\uD83C\uDDF2\uD83C\uDDFD",banks:[{id:"mx-bbva",name:"BBVA M\xe9xico",code:"012",swift:"BCMRMXMM"},{id:"mx-santander",name:"Santander M\xe9xico",code:"014",swift:"BMSXMXMM"},{id:"mx-banamex",name:"Citibanamex",code:"002",swift:"BNMXMXMM"},{id:"mx-banorte",name:"Banorte",code:"072",swift:"MENOMXMT"},{id:"mx-hsbc",name:"HSBC M\xe9xico",code:"021",swift:"BIMEMXMM"},{id:"mx-scotiabank",name:"Scotiabank",code:"044",swift:"MBCOMXMM"},{id:"mx-inbursa",name:"Inbursa",code:"036",swift:"INBUMXMM"},{id:"mx-azteca",name:"Banco Azteca",code:"127",swift:"AZTKMXMM"}],accountTypes:[{value:"checking",label:"Cuenta de Cheques"},{value:"savings",label:"Cuenta de Ahorro"},{value:"payroll",label:"Cuenta de N\xf3mina"}],requiredFields:[{field:"clabe",label:"CLABE",type:"text",placeholder:"012345678901234567",validation:"CLABE",maxLength:18}]},GB:{countryCode:"GB",countryName:"United Kingdom",currency:"GBP",flag:"\uD83C\uDDEC\uD83C\uDDE7",banks:[{id:"gb-hsbc",name:"HSBC UK",code:"HBUKGB4B",swift:"HBUKGB4B"},{id:"gb-barclays",name:"Barclays",code:"BUKBGB22",swift:"BUKBGB22"},{id:"gb-lloyds",name:"Lloyds Bank",code:"LOYDGB2L",swift:"LOYDGB2L"},{id:"gb-natwest",name:"NatWest",code:"NWBKGB2L",swift:"NWBKGB2L"},{id:"gb-santander",name:"Santander UK",code:"ABBYGB2L",swift:"ABBYGB2L"},{id:"gb-halifax",name:"Halifax",code:"HLFXGB21",swift:"HLFXGB21"},{id:"gb-nationwide",name:"Nationwide",code:"NAIAGB21",swift:"NAIAGB21"},{id:"gb-metro",name:"Metro Bank",code:"MYMBGB2L",swift:"MYMBGB2L"}],accountTypes:[{value:"current",label:"Current Account"},{value:"savings",label:"Savings Account"},{value:"isa",label:"ISA Account"}],requiredFields:[{field:"sortCode",label:"Sort Code",type:"text",placeholder:"12-34-56",validation:"UK Sort Code",maxLength:8},{field:"accountNumber",label:"Account Number",type:"text",placeholder:"12345678",validation:"UK Account Number",maxLength:8}]}}},6257:(e,a)=>{function t(e){let a;if(!e||"string"!=typeof e)return!1;let t=e.replace(/[\.\-\s]/g,"").toUpperCase();if(t.length<8||t.length>9)return!1;let n=t.slice(0,-1),s=t.slice(-1);if(!/^\d+$/.test(n)||!/^[0-9K]$/.test(s))return!1;let i=0,r=2;for(let e=n.length-1;e>=0;e--)i+=parseInt(n[e])*r,r=7===r?2:r+1;let c=11-i%11;return s===(11===c?"0":10===c?"K":c.toString())}function n(e){return e&&"string"==typeof e?e.replace(/[\.\-\s]/g,"").toUpperCase():""}function s(e){var a;return!!e&&!!(null==(a=e.verifiedPaymentMethods)?void 0:a.some(e=>"CLP"===e.currency&&"CL"===e.country))}Object.defineProperty(a,"__esModule",{value:!0}),a.validateRUT=t,a.formatRUT=function(e){if(!e||"string"!=typeof e)return"";let a=e.replace(/[^0-9K]/gi,"").toUpperCase();if(a.length<2)return a;let t=a.slice(0,-1),n=a.slice(-1),s=t.replace(/\B(?=(\d{3})+(?!\d))/g,".");return"".concat(s,"-").concat(n)},a.cleanRUT=n,a.formatRUTInput=function(e){if(!e)return"";let a=e.replace(/[^0-9K]/gi,"").toUpperCase().slice(0,9);if(a.length>=2){let e=a.slice(0,-1),t=a.slice(-1),n=e.replace(/\B(?=(\d{3})+(?!\d))/g,".");return"".concat(n,"-").concat(t)}return a},a.isValidRUTFormat=function(e){if(!e||"string"!=typeof e)return!1;let a=n(e);if(a.length<7||a.length>9)return!1;let t=a.slice(0,-1),s=a.slice(-1);return!!/^\d+$/.test(t)&&!!/^[0-9K]$/.test(s)},a.getRUTValidationError=function(e){if(!e||""===e.trim())return"RUT es requerido";let a=n(e);if(a.length<7)return"RUT debe tener al menos 7 d\xedgitos";if(a.length>9)return"RUT no puede tener m\xe1s de 9 caracteres";let s=a.slice(0,-1),i=a.slice(-1);return/^\d+$/.test(s)?/^[0-9K]$/.test(i)?t(e)?"RUT no es v\xe1lido":"D\xedgito verificador no es v\xe1lido":"D\xedgito verificador debe ser un n\xfamero del 0-9 o K":"RUT debe contener solo n\xfameros antes del d\xedgito verificador"},a.getExampleRUTs=function(){return["12.345.678-5","11.111.111-1","22.222.222-2","9.876.543-3","1.234.567-4"]},a.isValidChileanUser=s,a.filterChileanUsers=function(e){return e.filter(s)},a.isChileanUsernamePattern=function(e){if(!e||"string"!=typeof e)return!1;let a=e.trim().toLowerCase();return[/^[a-z]+\.[a-z]+$/,/^[a-z]+_[a-z]+$/,/^[a-z]+[0-9]+$/,/^[a-z]{2,}$/].some(e=>e.test(a))},a.getChileanSearchSuggestions=function(e){if(!e||e.length<2)return[];let a=[],t=e.toLowerCase();return["juan","maria","carlos","ana","luis","carmen","jose","francisca","pedro","patricia","diego","carolina","miguel","andrea","pablo","monica"].forEach(e=>{e.startsWith(t)&&(a.push(e),a.push("".concat(e,".").concat(e)),a.push("".concat(e,"_").concat(e)))}),a.slice(0,5)},a.formatChileanUserDisplay=function(e){var a;let t=e.fullName||e.username||e.email||"",n="";e.username&&e.fullName&&e.fullName!==e.username?n="@".concat(e.username):e.username&&!e.fullName?n=e.email||"":e.email&&!e.username&&(n=e.email);let s=[];e.isVerified&&s.push("Verificado");let i=(null==(a=e.verifiedPaymentMethods)?void 0:a.filter(e=>"CLP"===e.currency&&"CL"===e.country))||[];return i.length>0&&s.push("".concat(i.length," cuenta").concat(i.length>1?"s":""," CLP")),{displayName:t,subtitle:n,badges:s}}}}]);