(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[958],{2942:(e,s,a)=>{"use strict";var t=a(2418);a.o(t,"useParams")&&a.d(s,{useParams:function(){return t.useParams}}),a.o(t,"usePathname")&&a.d(s,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}}),a.o(t,"useSelectedLayoutSegments")&&a.d(s,{useSelectedLayoutSegments:function(){return t.useSelectedLayoutSegments}})},3319:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(8889).A)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},3872:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(8889).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},4673:(e,s,a)=>{Promise.resolve().then(a.bind(a,5320))},5191:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(8889).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5320:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>L});var t=a(4568),l=a(7620),r=a(2942),n=a(9312),c=a(7717),i=a(818),d=a(7227),o=a(3353),m=a(5165),u=a(2555),x=a(4675),h=a(9594),p=a(5774),j=a(3319),f=a(5945),g=a(8276),b=a(7277);let y=c.Ik({recipientName:c.Yj().min(2,"Name must be at least 2 characters"),recipientEmail:c.Yj().email("Please enter a valid email address"),recipientPhone:c.Yj().min(10,"Please enter a valid phone number"),payoutMethod:c.k5(["bank_account","mobile_wallet","cash_pickup","debit_card"],{message:"Please select a payout method"}),payoutDetails:c.Ik({bankName:c.Yj().optional(),accountNumber:c.Yj().optional(),routingNumber:c.Yj().optional(),walletProvider:c.Yj().optional(),walletNumber:c.Yj().optional(),pickupLocation:c.Yj().optional()}).optional()});function N(e){let{transferData:s,onBack:a,onContinue:n}=e,c=(0,r.useRouter)(),[N,v]=(0,l.useState)(""),[w,k]=(0,l.useState)(""),[A,C]=(0,l.useState)(""),[S,D]=(0,l.useState)(""),[P,I]=(0,l.useState)(""),[L,F]=(0,l.useState)(""),[M,R]=(0,l.useState)(""),[T,E]=(0,l.useState)(""),[_,W]=(0,l.useState)(""),[z,B]=(0,l.useState)(""),[Z,J]=(0,l.useState)(!1),[U,O]=(0,l.useState)(null),[Y,q]=(0,l.useState)({}),$=async e=>{if(e.preventDefault(),q({}),O(null),"bank_account"!==S)return void O("Currently only bank account transfers are supported. Please select bank account.");if(!N||!w||!P||!L||!M)return void O("Please fill in all required fields for bank account transfer.");if(n){J(!0);try{n({name:N,email:w,bankAccount:{iban:L,bic:M,bankName:P,accountHolderName:N,country:"DE"}})}catch(e){O("Failed to process recipient information. Please try again."),console.error("Recipient processing error:",e)}finally{J(!1)}return}let a={recipientName:N,recipientEmail:w,recipientPhone:A,payoutMethod:S,payoutDetails:{bankName:P||void 0,accountNumber:L||void 0,routingNumber:M||void 0,walletProvider:T||void 0,walletNumber:_||void 0,pickupLocation:z||void 0}};try{y.parse(a)}catch(e){if(e instanceof i.G){let s={};e.issues.forEach(e=>{e.path[0]&&(s[e.path[0]]=e.message)}),q(s);return}}J(!0);try{let e=await fetch("".concat("http://localhost:4000","/api/transfers"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:s.amount,sourceCurrency:s.sourceCurrency,destCurrency:s.destCurrency,recipientName:N,recipientEmail:w,recipientPhone:A,payoutMethod:S,payoutDetails:a.payoutDetails})});if(!e.ok)throw Error("Failed to create transfer");let t=await e.json();c.push("/pay/".concat(t.transactionId,"?clientSecret=").concat(t.clientSecret))}catch(e){O("Failed to create transfer. Please try again."),console.error("Transfer creation error:",e)}finally{J(!1)}};return(0,t.jsxs)(o.Zp,{className:"w-full max-w-2xl mx-auto",children:[(0,t.jsxs)(o.aR,{children:[(0,t.jsxs)(o.ZB,{className:"flex items-center space-x-2",children:[(0,t.jsx)(h.A,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Recipient Information"})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Who are you sending ",s.amount," ",s.sourceCurrency," to?"]})]}),(0,t.jsxs)("form",{onSubmit:$,children:[(0,t.jsxs)(o.Wu,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,t.jsx)("h3",{className:"font-semibold mb-2",children:"Transfer Summary"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"You Send:"}),(0,t.jsxs)("span",{className:"font-medium",children:[s.amount," ",s.sourceCurrency]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"They Receive:"}),(0,t.jsxs)("span",{className:"font-medium",children:[s.recipientAmount," ",s.destCurrency]})]}),(0,t.jsxs)("div",{className:"flex justify-between col-span-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Exchange Rate:"}),(0,t.jsxs)("span",{className:"font-medium",children:["1 ",s.sourceCurrency," = ",s.rate.toFixed(4)," ",s.destCurrency]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Recipient Details"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"recipient-name",children:"Full Name *"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,t.jsx)(m.p,{id:"recipient-name",placeholder:"Enter recipient's full name",className:"pl-10",value:N,onChange:e=>v(e.target.value)})]}),Y.recipientName&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:Y.recipientName})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"recipient-email",children:"Email Address *"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(p.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,t.jsx)(m.p,{id:"recipient-email",type:"email",placeholder:"recipient@example.com",className:"pl-10",value:w,onChange:e=>k(e.target.value)})]}),Y.recipientEmail&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:Y.recipientEmail})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"recipient-phone",children:"Phone Number *"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(j.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,t.jsx)(m.p,{id:"recipient-phone",type:"tel",placeholder:"+1 (555) 123-4567",className:"pl-10",value:A,onChange:e=>C(e.target.value)})]}),Y.recipientPhone&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:Y.recipientPhone})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"How should they receive the money?"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"payout-method",children:"Payout Method *"}),(0,t.jsxs)(x.l6,{value:S,onValueChange:D,children:[(0,t.jsx)(x.bq,{children:(0,t.jsx)(x.yv,{placeholder:"Select payout method"})}),(0,t.jsxs)(x.gC,{children:[(0,t.jsx)(x.eb,{value:"bank_account",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(f.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Bank Account"})]})}),(0,t.jsx)(x.eb,{value:"mobile_wallet",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(j.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Mobile Wallet"})]})}),(0,t.jsx)(x.eb,{value:"cash_pickup",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(h.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Cash Pickup"})]})}),(0,t.jsx)(x.eb,{value:"debit_card",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(f.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Debit Card"})]})})]})]}),Y.payoutMethod&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:Y.payoutMethod})]}),S&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h4",{className:"font-medium",children:"Payout Details"}),(()=>{switch(S){case"bank_account":return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"bank-name",children:"Bank Name"}),(0,t.jsx)(m.p,{id:"bank-name",placeholder:"e.g., Chase Bank",value:P,onChange:e=>I(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"account-number",children:"Account Number"}),(0,t.jsx)(m.p,{id:"account-number",placeholder:"Account number",value:L,onChange:e=>F(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"routing-number",children:"Routing Number"}),(0,t.jsx)(m.p,{id:"routing-number",placeholder:"Routing number",value:M,onChange:e=>R(e.target.value)})]})]});case"mobile_wallet":return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"wallet-provider",children:"Wallet Provider"}),(0,t.jsxs)(x.l6,{value:T,onValueChange:E,children:[(0,t.jsx)(x.bq,{children:(0,t.jsx)(x.yv,{placeholder:"Select wallet provider"})}),(0,t.jsxs)(x.gC,{children:[(0,t.jsx)(x.eb,{value:"paypal",children:"PayPal"}),(0,t.jsx)(x.eb,{value:"venmo",children:"Venmo"}),(0,t.jsx)(x.eb,{value:"cashapp",children:"Cash App"}),(0,t.jsx)(x.eb,{value:"zelle",children:"Zelle"}),(0,t.jsx)(x.eb,{value:"pix",children:"PIX (Brazil)"}),(0,t.jsx)(x.eb,{value:"paym",children:"Paym (UK)"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"wallet-number",children:"Wallet ID / Phone Number"}),(0,t.jsx)(m.p,{id:"wallet-number",placeholder:"Wallet ID or phone number",value:_,onChange:e=>W(e.target.value)})]})]});case"cash_pickup":return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"pickup-location",children:"Pickup Location"}),(0,t.jsxs)(x.l6,{value:z,onValueChange:B,children:[(0,t.jsx)(x.bq,{children:(0,t.jsx)(x.yv,{placeholder:"Select pickup location"})}),(0,t.jsxs)(x.gC,{children:[(0,t.jsx)(x.eb,{value:"western_union",children:"Western Union"}),(0,t.jsx)(x.eb,{value:"moneygram",children:"MoneyGram"}),(0,t.jsx)(x.eb,{value:"ria",children:"Ria Money Transfer"}),(0,t.jsx)(x.eb,{value:"remitly",children:"Remitly"}),(0,t.jsx)(x.eb,{value:"worldremit",children:"WorldRemit"})]})]})]}),(0,t.jsx)("div",{className:"bg-blue-50 p-3 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-blue-700",children:["The recipient will receive a pickup code via SMS and can collect cash at any ",null==z?void 0:z.replace("_"," ")," location."]})})]});case"debit_card":return(0,t.jsx)("div",{className:"bg-green-50 p-3 rounded-lg",children:(0,t.jsx)("p",{className:"text-sm text-green-700",children:"Funds will be sent directly to the recipient's debit card. No additional details required."})});default:return null}})()]})]}),U&&(0,t.jsx)("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-200",children:U})]}),(0,t.jsxs)(o.wL,{className:"flex justify-between",children:[(0,t.jsxs)(d.$,{type:"button",variant:"outline",onClick:a,disabled:Z,children:[(0,t.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Back"]}),(0,t.jsx)(d.$,{type:"submit",disabled:Z||!N||!w||!A||!S,children:Z?"Creating Transfer...":(0,t.jsxs)(t.Fragment,{children:["Continue to Payment",(0,t.jsx)(b.A,{className:"ml-2 h-4 w-4"})]})})]})]})]})}var v=a(7466),w=a(9513),k=a(7469),A=a(5191),C=a(9690);function S(e){let{transferId:s,onRefresh:a,autoRefresh:r=!0,refreshInterval:n=5e3}=e,[c,i]=(0,l.useState)(null),[m,u]=(0,l.useState)(!0),[x,h]=(0,l.useState)(null),[p,j]=(0,l.useState)(new Date),[f,g]=(0,l.useState)(!1),y=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];try{e&&u(!0),h(null);let a=await fetch("".concat("http://localhost:4000","/api/transfers/").concat(s,"/status"));if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e.message||"Failed to fetch transfer status")}let t=await a.json();i(t),j(new Date),g(!0)}catch(e){console.error("Transfer status fetch error:",e),h(e instanceof Error?e.message:"Failed to fetch transfer status"),g(!1)}finally{e&&u(!1)}},N=()=>{y(!0),a&&a()};(0,l.useEffect)(()=>{y(!0)},[s]),(0,l.useEffect)(()=>{if(r&&c&&"completed"!==c.status&&"failed"!==c.status){let e=setInterval(()=>{y(!1)},n);return()=>clearInterval(e)}},[r,n,null==c?void 0:c.status]);let v=(e,s)=>new Intl.NumberFormat("en-US",{style:"currency",currency:s,minimumFractionDigits:2,maximumFractionDigits:2}).format(e),S=e=>new Date(e).toLocaleString(),D=e=>{switch(e){case"success":return{color:"text-green-600",icon:A.A};case"pending":return{color:"text-yellow-600",icon:w.A};case"failed":return{color:"text-red-600",icon:C.A};default:return{color:"text-gray-600",icon:w.A}}};if(m&&!c)return(0,t.jsx)(o.Zp,{className:"w-full max-w-2xl mx-auto",children:(0,t.jsxs)(o.Wu,{className:"flex items-center justify-center py-8",children:[(0,t.jsx)(k.A,{className:"h-6 w-6 animate-spin text-muted-foreground mr-2"}),(0,t.jsx)("span",{className:"text-muted-foreground",children:"Loading transfer status..."})]})});if(x&&!c)return(0,t.jsx)(o.Zp,{className:"w-full max-w-2xl mx-auto",children:(0,t.jsx)(o.Wu,{className:"py-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(C.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"Error Loading Transfer"}),(0,t.jsx)("p",{className:"text-red-600 mb-4",children:x}),(0,t.jsxs)(d.$,{onClick:N,variant:"outline",children:[(0,t.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"Try Again"]})]})})});if(!c)return(0,t.jsx)(o.Zp,{className:"w-full max-w-2xl mx-auto",children:(0,t.jsx)(o.Wu,{className:"py-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(C.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Transfer Not Found"}),(0,t.jsxs)("p",{className:"text-gray-600",children:["No transfer data available for ID: ",s]})]})})});let P=(e=>{switch(e){case"initiated":return{color:"text-blue-600",bgColor:"bg-blue-50",icon:w.A,label:"Initiated"};case"payment_processing":return{color:"text-yellow-600",bgColor:"bg-yellow-50",icon:k.A,label:"Processing Payment"};case"transferring":return{color:"text-blue-600",bgColor:"bg-blue-50",icon:b.A,label:"Transferring"};case"paying_out":return{color:"text-purple-600",bgColor:"bg-purple-50",icon:k.A,label:"Paying Out"};case"completed":return{color:"text-green-600",bgColor:"bg-green-50",icon:A.A,label:"Completed"};case"failed":return{color:"text-red-600",bgColor:"bg-red-50",icon:C.A,label:"Failed"};default:return{color:"text-gray-600",bgColor:"bg-gray-50",icon:w.A,label:"Unknown"}}})(c.status),I=P.icon,L=(e=>{switch(e){case"initiated":return 20;case"payment_processing":return 40;case"transferring":return 60;case"paying_out":return 80;case"completed":return 100;default:return 0}})(c.status);return(0,t.jsxs)(o.Zp,{className:"w-full max-w-2xl mx-auto shadow-sm",children:[(0,t.jsxs)(o.aR,{className:"pb-4",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,t.jsxs)(o.ZB,{className:"flex items-center gap-2 text-lg",children:[(0,t.jsx)(I,{className:"h-5 w-5 ".concat(P.color)}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Transfer Status"}),(0,t.jsx)("span",{className:"sm:hidden",children:"Status"})]}),(0,t.jsxs)(d.$,{onClick:N,variant:"outline",size:"sm",disabled:m,className:"self-start sm:self-auto",children:[(0,t.jsx)(k.A,{className:"h-4 w-4 mr-2 ".concat(m?"animate-spin":"")}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Refresh"}),(0,t.jsx)("span",{className:"sm:hidden",children:"Update"})]})]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground break-all sm:break-normal",children:["ID: ",c.transferId]})]}),(0,t.jsxs)(o.Wu,{className:"space-y-6",children:[(0,t.jsx)("div",{className:"rounded-lg p-4 ".concat(P.bgColor),children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(I,{className:"h-6 w-6 ".concat(P.color)}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold ".concat(P.color),children:P.label}),c.estimatedCompletion&&"completed"!==c.status&&(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Estimated completion: ",S(c.estimatedCompletion)]}),c.completedAt&&(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Completed: ",S(c.completedAt)]})]})]})})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm text-muted-foreground",children:[(0,t.jsx)("span",{children:"Progress"}),(0,t.jsxs)("span",{children:[L,"%"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"h-2 rounded-full transition-all duration-500 ".concat("failed"===c.status?"bg-red-500":"bg-blue-500"),style:{width:"".concat(L,"%")}})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"You sent"}),(0,t.jsx)("p",{className:"font-semibold",children:v(c.sendAmount,"USD")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Recipient gets"}),(0,t.jsx)("p",{className:"font-semibold text-green-600",children:v(c.receiveAmount,"EUR")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Exchange rate"}),(0,t.jsxs)("p",{className:"font-semibold",children:["1 USD = ",c.exchangeRate.toFixed(4)," EUR"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Fees"}),(0,t.jsx)("p",{className:"font-semibold",children:v(c.fees,"USD")})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Timeline"}),f&&(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-green-600",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Live updates"]})]}),(0,t.jsx)("div",{className:"relative",children:0===c.timeline.length?(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,t.jsx)(w.A,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{children:"No timeline events yet"})]}):(0,t.jsx)("div",{className:"space-y-4",children:c.timeline.map((e,s)=>{let a=D(e.status),l=a.icon,r=s===c.timeline.length-1,n=new Date(e.timestamp)>new Date(Date.now()-3e5);return(0,t.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-lg transition-all duration-300 ".concat(n?"bg-blue-50 border border-blue-200":"hover:bg-gray-50"),children:[(0,t.jsxs)("div",{className:"flex flex-col items-center relative",children:[(0,t.jsx)("div",{className:"p-1 rounded-full ".concat("success"===e.status?"bg-green-100":"pending"===e.status?"bg-yellow-100":"bg-red-100"),children:(0,t.jsx)(l,{className:"h-4 w-4 ".concat(a.color)})}),!r&&(0,t.jsx)("div",{className:"w-px h-8 mt-2 ".concat("success"===e.status?"bg-green-300":"bg-gray-300")})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1",children:[(0,t.jsx)("p",{className:"font-medium text-sm sm:text-base",children:e.message}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[n&&(0,t.jsx)("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full",children:"New"}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:S(e.timestamp)})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,t.jsx)("p",{className:"text-xs capitalize font-medium ".concat(a.color),children:e.status}),e.metadata&&Object.keys(e.metadata).length>0&&(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"• Additional details available"})]})]})]},e.id)})})})]}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground text-center border-t pt-4",children:["Last updated: ",S(c.lastUpdated),r&&"completed"!==c.status&&"failed"!==c.status&&(0,t.jsxs)("span",{className:"ml-2",children:["• Auto-refreshing every ",n/1e3,"s"]})]})]})]})}let D=[{key:"calculator",label:"Calculate",shortLabel:"Calc",icon:a(8421).A,description:"Enter transfer amount"},{key:"recipient",label:"Recipient",shortLabel:"Recipient",icon:h.A,description:"Add recipient details"},{key:"payment",label:"Payment",shortLabel:"Pay",icon:f.A,description:"Complete payment"},{key:"status",label:"Status",shortLabel:"Status",icon:A.A,description:"Track transfer"}];function P(e){var s;let{currentStep:a,completedSteps:l,onStepClick:r}=e,n=D.findIndex(e=>e.key===a),c=(e,s)=>l.includes(e.key)?"completed":e.key===a?"current":s<n?"completed":"upcoming",i=(e,s)=>{let a="relative flex items-center justify-center w-10 h-10 rounded-full border-2 transition-all duration-200",t=s?"cursor-pointer hover:scale-105":"";switch(e){case"completed":return"".concat(a," ").concat(t," bg-green-500 border-green-500 text-white");case"current":return"".concat(a," ").concat(t," bg-blue-500 border-blue-500 text-white ring-4 ring-blue-100");default:return"".concat(a," bg-gray-100 border-gray-300 text-gray-400")}},d=e=>{let s=e<n||l.includes(D[e].key);return"flex-1 h-0.5 mx-2 transition-colors duration-300 ".concat(s?"bg-green-500":"bg-gray-300")},o=e=>{r&&(l.includes(e.key)||e.key===a)&&r(e.key)};return(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("div",{className:"hidden md:block",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:D.map((e,s)=>{let r=c(e,s),n=l.includes(e.key)||e.key===a,m=e.icon;return(0,t.jsxs)("div",{className:"flex items-center flex-1",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("div",{className:i(r,n),onClick:()=>o(e),role:n?"button":void 0,tabIndex:n?0:void 0,onKeyDown:s=>{n&&("Enter"===s.key||" "===s.key)&&(s.preventDefault(),o(e))},children:"completed"===r?(0,t.jsx)(A.A,{className:"w-5 h-5"}):(0,t.jsx)(m,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{className:"mt-2 text-center",children:[(0,t.jsx)("div",{className:"text-sm font-medium ".concat("current"===r?"text-blue-600":"completed"===r?"text-green-600":"text-gray-500"),children:e.label}),(0,t.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:e.description})]})]}),s<D.length-1&&(0,t.jsx)("div",{className:d(s)})]},e.key)})})}),(0,t.jsxs)("div",{className:"md:hidden",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-4",children:D.map((e,s)=>{let r=c(e,s),d=l.includes(e.key)||e.key===a,m=e.icon;return(0,t.jsxs)("div",{className:"flex items-center flex-1",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("div",{className:i(r,d),onClick:()=>o(e),role:d?"button":void 0,tabIndex:d?0:void 0,onKeyDown:s=>{d&&("Enter"===s.key||" "===s.key)&&(s.preventDefault(),o(e))},children:"completed"===r?(0,t.jsx)(A.A,{className:"w-4 h-4"}):(0,t.jsx)(m,{className:"w-4 h-4"})}),(0,t.jsx)("div",{className:"mt-1 text-center",children:(0,t.jsx)("div",{className:"text-xs font-medium ".concat("current"===r?"text-blue-600":"completed"===r?"text-green-600":"text-gray-500"),children:e.shortLabel})})]}),s<D.length-1&&(0,t.jsx)("div",{className:"flex-1 h-0.5 mx-1 ".concat(s<n||l.includes(D[s].key)?"bg-green-500":"bg-gray-300")})]},e.key)})}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Step ",n+1," of ",D.length,": ",null==(s=D[n])?void 0:s.description]})})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[(0,t.jsx)("span",{children:"Progress"}),(0,t.jsxs)("span",{children:[Math.round((n+1)/D.length*100),"%"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-2 rounded-full transition-all duration-500 ease-out",style:{width:"".concat((n+1)/D.length*100,"%")}})})]})]})}function I(e){let{initialStep:s="calculator",onComplete:a,className:c=""}=e;(0,r.useRouter)();let[i,m]=(0,l.useState)({currentStep:s,transferData:null,recipientData:null,transferId:null,completedSteps:[],canGoBack:!1,isLoading:!1,error:null}),u=(0,l.useCallback)(e=>{m(s=>({...s,...e}))},[]),x=(0,l.useCallback)(e=>{u({currentStep:e,canGoBack:"calculator"!==e,error:null})},[u]),h=(0,l.useCallback)(()=>{let e=["calculator","recipient","payment","status"],s=e.indexOf(i.currentStep);s>0&&x(e[s-1])},[i.currentStep,x]),p=(0,l.useCallback)(e=>{m(s=>({...s,completedSteps:s.completedSteps.includes(e)?s.completedSteps:[...s.completedSteps,e]}))},[]),j=(0,l.useCallback)(e=>{u({transferData:e,isLoading:!0}),p("calculator"),setTimeout(()=>{u({isLoading:!1}),x("recipient")},500)},[u,p,x]),f=(0,l.useCallback)(()=>{h()},[h]),b=(0,l.useCallback)(e=>{u({recipientData:e,isLoading:!0}),p("recipient"),setTimeout(()=>{u({isLoading:!1}),x("payment")},500)},[u,p,x]);(0,l.useCallback)(()=>{h()},[h]);let y=(0,l.useCallback)(async e=>{u({isLoading:!0});try{var s,t;let l=await fetch("".concat("http://localhost:4000","/api/transfers/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sendAmount:null==(s=i.transferData)?void 0:s.sendAmount,rateId:null==(t=i.transferData)?void 0:t.rateId,cardDetails:e.cardDetails,recipientInfo:i.recipientData})});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.message||"Failed to create transfer")}let r=await l.json();p("payment"),u({transferId:r.transferId,isLoading:!1}),x("status"),a&&a(r.transferId)}catch(e){console.error("Transfer creation error:",e),u({error:e instanceof Error?e.message:"Failed to create transfer",isLoading:!1})}},[i.transferData,i.recipientData,u,p,x,a]);(0,l.useCallback)(e=>{u({error:e})},[u]);let w=(0,l.useCallback)(()=>{console.log("Status refresh requested")},[]),k=(0,l.useCallback)(()=>{m({currentStep:"calculator",transferData:null,recipientData:null,transferId:null,completedSteps:[],canGoBack:!1,isLoading:!1,error:null})},[]);return(0,t.jsxs)("div",{className:"w-full max-w-4xl mx-auto space-y-6 ".concat(c),children:[(0,t.jsx)(P,{currentStep:i.currentStep,completedSteps:i.completedSteps,onStepClick:e=>{(i.completedSteps.includes(e)||e===i.currentStep)&&x(e)}}),i.canGoBack&&"status"!==i.currentStep&&(0,t.jsx)("div",{className:"flex justify-start",children:(0,t.jsxs)(d.$,{variant:"outline",onClick:h,disabled:i.isLoading,className:"flex items-center gap-2",children:[(0,t.jsx)(g.A,{className:"h-4 w-4"}),"Back"]})}),i.error&&(0,t.jsx)(o.Zp,{className:"border-red-200 bg-red-50",children:(0,t.jsxs)(o.Wu,{className:"py-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-red-700",children:[(0,t.jsx)(C.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"font-medium",children:"Error"})]}),(0,t.jsx)("p",{className:"text-red-600 mt-1",children:i.error}),(0,t.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>u({error:null}),className:"mt-2",children:"Dismiss"})]})}),(0,t.jsxs)("div",{className:"relative",children:[i.isLoading&&(0,t.jsx)("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-lg",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Processing..."})]})}),(()=>{switch(i.currentStep){case"calculator":return(0,t.jsx)(n.W,{onContinue:j,isNavigating:i.isLoading});case"recipient":if(!i.transferData)return(0,t.jsx)(o.Zp,{className:"w-full max-w-lg mx-auto",children:(0,t.jsxs)(o.Wu,{className:"py-8 text-center",children:[(0,t.jsx)(C.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"Missing Transfer Data"}),(0,t.jsx)("p",{className:"text-red-600 mb-4",children:"Please complete the calculator step first."}),(0,t.jsx)(d.$,{onClick:()=>x("calculator"),variant:"outline",children:"Go to Calculator"})]})});return(0,t.jsx)(N,{transferData:{amount:i.transferData.sendAmount,sourceCurrency:i.transferData.sendCurrency,destCurrency:i.transferData.receiveCurrency,rate:i.transferData.exchangeRate,recipientAmount:i.transferData.receiveAmount},onBack:f,onContinue:b});case"payment":if(!i.transferData||!i.recipientData)return(0,t.jsx)(o.Zp,{className:"w-full max-w-lg mx-auto",children:(0,t.jsxs)(o.Wu,{className:"py-8 text-center",children:[(0,t.jsx)(C.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"Missing Required Data"}),(0,t.jsx)("p",{className:"text-red-600 mb-4",children:"Please complete the calculator and recipient steps first."}),(0,t.jsx)(d.$,{onClick:()=>x("calculator"),variant:"outline",children:"Start Over"})]})});return(0,t.jsx)(v.n,{sendAmount:i.transferData.sendAmount,receiveAmount:i.transferData.receiveAmount,exchangeRate:i.transferData.exchangeRate,fees:i.transferData.fees,rateId:i.transferData.rateId,onSubmit:y,isLoading:i.isLoading});case"status":if(!i.transferId)return(0,t.jsx)(o.Zp,{className:"w-full max-w-lg mx-auto",children:(0,t.jsxs)(o.Wu,{className:"py-8 text-center",children:[(0,t.jsx)(C.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"No Transfer Found"}),(0,t.jsx)("p",{className:"text-red-600 mb-4",children:"Transfer ID is missing."}),(0,t.jsx)(d.$,{onClick:k,variant:"outline",children:"Start New Transfer"})]})});return(0,t.jsx)(S,{transferId:i.transferId,onRefresh:w,autoRefresh:!0});default:return(0,t.jsx)(o.Zp,{className:"w-full max-w-lg mx-auto",children:(0,t.jsxs)(o.Wu,{className:"py-8 text-center",children:[(0,t.jsx)(C.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Unknown Step"}),(0,t.jsxs)("p",{className:"text-gray-600 mb-4",children:["Invalid step: ",i.currentStep]}),(0,t.jsx)(d.$,{onClick:k,variant:"outline",children:"Start Over"})]})})}})()]}),!1]})}function L(){return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 py-8",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Transfer Flow Test"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Testing the multi-step transfer flow container"})]}),(0,t.jsx)(I,{initialStep:"calculator",onComplete:e=>{console.log("Transfer completed with ID:",e)}})]})})}},5774:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(8889).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},5945:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(8889).A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},7277:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(8889).A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},8276:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(8889).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8521:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(8889).A)("building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},9369:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(8889).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9513:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(8889).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},9594:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(8889).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[637,7,716,312,466,587,315,358],()=>s(4673)),_N_E=e.O()}]);