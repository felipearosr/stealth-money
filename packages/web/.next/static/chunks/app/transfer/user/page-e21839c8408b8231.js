(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{390:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>g});var t=a(4568),r=a(7620),n=a(7807),l=a(6181),c=a(2222),i=a(8229),d=a(7466),u=a(8477),o=a(6682),m=a(3129),x=a(3353),h=a(7227),p=a(2055),f=a(9690),j=a(8276),b=a(2942);function g(){let{user:e,isLoaded:s}=(0,n.Jd)(),{}=(0,l.d)(),a=(0,b.useRouter)(),[g,N]=(0,r.useState)({currentStep:"calculator",transferData:null,recipientUser:null,selectedPaymentMethod:null,transferId:null,completedSteps:[],canGoBack:!1,isLoading:!1,error:null}),v=(0,r.useCallback)(e=>{N(s=>({...s,...e}))},[]),y=(0,r.useCallback)(e=>{v({currentStep:e,canGoBack:"calculator"!==e,error:null})},[v]),S=(0,r.useCallback)(()=>{let e=["calculator","recipient","payment","status"],s=e.indexOf(g.currentStep);s>0?y(e[s-1]):a.push("/dashboard")},[g.currentStep,y,a]),k=(0,r.useCallback)(e=>{N(s=>({...s,completedSteps:s.completedSteps.includes(e)?s.completedSteps:[...s.completedSteps,e]}))},[]),w=(0,r.useCallback)(e=>{v({transferData:{sendAmount:e.sendAmount,receiveAmount:e.receiveAmount,sendCurrency:e.sendCurrency,receiveCurrency:e.receiveCurrency,exchangeRate:e.exchangeRate,fees:e.fees,rateId:e.rateId,rateValidUntil:e.rateValidUntil,calculatorMode:e.calculatorMode,breakdown:e.breakdown,estimatedArrival:e.estimatedArrival},isLoading:!0}),k("calculator"),setTimeout(()=>{v({isLoading:!1}),y("recipient")},500)},[v,k,y]),C=(0,r.useCallback)((e,s)=>{v({recipientUser:e,selectedPaymentMethod:s,isLoading:!0}),k("recipient"),setTimeout(()=>{v({isLoading:!1}),y("payment")},500)},[v,k,y]),P=(0,r.useCallback)(async e=>{k("payment"),v({transferId:e,isLoading:!1}),y("status")},[k,v,y]),A=(0,r.useCallback)(e=>{v({error:e,isLoading:!1})},[v]);return s?e?(0,t.jsx)(m.A,{requireVerification:!1,skipCheckOnPublicPages:!1,blockTransfersUntilVerified:!0,children:(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"w-full max-w-4xl mx-auto space-y-6",children:[(0,t.jsx)(o.Z,{currentStep:g.currentStep,completedSteps:g.completedSteps,onStepClick:e=>{(g.completedSteps.includes(e)||e===g.currentStep)&&y(e)}}),g.canGoBack&&"status"!==g.currentStep&&(0,t.jsx)("div",{className:"flex justify-start",children:(0,t.jsxs)(h.$,{variant:"outline",onClick:S,disabled:g.isLoading,className:"flex items-center gap-2",children:[(0,t.jsx)(j.A,{className:"h-4 w-4"}),"Back"]})}),g.error&&(0,t.jsx)(x.Zp,{className:"border-red-200 bg-red-50",children:(0,t.jsxs)(x.Wu,{className:"py-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-red-700",children:[(0,t.jsx)(f.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"font-medium",children:"Error"})]}),(0,t.jsx)("p",{className:"text-red-600 mt-1",children:g.error}),(0,t.jsx)(h.$,{variant:"outline",size:"sm",onClick:()=>v({error:null}),className:"mt-2",children:"Dismiss"})]})}),(0,t.jsxs)("div",{className:"relative",children:[g.isLoading&&(0,t.jsx)("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-lg",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Processing..."})]})}),(()=>{switch(g.currentStep){case"calculator":return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(x.Zp,{children:(0,t.jsxs)(x.Wu,{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,t.jsx)(p.A,{className:"h-6 w-6 text-blue-600"}),(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Send Money to User"})]}),(0,t.jsx)("p",{className:"text-gray-600",children:"Send money directly to another registered user. No bank details needed - just search and send!"})]})}),(0,t.jsx)(c.W,{onContinue:w,isNavigating:g.isLoading})]});case"recipient":if(!g.transferData)return(0,t.jsx)(x.Zp,{className:"w-full max-w-lg mx-auto",children:(0,t.jsxs)(x.Wu,{className:"py-8 text-center",children:[(0,t.jsx)(f.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"Missing Transfer Data"}),(0,t.jsx)("p",{className:"text-red-600 mb-4",children:"Please complete the calculator step first."}),(0,t.jsx)(h.$,{onClick:()=>y("calculator"),variant:"outline",children:"Go to Calculator"})]})});return(0,t.jsx)(i.E,{transferData:{sendAmount:g.transferData.sendAmount,receiveAmount:g.transferData.receiveAmount,sendCurrency:g.transferData.sendCurrency,receiveCurrency:g.transferData.receiveCurrency,exchangeRate:g.transferData.exchangeRate,fees:g.transferData.fees},onRecipientSelected:C,onBack:S,currentUserId:null==e?void 0:e.id,isLoading:g.isLoading});case"payment":if(!g.transferData||!g.recipientUser||!g.selectedPaymentMethod)return(0,t.jsx)(x.Zp,{className:"w-full max-w-lg mx-auto",children:(0,t.jsxs)(x.Wu,{className:"py-8 text-center",children:[(0,t.jsx)(f.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"Missing Required Data"}),(0,t.jsx)("p",{className:"text-red-600 mb-4",children:"Please complete the previous steps first."}),(0,t.jsx)(h.$,{onClick:()=>y("calculator"),variant:"outline",children:"Start Over"})]})});return(0,t.jsx)(d.d,{transferData:g.transferData,recipientUser:g.recipientUser,selectedPaymentMethod:g.selectedPaymentMethod,onSuccess:P,onBack:S,onError:A,isLoading:g.isLoading});case"status":if(!g.transferId)return(0,t.jsx)(x.Zp,{className:"w-full max-w-lg mx-auto",children:(0,t.jsxs)(x.Wu,{className:"py-8 text-center",children:[(0,t.jsx)(f.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"No Transfer Found"}),(0,t.jsx)("p",{className:"text-red-600 mb-4",children:"Transfer ID is missing."}),(0,t.jsx)(h.$,{onClick:()=>y("calculator"),variant:"outline",children:"Start New Transfer"})]})});return(0,t.jsx)(u.Y,{transferId:g.transferId,onRefresh:()=>{},autoRefresh:!0});default:return(0,t.jsx)(x.Zp,{className:"w-full max-w-lg mx-auto",children:(0,t.jsxs)(x.Wu,{className:"py-8 text-center",children:[(0,t.jsx)(f.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Unknown Step"}),(0,t.jsxs)("p",{className:"text-gray-600 mb-4",children:["Invalid step: ",g.currentStep]}),(0,t.jsx)(h.$,{onClick:()=>y("calculator"),variant:"outline",children:"Start Over"})]})})}})()]})]})})})}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:(0,t.jsx)(x.Zp,{className:"w-full max-w-md",children:(0,t.jsxs)(x.Wu,{className:"p-8 text-center",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Authentication Required"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"Please sign in to send money to users."}),(0,t.jsx)(h.$,{onClick:()=>a.push("/auth/sign-in"),children:"Sign In"})]})})}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}},2942:(e,s,a)=>{"use strict";var t=a(2418);a.o(t,"useParams")&&a.d(s,{useParams:function(){return t.useParams}}),a.o(t,"usePathname")&&a.d(s,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}}),a.o(t,"useSelectedLayoutSegments")&&a.d(s,{useSelectedLayoutSegments:function(){return t.useSelectedLayoutSegments}})},8699:(e,s,a)=>{Promise.resolve().then(a.bind(a,390))}},e=>{var s=s=>e(e.s=s);e.O(0,[637,686,807,930,7,244,405,222,510,466,229,818,587,315,358],()=>s(8699)),_N_E=e.O()}]);