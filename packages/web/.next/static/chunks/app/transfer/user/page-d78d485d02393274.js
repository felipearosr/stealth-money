(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{390:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>g});var t=a(4568),r=a(7620),n=a(7807),l=a(6181),c=a(2222),i=a(8229),d=a(7466),u=a(8477),o=a(6682),m=a(8867),x=a(3353),h=a(7227),p=a(2055),f=a(9690),j=a(8276),b=a(2942);function g(){let{user:e,isLoaded:s}=(0,n.Jd)(),{getToken:a}=(0,l.d)(),g=(0,b.useRouter)(),[N,v]=(0,r.useState)({currentStep:"calculator",transferData:null,recipientUser:null,selectedPaymentMethod:null,transferId:null,completedSteps:[],canGoBack:!1,isLoading:!1,error:null}),y=(0,r.useCallback)(e=>{v(s=>({...s,...e}))},[]),S=(0,r.useCallback)(e=>{y({currentStep:e,canGoBack:"calculator"!==e,error:null})},[y]),k=(0,r.useCallback)(()=>{let e=["calculator","recipient","payment","status"],s=e.indexOf(N.currentStep);s>0?S(e[s-1]):g.push("/dashboard")},[N.currentStep,S,g]),w=(0,r.useCallback)(e=>{v(s=>({...s,completedSteps:s.completedSteps.includes(e)?s.completedSteps:[...s.completedSteps,e]}))},[]),C=(0,r.useCallback)(e=>{y({transferData:{sendAmount:e.sendAmount,receiveAmount:e.receiveAmount,sendCurrency:e.sendCurrency,receiveCurrency:e.receiveCurrency,exchangeRate:e.exchangeRate,fees:e.fees,rateId:e.rateId,rateValidUntil:e.rateValidUntil,calculatorMode:e.calculatorMode,breakdown:e.breakdown,estimatedArrival:e.estimatedArrival},isLoading:!0}),w("calculator"),setTimeout(()=>{y({isLoading:!1}),S("recipient")},500)},[y,w,S]),P=(0,r.useCallback)((e,s)=>{y({recipientUser:e,selectedPaymentMethod:s,isLoading:!0}),w("recipient"),setTimeout(()=>{y({isLoading:!1}),S("payment")},500)},[y,w,S]),A=(0,r.useCallback)(async e=>{w("payment"),y({transferId:e,isLoading:!1}),S("status")},[w,y,S]),D=(0,r.useCallback)(e=>{y({error:e,isLoading:!1})},[y]);return s?e?(0,t.jsx)(m.A,{requireVerification:!1,skipCheckOnPublicPages:!1,blockTransfersUntilVerified:!0,children:(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"w-full max-w-4xl mx-auto space-y-6",children:[(0,t.jsx)(o.Z,{currentStep:N.currentStep,completedSteps:N.completedSteps,onStepClick:e=>{(N.completedSteps.includes(e)||e===N.currentStep)&&S(e)}}),N.canGoBack&&"status"!==N.currentStep&&(0,t.jsx)("div",{className:"flex justify-start",children:(0,t.jsxs)(h.$,{variant:"outline",onClick:k,disabled:N.isLoading,className:"flex items-center gap-2",children:[(0,t.jsx)(j.A,{className:"h-4 w-4"}),"Back"]})}),N.error&&(0,t.jsx)(x.Zp,{className:"border-red-200 bg-red-50",children:(0,t.jsxs)(x.Wu,{className:"py-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-red-700",children:[(0,t.jsx)(f.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"font-medium",children:"Error"})]}),(0,t.jsx)("p",{className:"text-red-600 mt-1",children:N.error}),(0,t.jsx)(h.$,{variant:"outline",size:"sm",onClick:()=>y({error:null}),className:"mt-2",children:"Dismiss"})]})}),(0,t.jsxs)("div",{className:"relative",children:[N.isLoading&&(0,t.jsx)("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-lg",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Processing..."})]})}),(()=>{switch(N.currentStep){case"calculator":return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(x.Zp,{children:(0,t.jsxs)(x.Wu,{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,t.jsx)(p.A,{className:"h-6 w-6 text-blue-600"}),(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Send Money to User"})]}),(0,t.jsx)("p",{className:"text-gray-600",children:"Send money directly to another registered user. No bank details needed - just search and send!"})]})}),(0,t.jsx)(c.W,{onContinue:C,isNavigating:N.isLoading})]});case"recipient":if(!N.transferData)return(0,t.jsx)(x.Zp,{className:"w-full max-w-lg mx-auto",children:(0,t.jsxs)(x.Wu,{className:"py-8 text-center",children:[(0,t.jsx)(f.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"Missing Transfer Data"}),(0,t.jsx)("p",{className:"text-red-600 mb-4",children:"Please complete the calculator step first."}),(0,t.jsx)(h.$,{onClick:()=>S("calculator"),variant:"outline",children:"Go to Calculator"})]})});return(0,t.jsx)(i.E,{transferData:{sendAmount:N.transferData.sendAmount,receiveAmount:N.transferData.receiveAmount,sendCurrency:N.transferData.sendCurrency,receiveCurrency:N.transferData.receiveCurrency,exchangeRate:N.transferData.exchangeRate,fees:N.transferData.fees},onRecipientSelected:P,onBack:k,currentUserId:null==e?void 0:e.id,isLoading:N.isLoading});case"payment":if(!N.transferData||!N.recipientUser||!N.selectedPaymentMethod)return(0,t.jsx)(x.Zp,{className:"w-full max-w-lg mx-auto",children:(0,t.jsxs)(x.Wu,{className:"py-8 text-center",children:[(0,t.jsx)(f.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"Missing Required Data"}),(0,t.jsx)("p",{className:"text-red-600 mb-4",children:"Please complete the previous steps first."}),(0,t.jsx)(h.$,{onClick:()=>S("calculator"),variant:"outline",children:"Start Over"})]})});return(0,t.jsx)(d.d,{transferData:N.transferData,recipientUser:N.recipientUser,selectedPaymentMethod:N.selectedPaymentMethod,onSuccess:A,onBack:k,onError:D,isLoading:N.isLoading});case"status":if(!N.transferId)return(0,t.jsx)(x.Zp,{className:"w-full max-w-lg mx-auto",children:(0,t.jsxs)(x.Wu,{className:"py-8 text-center",children:[(0,t.jsx)(f.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"No Transfer Found"}),(0,t.jsx)("p",{className:"text-red-600 mb-4",children:"Transfer ID is missing."}),(0,t.jsx)(h.$,{onClick:()=>S("calculator"),variant:"outline",children:"Start New Transfer"})]})});return(0,t.jsx)(u.Y,{transferId:N.transferId,onRefresh:()=>{},autoRefresh:!0});default:return(0,t.jsx)(x.Zp,{className:"w-full max-w-lg mx-auto",children:(0,t.jsxs)(x.Wu,{className:"py-8 text-center",children:[(0,t.jsx)(f.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Unknown Step"}),(0,t.jsxs)("p",{className:"text-gray-600 mb-4",children:["Invalid step: ",N.currentStep]}),(0,t.jsx)(h.$,{onClick:()=>S("calculator"),variant:"outline",children:"Start Over"})]})})}})()]})]})})})}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:(0,t.jsx)(x.Zp,{className:"w-full max-w-md",children:(0,t.jsxs)(x.Wu,{className:"p-8 text-center",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Authentication Required"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"Please sign in to send money to users."}),(0,t.jsx)(h.$,{onClick:()=>g.push("/auth/sign-in"),children:"Sign In"})]})})}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}},2942:(e,s,a)=>{"use strict";var t=a(2418);a.o(t,"useParams")&&a.d(s,{useParams:function(){return t.useParams}}),a.o(t,"usePathname")&&a.d(s,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}}),a.o(t,"useSelectedLayoutSegments")&&a.d(s,{useSelectedLayoutSegments:function(){return t.useSelectedLayoutSegments}})},8699:(e,s,a)=>{Promise.resolve().then(a.bind(a,390))}},e=>{var s=s=>e(e.s=s);e.O(0,[637,686,807,7,716,969,222,466,628,229,587,315,358],()=>s(8699)),_N_E=e.O()}]);