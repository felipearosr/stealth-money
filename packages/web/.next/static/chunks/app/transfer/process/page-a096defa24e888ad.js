(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[614],{2942:(e,t,s)=>{"use strict";var a=s(2418);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}}),s.o(a,"useSelectedLayoutSegments")&&s.d(t,{useSelectedLayoutSegments:function(){return a.useSelectedLayoutSegments}})},5638:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var a=s(4568),r=s(7620),n=s(7807),l=s(6181),c=s(2942),i=s(2222),o=s(8229),d=s(7466),u=s(8477),m=s(6682),x=s(8867),h=s(3353),p=s(7227),f=s(8421),j=s(9690),b=s(8276);function g(){let{user:e,isLoaded:t}=(0,n.Jd)(),{getToken:s}=(0,l.d)(),g=(0,c.useRouter)(),[N,v]=(0,r.useState)({currentStep:"calculator",transferData:null,recipientUser:null,selectedPaymentMethod:null,transferId:null,completedSteps:[],canGoBack:!1,isLoading:!1,error:null});(0,r.useEffect)(()=>{let e=sessionStorage.getItem("transferCalculation");if(e)try{let t=JSON.parse(e);v(e=>({...e,transferData:t,completedSteps:["calculator"],currentStep:"recipient",canGoBack:!0})),sessionStorage.removeItem("transferCalculation")}catch(e){console.error("Failed to parse saved calculation:",e)}},[]);let y=(0,r.useCallback)(e=>{v(t=>({...t,...e}))},[]),S=(0,r.useCallback)(e=>{y({currentStep:e,canGoBack:"calculator"!==e,error:null})},[y]),k=(0,r.useCallback)(()=>{let e=["calculator","recipient","payment","status"],t=e.indexOf(N.currentStep);t>0?S(e[t-1]):g.push("/")},[N.currentStep,S,g]),C=(0,r.useCallback)(e=>{v(t=>({...t,completedSteps:t.completedSteps.includes(e)?t.completedSteps:[...t.completedSteps,e]}))},[]),w=(0,r.useCallback)(e=>{y({transferData:{sendAmount:e.sendAmount,receiveAmount:e.receiveAmount,sendCurrency:e.sendCurrency,receiveCurrency:e.receiveCurrency,exchangeRate:e.exchangeRate,fees:e.fees,rateId:e.rateId,rateValidUntil:e.rateValidUntil,calculatorMode:e.calculatorMode,breakdown:e.breakdown,estimatedArrival:e.estimatedArrival},isLoading:!0}),C("calculator"),setTimeout(()=>{y({isLoading:!1}),S("recipient")},500)},[y,C,S]),P=(0,r.useCallback)((e,t)=>{y({recipientUser:e,selectedPaymentMethod:t,isLoading:!0}),C("recipient"),setTimeout(()=>{y({isLoading:!1}),S("payment")},500)},[y,C,S]),A=(0,r.useCallback)(async e=>{C("payment"),y({transferId:e,isLoading:!1}),S("status")},[C,y,S]),D=(0,r.useCallback)(e=>{y({error:e,isLoading:!1})},[y]);return t?(0,a.jsx)(x.A,{requireVerification:!1,skipCheckOnPublicPages:!1,blockTransfersUntilVerified:!0,children:(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"w-full max-w-4xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Complete Your Transfer"}),(0,a.jsx)("p",{className:"text-gray-600",children:e?"Follow the steps below to send your money securely":"Sign in to continue with your transfer"})]}),(0,a.jsx)(m.Z,{currentStep:N.currentStep,completedSteps:N.completedSteps,onStepClick:e=>{(N.completedSteps.includes(e)||e===N.currentStep)&&S(e)}}),N.canGoBack&&"status"!==N.currentStep&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsxs)(p.$,{variant:"outline",onClick:k,disabled:N.isLoading,className:"flex items-center gap-2",children:[(0,a.jsx)(b.A,{className:"h-4 w-4"}),"Back"]})}),N.error&&(0,a.jsx)(h.Zp,{className:"border-red-200 bg-red-50",children:(0,a.jsxs)(h.Wu,{className:"py-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-700",children:[(0,a.jsx)(j.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-medium",children:"Error"})]}),(0,a.jsx)("p",{className:"text-red-600 mt-1",children:N.error}),(0,a.jsx)(p.$,{variant:"outline",size:"sm",onClick:()=>y({error:null}),className:"mt-2",children:"Dismiss"})]})}),(0,a.jsxs)("div",{className:"relative",children:[N.isLoading&&(0,a.jsx)("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm z-10 flex items-center justify-center rounded-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Processing..."})]})}),(()=>{switch(N.currentStep){case"calculator":return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(h.Zp,{children:(0,a.jsxs)(h.Wu,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,a.jsx)(f.A,{className:"h-6 w-6 text-blue-600"}),(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Calculate Your Transfer"})]}),(0,a.jsx)("p",{className:"text-gray-600",children:"Enter the amount you want to send and see the real-time exchange rate and fees."})]})}),(0,a.jsx)(i.W,{onContinue:w,isNavigating:N.isLoading})]});case"recipient":if(!N.transferData)return(0,a.jsx)(h.Zp,{className:"w-full max-w-lg mx-auto",children:(0,a.jsxs)(h.Wu,{className:"py-8 text-center",children:[(0,a.jsx)(j.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"Missing Transfer Data"}),(0,a.jsx)("p",{className:"text-red-600 mb-4",children:"Please complete the calculator step first."}),(0,a.jsx)(p.$,{onClick:()=>S("calculator"),variant:"outline",children:"Go to Calculator"})]})});return(0,a.jsx)(o.E,{transferData:{sendAmount:N.transferData.sendAmount,receiveAmount:N.transferData.receiveAmount,sendCurrency:N.transferData.sendCurrency,receiveCurrency:N.transferData.receiveCurrency,exchangeRate:N.transferData.exchangeRate,fees:N.transferData.fees},onRecipientSelected:P,onBack:k,currentUserId:null==e?void 0:e.id,isLoading:N.isLoading});case"payment":if(!N.transferData||!N.recipientUser||!N.selectedPaymentMethod)return(0,a.jsx)(h.Zp,{className:"w-full max-w-lg mx-auto",children:(0,a.jsxs)(h.Wu,{className:"py-8 text-center",children:[(0,a.jsx)(j.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"Missing Required Data"}),(0,a.jsx)("p",{className:"text-red-600 mb-4",children:"Please complete the previous steps first."}),(0,a.jsx)(p.$,{onClick:()=>S("calculator"),variant:"outline",children:"Start Over"})]})});return(0,a.jsx)(d.d,{transferData:N.transferData,recipientUser:N.recipientUser,selectedPaymentMethod:N.selectedPaymentMethod,onSuccess:A,onBack:k,onError:D,isLoading:N.isLoading});case"status":if(!N.transferId)return(0,a.jsx)(h.Zp,{className:"w-full max-w-lg mx-auto",children:(0,a.jsxs)(h.Wu,{className:"py-8 text-center",children:[(0,a.jsx)(j.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"No Transfer Found"}),(0,a.jsx)("p",{className:"text-red-600 mb-4",children:"Transfer ID is missing."}),(0,a.jsx)(p.$,{onClick:()=>S("calculator"),variant:"outline",children:"Start New Transfer"})]})});return(0,a.jsx)(u.Y,{transferId:N.transferId,onRefresh:()=>{},autoRefresh:!0});default:return(0,a.jsx)(h.Zp,{className:"w-full max-w-lg mx-auto",children:(0,a.jsxs)(h.Wu,{className:"py-8 text-center",children:[(0,a.jsx)(j.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Unknown Step"}),(0,a.jsxs)("p",{className:"text-gray-600 mb-4",children:["Invalid step: ",N.currentStep]}),(0,a.jsx)(p.$,{onClick:()=>S("calculator"),variant:"outline",children:"Start Over"})]})})}})()]})]})})})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}},9217:(e,t,s)=>{Promise.resolve().then(s.bind(s,5638))}},e=>{var t=t=>e(e.s=t);e.O(0,[637,686,807,7,716,969,222,466,628,229,587,315,358],()=>t(9217)),_N_E=e.O()}]);