"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[466],{4148:(e,s,a)=>{a.d(s,{E:()=>l});var r=a(4568);a(7620);var t=a(615),c=a(3928);let n=(0,t.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:s,variant:a,...t}=e;return(0,r.jsx)("div",{className:(0,c.cn)(n({variant:a}),s),...t})}},7466:(e,s,a)=>{a.d(s,{d:()=>w,n:()=>A});var r=a(4568),t=a(7620),c=a(7717),n=a(818),l=a(8276),i=a(9594),d=a(5191),m=a(5774),x=a(8521),o=a(5945),h=a(9690),u=a(9369),p=a(3872),j=a(7227),g=a(3353),v=a(5165),N=a(2555),y=a(4148);let f=c.Ik({number:c.Yj().min(13,"Card number must be at least 13 digits").max(19,"Card number cannot exceed 19 digits"),expiryMonth:c.ai().min(1,"Invalid month").max(12,"Invalid month"),expiryYear:c.ai().min(new Date().getFullYear(),"Card has expired").max(new Date().getFullYear()+20,"Invalid year"),cvv:c.Yj().min(3,"CVV must be at least 3 digits").max(4,"CVV cannot exceed 4 digits")}),b=c.Ik({cardDetails:f});function A(e){let{sendAmount:s,receiveAmount:a,exchangeRate:A,fees:w,rateId:D,onSubmit:C,isLoading:k=!1,transferData:F,recipientUser:I,selectedPaymentMethod:Y,onSuccess:S,onBack:M,onError:B}=e,E=!!(F&&I&&Y),J=F||{sendAmount:s,receiveAmount:a,sendCurrency:"USD",receiveCurrency:"EUR",exchangeRate:A,fees:w,rateId:D,rateValidUntil:"",calculatorMode:"send",breakdown:{sendAmountUSD:s,fees:{cardProcessing:0,transfer:0,payout:0,total:w},netAmountUSD:s-w,exchangeRate:A,receiveAmount:a},estimatedArrival:""},[T,P]=(0,t.useState)({number:"",expiryMonth:1,expiryYear:new Date().getFullYear(),cvv:""}),[R,V]=(0,t.useState)({name:"",email:"",bankAccount:{iban:"",bic:"",bankName:"",accountHolderName:"",country:"DE"}}),[U,Z]=(0,t.useState)({}),[W,$]=(0,t.useState)(!1),H=e=>{let s=e.replace(/\s/g,"").replace(/[^0-9]/gi,""),a=s.match(/\d{4,16}/g),r=a&&a[0]||"",t=[];for(let e=0,s=r.length;e<s;e+=4)t.push(r.substring(e,e+4));return t.length?t.join(" "):s},L=(e,s)=>{P(a=>({...a,[e]:s})),U["cardDetails.".concat(e)]&&Z(s=>{let a={...s};return delete a["cardDetails.".concat(e)],a})},O=(e,s)=>{if(e.startsWith("bankAccount.")){let a=e.replace("bankAccount.","");V(e=>({...e,bankAccount:{...e.bankAccount,[a]:s}}))}else V(a=>({...a,[e]:s}));U["recipientInfo.".concat(e)]&&Z(s=>{let a={...s};return delete a["recipientInfo.".concat(e)],a})},_=async()=>"mock-token",z=async e=>{e.preventDefault(),Z({}),$(!0);try{if(E){let e={cardDetails:{...T,number:T.number.replace(/\s/g,"")}};b.parse(e);let s=await fetch("".concat("http://localhost:4000","/api/transfers/create-user-to-user"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(await _())},body:JSON.stringify({sendAmount:J.sendAmount,sendCurrency:J.sendCurrency,receiveCurrency:J.receiveCurrency,rateId:J.rateId,cardDetails:e.cardDetails,recipientUserId:I.id,recipientPaymentMethodId:Y.id})});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.message||"Failed to create transfer")}let a=await s.json();S&&S(a.transferId)}else{let e={cardDetails:{...T,number:T.number.replace(/\s/g,"")},recipientInfo:{...R,bankAccount:{...R.bankAccount,iban:R.bankAccount.iban.replace(/\s/g,"")}}};c.Ik({cardDetails:f,recipientInfo:c.Ik({name:c.Yj().min(2,"Name must be at least 2 characters").max(100,"Name cannot exceed 100 characters"),email:c.Yj().email("Invalid email address"),bankAccount:c.Ik({iban:c.Yj().min(15,"IBAN must be at least 15 characters").max(34,"IBAN cannot exceed 34 characters"),bic:c.Yj().min(8,"BIC must be at least 8 characters").max(11,"BIC cannot exceed 11 characters"),bankName:c.Yj().min(2,"Bank name must be at least 2 characters").max(100,"Bank name cannot exceed 100 characters"),accountHolderName:c.Yj().min(2,"Account holder name must be at least 2 characters").max(100,"Account holder name cannot exceed 100 characters"),country:c.eu("DE").refine(()=>!0,{message:"Only German bank accounts are supported"})})})}).parse(e),C(e)}}catch(e){if(console.error("Transfer creation error:",e),e instanceof n.G){let s={};e.issues.forEach(e=>{s[e.path.join(".")]=e.message}),Z(s)}else{let s=e instanceof Error?e.message:"Failed to create transfer";B&&B(s)}}finally{$(!1)}},G=J.sendAmount+J.fees;return E?(0,r.jsxs)("div",{className:"w-full max-w-4xl mx-auto space-y-6",children:[M&&(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(j.$,{variant:"outline",onClick:M,disabled:k||W,className:"flex items-center gap-2",children:[(0,r.jsx)(l.A,{className:"h-4 w-4"}),"Back"]}),(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Complete Payment"}),(0,r.jsx)("div",{})," "]}),(0,r.jsxs)(g.Zp,{children:[(0,r.jsx)(g.aR,{children:(0,r.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(i.A,{className:"h-5 w-5"}),"Transfer Summary"]})}),(0,r.jsxs)(g.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"From"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,r.jsx)(i.A,{className:"w-5 h-5 text-blue-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"You"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Sending via card payment"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"To"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[I.profileImageUrl?(0,r.jsx)("img",{src:I.profileImageUrl,alt:I.fullName,className:"w-10 h-10 rounded-full object-cover"}):(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center",children:(0,r.jsx)(i.A,{className:"w-5 h-5 text-gray-500"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"font-medium",children:I.fullName}),I.isVerified&&(0,r.jsx)(d.A,{className:"w-4 h-4 text-green-500"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[(0,r.jsx)(m.A,{className:"w-3 h-3"}),(0,r.jsx)("span",{children:I.email})]})]})]})]})]}),(0,r.jsx)("div",{className:"border-t pt-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"You Send"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[J.sendAmount.toFixed(2)," ",J.sendCurrency]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["+ ",J.fees.toFixed(2)," ",J.sendCurrency," fees"]}),(0,r.jsxs)("div",{className:"text-lg font-semibold border-t pt-2",children:["Total: ",G.toFixed(2)," ",J.sendCurrency]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"They Receive"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[J.receiveAmount.toFixed(2)," ",J.receiveCurrency]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Exchange rate: 1 ",J.sendCurrency," = ",J.exchangeRate.toFixed(4)," ",J.receiveCurrency]}),J.estimatedArrival&&(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Estimated arrival: ",J.estimatedArrival]})]})]})})]})]}),(0,r.jsxs)(g.Zp,{children:[(0,r.jsxs)(g.aR,{children:[(0,r.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(x.A,{className:"h-5 w-5"}),"Recipient's Bank Account"]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[I.fullName," will receive the money in their verified account"]})]}),(0,r.jsx)(g.Wu,{children:(0,r.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsx)(o.A,{className:"w-5 h-5 text-gray-500"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"font-medium",children:Y.bankName||"".concat(Y.type.replace("_"," "))}),(0,r.jsx)(y.E,{variant:"secondary",className:"text-xs",children:Y.currency}),Y.isDefault&&(0,r.jsx)(y.E,{variant:"outline",className:"text-xs",children:"Default"})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[Y.accountType," • ",Y.country,Y.lastFourDigits&&(0,r.jsxs)("span",{children:[" • ****",Y.lastFourDigits]})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Verified ",new Date(Y.verifiedAt).toLocaleDateString()]})]}),(0,r.jsx)(d.A,{className:"w-5 h-5 text-green-500"})]})})]}),(0,r.jsxs)(g.Zp,{children:[(0,r.jsxs)(g.aR,{children:[(0,r.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(o.A,{className:"h-5 w-5"}),"Your Payment Method"]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Enter your card details to complete the transfer"})]}),(0,r.jsx)(g.Wu,{children:(0,r.jsxs)("form",{onSubmit:z,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"card-number",children:"Card Number"}),(0,r.jsx)(v.p,{id:"card-number",type:"text",placeholder:"1234 5678 9012 3456",value:H(T.number),onChange:e=>L("number",e.target.value.replace(/\s/g,"")),className:U["cardDetails.number"]?"border-red-500":"",maxLength:19}),U["cardDetails.number"]&&(0,r.jsxs)("p",{className:"text-sm text-red-500 mt-1 flex items-center gap-1",children:[(0,r.jsx)(h.A,{className:"h-3 w-3"}),U["cardDetails.number"]]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"expiry-month",children:"Month"}),(0,r.jsx)(v.p,{id:"expiry-month",type:"number",placeholder:"MM",min:"1",max:"12",value:T.expiryMonth,onChange:e=>L("expiryMonth",parseInt(e.target.value)||1),className:U["cardDetails.expiryMonth"]?"border-red-500":""}),U["cardDetails.expiryMonth"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:U["cardDetails.expiryMonth"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"expiry-year",children:"Year"}),(0,r.jsx)(v.p,{id:"expiry-year",type:"number",placeholder:"YYYY",min:new Date().getFullYear(),max:new Date().getFullYear()+20,value:T.expiryYear,onChange:e=>L("expiryYear",parseInt(e.target.value)||new Date().getFullYear()),className:U["cardDetails.expiryYear"]?"border-red-500":""}),U["cardDetails.expiryYear"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:U["cardDetails.expiryYear"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"cvv",children:"CVV"}),(0,r.jsx)(v.p,{id:"cvv",type:"text",placeholder:"123",maxLength:4,value:T.cvv,onChange:e=>L("cvv",e.target.value.replace(/[^0-9]/g,"")),className:U["cardDetails.cvv"]?"border-red-500":""}),U["cardDetails.cvv"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:U["cardDetails.cvv"]})]})]})]}),(0,r.jsx)(j.$,{type:"submit",disabled:k||W,className:"w-full",size:"lg",children:k||W?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing Transfer..."]}):"Send ".concat(G.toFixed(2)," ").concat(J.sendCurrency," to ").concat(I.fullName)}),(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-xs text-muted-foreground",children:[(0,r.jsx)(p.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Secured by Circle • PCI DSS Compliant"})]})]})})]})]}):(0,r.jsxs)(g.Zp,{className:"w-full max-w-2xl mx-auto",children:[(0,r.jsxs)(g.aR,{children:[(0,r.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(o.A,{className:"h-5 w-5"}),"Complete Your Transfer"]}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"You send:"}),(0,r.jsxs)("span",{className:"font-medium",children:["$",J.sendAmount.toFixed(2)," ",J.sendCurrency]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Fees:"}),(0,r.jsxs)("span",{className:"font-medium",children:["$",J.fees.toFixed(2)," ",J.sendCurrency]})]}),(0,r.jsxs)("div",{className:"flex justify-between border-t pt-1 mt-1",children:[(0,r.jsx)("span",{children:"Total to pay:"}),(0,r.jsxs)("span",{className:"font-bold",children:["$",G.toFixed(2)," ",J.sendCurrency]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,r.jsx)("span",{children:"Recipient gets:"}),(0,r.jsxs)("span",{className:"font-bold",children:["€",J.receiveAmount.toFixed(2)," ",J.receiveCurrency]})]})]})]}),(0,r.jsx)(g.Wu,{children:(0,r.jsxs)("form",{onSubmit:z,className:"space-y-8",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)(o.A,{className:"h-4 w-4"}),(0,r.jsx)("h3",{className:"font-semibold",children:"Payment Details"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"card-number",children:"Card Number"}),(0,r.jsx)(v.p,{id:"card-number",type:"text",placeholder:"1234 5678 9012 3456",value:H(T.number),onChange:e=>L("number",e.target.value.replace(/\s/g,"")),className:U["cardDetails.number"]?"border-red-500":"",maxLength:19}),U["cardDetails.number"]&&(0,r.jsxs)("p",{className:"text-sm text-red-500 mt-1 flex items-center gap-1",children:[(0,r.jsx)(h.A,{className:"h-3 w-3"}),U["cardDetails.number"]]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"expiry-month",children:"Month"}),(0,r.jsx)(v.p,{id:"expiry-month",type:"number",placeholder:"MM",min:"1",max:"12",value:T.expiryMonth,onChange:e=>L("expiryMonth",parseInt(e.target.value)||1),className:U["cardDetails.expiryMonth"]?"border-red-500":""}),U["cardDetails.expiryMonth"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:U["cardDetails.expiryMonth"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"expiry-year",children:"Year"}),(0,r.jsx)(v.p,{id:"expiry-year",type:"number",placeholder:"YYYY",min:new Date().getFullYear(),max:new Date().getFullYear()+20,value:T.expiryYear,onChange:e=>L("expiryYear",parseInt(e.target.value)||new Date().getFullYear()),className:U["cardDetails.expiryYear"]?"border-red-500":""}),U["cardDetails.expiryYear"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:U["cardDetails.expiryYear"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"cvv",children:"CVV"}),(0,r.jsx)(v.p,{id:"cvv",type:"text",placeholder:"123",maxLength:4,value:T.cvv,onChange:e=>L("cvv",e.target.value.replace(/[^0-9]/g,"")),className:U["cardDetails.cvv"]?"border-red-500":""}),U["cardDetails.cvv"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:U["cardDetails.cvv"]})]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)(i.A,{className:"h-4 w-4"}),(0,r.jsx)("h3",{className:"font-semibold",children:"Recipient Information"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"recipient-name",children:"Full Name"}),(0,r.jsx)(v.p,{id:"recipient-name",type:"text",placeholder:"John Doe",value:R.name,onChange:e=>O("name",e.target.value),className:U["recipientInfo.name"]?"border-red-500":""}),U["recipientInfo.name"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:U["recipientInfo.name"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"recipient-email",children:"Email Address"}),(0,r.jsx)(v.p,{id:"recipient-email",type:"email",placeholder:"john@example.com",value:R.email,onChange:e=>O("email",e.target.value),className:U["recipientInfo.email"]?"border-red-500":""}),U["recipientInfo.email"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:U["recipientInfo.email"]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)(x.A,{className:"h-4 w-4"}),(0,r.jsx)("h3",{className:"font-semibold",children:"Bank Account Details (Germany)"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"iban",children:"IBAN"}),(0,r.jsx)(v.p,{id:"iban",type:"text",placeholder:"DE89 3704 0044 0532 0130 00",value:R.bankAccount.iban.replace(/\s/g,"").toUpperCase().replace(/(.{4})/g,"$1 ").trim(),onChange:e=>O("bankAccount.iban",e.target.value.replace(/\s/g,"")),className:U["recipientInfo.bankAccount.iban"]?"border-red-500":""}),U["recipientInfo.bankAccount.iban"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:U["recipientInfo.bankAccount.iban"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"bic",children:"BIC/SWIFT Code"}),(0,r.jsx)(v.p,{id:"bic",type:"text",placeholder:"COBADEFFXXX",value:R.bankAccount.bic,onChange:e=>O("bankAccount.bic",e.target.value.toUpperCase()),className:U["recipientInfo.bankAccount.bic"]?"border-red-500":""}),U["recipientInfo.bankAccount.bic"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:U["recipientInfo.bankAccount.bic"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"bank-name",children:"Bank Name"}),(0,r.jsx)(v.p,{id:"bank-name",type:"text",placeholder:"Deutsche Bank",value:R.bankAccount.bankName,onChange:e=>O("bankAccount.bankName",e.target.value),className:U["recipientInfo.bankAccount.bankName"]?"border-red-500":""}),U["recipientInfo.bankAccount.bankName"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:U["recipientInfo.bankAccount.bankName"]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"account-holder",children:"Account Holder Name"}),(0,r.jsx)(v.p,{id:"account-holder",type:"text",placeholder:"John Doe",value:R.bankAccount.accountHolderName,onChange:e=>O("bankAccount.accountHolderName",e.target.value),className:U["recipientInfo.bankAccount.accountHolderName"]?"border-red-500":""}),U["recipientInfo.bankAccount.accountHolderName"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:U["recipientInfo.bankAccount.accountHolderName"]})]})]})]}),(0,r.jsx)(j.$,{type:"submit",disabled:k||W,className:"w-full",size:"lg",children:k||W?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing Transfer..."]}):"Send ".concat(J.sendAmount.toFixed(2)," USD")}),(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-xs text-muted-foreground",children:[(0,r.jsx)(p.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Secured by Circle • PCI DSS Compliant"})]})]})})]})}function w(e){let{transferData:s,recipientUser:a,selectedPaymentMethod:c,onSuccess:f,onBack:A,onError:w,isLoading:D=!1}=e,[C,k]=(0,t.useState)({number:"",expiryMonth:1,expiryYear:new Date().getFullYear(),cvv:""}),[F,I]=(0,t.useState)({}),[Y,S]=(0,t.useState)(!1),M=(e,s)=>{k(a=>({...a,[e]:s})),F["cardDetails.".concat(e)]&&I(s=>{let a={...s};return delete a["cardDetails.".concat(e)],a})},B=async e=>{e.preventDefault(),I({}),S(!0);try{let e={cardDetails:{...C,number:C.number.replace(/\s/g,"")}};b.parse(e);let r=await fetch("".concat("http://localhost:4000","/api/transfers/create-user-to-user"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(await E())},body:JSON.stringify({sendAmount:s.sendAmount,sendCurrency:s.sendCurrency,receiveCurrency:s.receiveCurrency,rateId:s.rateId,cardDetails:e.cardDetails,recipientUserId:a.id,recipientPaymentMethodId:c.id})});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e.message||"Failed to create transfer")}let t=await r.json();f(t.transferId)}catch(e){if(console.error("Transfer creation error:",e),e instanceof n.G){let s={};e.issues.forEach(e=>{s[e.path.join(".")]=e.message}),I(s)}else w(e instanceof Error?e.message:"Failed to create transfer")}finally{S(!1)}},E=async()=>"mock-token",J=s.sendAmount+s.fees;return(0,r.jsxs)("div",{className:"w-full max-w-4xl mx-auto space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(j.$,{variant:"outline",onClick:A,disabled:D||Y,className:"flex items-center gap-2",children:[(0,r.jsx)(l.A,{className:"h-4 w-4"}),"Back"]}),(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Complete Payment"}),(0,r.jsx)("div",{})," "]}),(0,r.jsxs)(g.Zp,{children:[(0,r.jsx)(g.aR,{children:(0,r.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(i.A,{className:"h-5 w-5"}),"Transfer Summary"]})}),(0,r.jsxs)(g.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"From"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,r.jsx)(i.A,{className:"w-5 h-5 text-blue-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"You"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Sending via card payment"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"To"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[a.profileImageUrl?(0,r.jsx)("img",{src:a.profileImageUrl,alt:a.fullName,className:"w-10 h-10 rounded-full object-cover"}):(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center",children:(0,r.jsx)(i.A,{className:"w-5 h-5 text-gray-500"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"font-medium",children:a.fullName}),a.isVerified&&(0,r.jsx)(d.A,{className:"w-4 h-4 text-green-500"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[(0,r.jsx)(m.A,{className:"w-3 h-3"}),(0,r.jsx)("span",{children:a.email})]})]})]})]})]}),(0,r.jsx)("div",{className:"border-t pt-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"You Send"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[s.sendAmount.toFixed(2)," ",s.sendCurrency]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["+ ",s.fees.toFixed(2)," ",s.sendCurrency," fees"]}),(0,r.jsxs)("div",{className:"text-lg font-semibold border-t pt-2",children:["Total: ",J.toFixed(2)," ",s.sendCurrency]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"They Receive"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[s.receiveAmount.toFixed(2)," ",s.receiveCurrency]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Exchange rate: 1 ",s.sendCurrency," = ",s.exchangeRate.toFixed(4)," ",s.receiveCurrency]}),s.estimatedArrival&&(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Estimated arrival: ",s.estimatedArrival]})]})]})})]})]}),(0,r.jsxs)(g.Zp,{children:[(0,r.jsxs)(g.aR,{children:[(0,r.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(x.A,{className:"h-5 w-5"}),"Recipient's Bank Account"]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[a.fullName," will receive the money in their verified account"]})]}),(0,r.jsx)(g.Wu,{children:(0,r.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsx)(o.A,{className:"w-5 h-5 text-gray-500"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"font-medium",children:c.bankName||"".concat(c.type.replace("_"," "))}),(0,r.jsx)(y.E,{variant:"secondary",className:"text-xs",children:c.currency}),c.isDefault&&(0,r.jsx)(y.E,{variant:"outline",className:"text-xs",children:"Default"})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[c.accountType," • ",c.country,c.lastFourDigits&&(0,r.jsxs)("span",{children:[" • ****",c.lastFourDigits]})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Verified ",new Date(c.verifiedAt).toLocaleDateString()]})]}),(0,r.jsx)(d.A,{className:"w-5 h-5 text-green-500"})]})})]}),(0,r.jsxs)(g.Zp,{children:[(0,r.jsxs)(g.aR,{children:[(0,r.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(o.A,{className:"h-5 w-5"}),"Your Payment Method"]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Enter your card details to complete the transfer"})]}),(0,r.jsx)(g.Wu,{children:(0,r.jsxs)("form",{onSubmit:B,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"card-number",children:"Card Number"}),(0,r.jsx)(v.p,{id:"card-number",type:"text",placeholder:"1234 5678 9012 3456",value:(e=>{let s=e.replace(/\s/g,"").replace(/[^0-9]/gi,""),a=s.match(/\d{4,16}/g),r=a&&a[0]||"",t=[];for(let e=0,s=r.length;e<s;e+=4)t.push(r.substring(e,e+4));return t.length?t.join(" "):s})(C.number),onChange:e=>M("number",e.target.value.replace(/\s/g,"")),className:F["cardDetails.number"]?"border-red-500":"",maxLength:19}),F["cardDetails.number"]&&(0,r.jsxs)("p",{className:"text-sm text-red-500 mt-1 flex items-center gap-1",children:[(0,r.jsx)(h.A,{className:"h-3 w-3"}),F["cardDetails.number"]]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"expiry-month",children:"Month"}),(0,r.jsx)(v.p,{id:"expiry-month",type:"number",placeholder:"MM",min:"1",max:"12",value:C.expiryMonth,onChange:e=>M("expiryMonth",parseInt(e.target.value)||1),className:F["cardDetails.expiryMonth"]?"border-red-500":""}),F["cardDetails.expiryMonth"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:F["cardDetails.expiryMonth"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"expiry-year",children:"Year"}),(0,r.jsx)(v.p,{id:"expiry-year",type:"number",placeholder:"YYYY",min:new Date().getFullYear(),max:new Date().getFullYear()+20,value:C.expiryYear,onChange:e=>M("expiryYear",parseInt(e.target.value)||new Date().getFullYear()),className:F["cardDetails.expiryYear"]?"border-red-500":""}),F["cardDetails.expiryYear"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:F["cardDetails.expiryYear"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"cvv",children:"CVV"}),(0,r.jsx)(v.p,{id:"cvv",type:"text",placeholder:"123",maxLength:4,value:C.cvv,onChange:e=>M("cvv",e.target.value.replace(/[^0-9]/g,"")),className:F["cardDetails.cvv"]?"border-red-500":""}),F["cardDetails.cvv"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:F["cardDetails.cvv"]})]})]})]}),(0,r.jsx)(j.$,{type:"submit",disabled:D||Y,className:"w-full",size:"lg",children:D||Y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing Transfer..."]}):"Send ".concat(J.toFixed(2)," ").concat(s.sendCurrency," to ").concat(a.fullName)}),(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-xs text-muted-foreground",children:[(0,r.jsx)(p.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Secured by Circle • PCI DSS Compliant"})]})]})})]})]})}}}]);