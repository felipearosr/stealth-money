"use strict";exports.id=131,exports.ids=[131],exports.modules={58350:(e,a,t)=>{t.d(a,{A:()=>n});let n=(0,t(84667).A)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},63859:(e,a)=>{function t(e){let a;if(!e||"string"!=typeof e)return!1;let t=e.replace(/[\.\-\s]/g,"").toUpperCase();if(t.length<8||t.length>9)return!1;let n=t.slice(0,-1),s=t.slice(-1);if(!/^\d+$/.test(n)||!/^[0-9K]$/.test(s))return!1;let r=0,i=2;for(let e=n.length-1;e>=0;e--)r+=parseInt(n[e])*i,i=7===i?2:i+1;let c=11-r%11;return s===(11===c?"0":10===c?"K":c.toString())}function n(e){return e&&"string"==typeof e?e.replace(/[\.\-\s]/g,"").toUpperCase():""}function s(e){return!!e&&!!e.verifiedPaymentMethods?.some(e=>"CLP"===e.currency&&"CL"===e.country)}Object.defineProperty(a,"__esModule",{value:!0}),a.validateRUT=t,a.formatRUT=function(e){if(!e||"string"!=typeof e)return"";let a=e.replace(/[^0-9K]/gi,"").toUpperCase();if(a.length<2)return a;let t=a.slice(0,-1),n=a.slice(-1),s=t.replace(/\B(?=(\d{3})+(?!\d))/g,".");return`${s}-${n}`},a.cleanRUT=n,a.formatRUTInput=function(e){if(!e)return"";let a=e.replace(/[^0-9K]/gi,"").toUpperCase().slice(0,9);if(a.length>=2){let e=a.slice(0,-1),t=a.slice(-1),n=e.replace(/\B(?=(\d{3})+(?!\d))/g,".");return`${n}-${t}`}return a},a.isValidRUTFormat=function(e){if(!e||"string"!=typeof e)return!1;let a=n(e);if(a.length<7||a.length>9)return!1;let t=a.slice(0,-1),s=a.slice(-1);return!!/^\d+$/.test(t)&&!!/^[0-9K]$/.test(s)},a.getRUTValidationError=function(e){if(!e||""===e.trim())return"RUT es requerido";let a=n(e);if(a.length<7)return"RUT debe tener al menos 7 d\xedgitos";if(a.length>9)return"RUT no puede tener m\xe1s de 9 caracteres";let s=a.slice(0,-1),r=a.slice(-1);return/^\d+$/.test(s)?/^[0-9K]$/.test(r)?t(e)?"RUT no es v\xe1lido":"D\xedgito verificador no es v\xe1lido":"D\xedgito verificador debe ser un n\xfamero del 0-9 o K":"RUT debe contener solo n\xfameros antes del d\xedgito verificador"},a.getExampleRUTs=function(){return["12.345.678-5","11.111.111-1","22.222.222-2","9.876.543-3","1.234.567-4"]},a.isValidChileanUser=s,a.filterChileanUsers=function(e){return e.filter(s)},a.isChileanUsernamePattern=function(e){if(!e||"string"!=typeof e)return!1;let a=e.trim().toLowerCase();return[/^[a-z]+\.[a-z]+$/,/^[a-z]+_[a-z]+$/,/^[a-z]+[0-9]+$/,/^[a-z]{2,}$/].some(e=>e.test(a))},a.getChileanSearchSuggestions=function(e){if(!e||e.length<2)return[];let a=[],t=e.toLowerCase();return["juan","maria","carlos","ana","luis","carmen","jose","francisca","pedro","patricia","diego","carolina","miguel","andrea","pablo","monica"].forEach(e=>{e.startsWith(t)&&(a.push(e),a.push(`${e}.${e}`),a.push(`${e}_${e}`))}),a.slice(0,5)},a.formatChileanUserDisplay=function(e){let a=e.fullName||e.username||e.email||"",t="";e.username&&e.fullName&&e.fullName!==e.username?t=`@${e.username}`:e.username&&!e.fullName?t=e.email||"":e.email&&!e.username&&(t=e.email);let n=[];e.isVerified&&n.push("Verificado");let s=e.verifiedPaymentMethods?.filter(e=>"CLP"===e.currency&&"CL"===e.country)||[];return s.length>0&&n.push(`${s.length} cuenta${s.length>1?"s":""} CLP`),{displayName:a,subtitle:t,badges:n}}},74439:(e,a,t)=>{t.d(a,{A:()=>n});let n=(0,t(84667).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},76510:(e,a,t)=>{t(63859),a.qS=void 0,a.vQ=function(e){let a=e.replace(/\s/g,"").toUpperCase();if(!/^[A-Z]{2}[0-9]{2}[A-Z0-9]+$/.test(a))return!1;let t={DE:22,ES:24,FR:27,IT:27,GB:22},n=a.substring(0,2);return!t[n]||a.length===t[n]},a.Ol=function(e){let a=e.replace(/\s/g,"");return!!/^\d{18}$/.test(a)},a.Kt=function(e){return/^\d{9}$/.test(e)},a.Qc=function(e){let a=e.replace(/-/g,"");return/^\d{6}$/.test(a)},a.RB=function(e){let a=e.replace(/-/g,"");return a.length>=4?`${a.slice(0,2)}-${a.slice(2,4)}-${a.slice(4,6)}`:a},a.qS={CL:{countryCode:"CL",countryName:"Chile",currency:"CLP",flag:"\uD83C\uDDE8\uD83C\uDDF1",banks:[{id:"cl-001",name:"Banco de Chile",code:"001"},{id:"cl-012",name:"Banco del Estado (BancoEstado)",code:"012"},{id:"cl-016",name:"Banco de Cr\xe9dito e Inversiones (BCI)",code:"016"},{id:"cl-037",name:"Banco Santander Chile",code:"037"},{id:"cl-039",name:"Banco Ita\xfa Chile",code:"039"},{id:"cl-049",name:"Banco Security",code:"049"},{id:"cl-051",name:"Banco Falabella",code:"051"},{id:"cl-053",name:"Banco Ripley",code:"053"},{id:"cl-054",name:"Banco Consorcio",code:"054"},{id:"cl-055",name:"Banco BICE",code:"055"},{id:"cl-504",name:"Scotiabank Chile",code:"504"}],accountTypes:[{value:"checking",label:"Cuenta Corriente"},{value:"savings",label:"Cuenta de Ahorro"},{value:"vista",label:"Cuenta Vista"},{value:"rut",label:"Cuenta RUT (BancoEstado)"}],requiredFields:[{field:"rut",label:"RUT del Titular",type:"text",placeholder:"12.345.678-9",validation:"Chilean RUT",maxLength:12},{field:"accountNumber",label:"N\xfamero de Cuenta",type:"text",placeholder:"0123456789",maxLength:20}]},US:{countryCode:"US",countryName:"United States",currency:"USD",flag:"\uD83C\uDDFA\uD83C\uDDF8",banks:[{id:"us-boa",name:"Bank of America",code:"BOFAUS3N",swift:"BOFAUS3N"},{id:"us-chase",name:"JPMorgan Chase",code:"CHASUS33",swift:"CHASUS33"},{id:"us-wells",name:"Wells Fargo",code:"WFBIUS6S",swift:"WFBIUS6S"},{id:"us-citi",name:"Citibank",code:"CITIUS33",swift:"CITIUS33"},{id:"us-pnc",name:"PNC Bank",code:"PNCCUS33",swift:"PNCCUS33"},{id:"us-usbank",name:"U.S. Bank",code:"USBKUS44",swift:"USBKUS44"},{id:"us-capital",name:"Capital One",code:"HIBKUS44",swift:"HIBKUS44"},{id:"us-td",name:"TD Bank",code:"NRTHUS33",swift:"NRTHUS33"},{id:"us-regions",name:"Regions Bank",code:"UPNBUS44",swift:"UPNBUS44"},{id:"us-fifth",name:"Fifth Third Bank",code:"FTBCUS3C",swift:"FTBCUS3C"}],accountTypes:[{value:"checking",label:"Checking Account"},{value:"savings",label:"Savings Account"},{value:"money_market",label:"Money Market Account"}],requiredFields:[{field:"routingNumber",label:"Routing Number (ABA)",type:"text",placeholder:"123456789",validation:"US Routing Number",maxLength:9},{field:"accountNumber",label:"Account Number",type:"text",placeholder:"1234567890",maxLength:17}]},DE:{countryCode:"DE",countryName:"Germany",currency:"EUR",flag:"\uD83C\uDDE9\uD83C\uDDEA",banks:[{id:"de-deutsche",name:"Deutsche Bank",code:"DEUTDEFF",swift:"DEUTDEFF"},{id:"de-commerzbank",name:"Commerzbank",code:"COBADEFF",swift:"COBADEFF"},{id:"de-dkb",name:"DKB (Deutsche Kreditbank)",code:"BYLADEM1",swift:"BYLADEM1"},{id:"de-postbank",name:"Postbank",code:"PBNKDEFF",swift:"PBNKDEFF"},{id:"de-sparkasse",name:"Sparkasse",code:"VARIES",swift:"VARIES"},{id:"de-volksbank",name:"Volksbank",code:"VARIES",swift:"VARIES"},{id:"de-hypovereins",name:"HypoVereinsbank",code:"HYVEDEMMXXX",swift:"HYVEDEMMXXX"}],accountTypes:[{value:"girokonto",label:"Girokonto (Checking)"},{value:"sparkonto",label:"Sparkonto (Savings)"},{value:"tagesgeld",label:"Tagesgeldkonto (Daily Savings)"}],requiredFields:[{field:"iban",label:"IBAN",type:"text",placeholder:"DE89 3704 0044 0532 0130 00",validation:"IBAN",maxLength:34}]},ES:{countryCode:"ES",countryName:"Spain",currency:"EUR",flag:"\uD83C\uDDEA\uD83C\uDDF8",banks:[{id:"es-santander",name:"Banco Santander",code:"BSCHESMMXXX",swift:"BSCHESMMXXX"},{id:"es-bbva",name:"BBVA",code:"BBVAESMMXXX",swift:"BBVAESMMXXX"},{id:"es-caixa",name:"CaixaBank",code:"CAIXESBBXXX",swift:"CAIXESBBXXX"},{id:"es-sabadell",name:"Banco Sabadell",code:"BSABESBBXXX",swift:"BSABESBBXXX"},{id:"es-bankinter",name:"Bankinter",code:"BKBKESMMXXX",swift:"BKBKESMMXXX"},{id:"es-unicaja",name:"Unicaja Banco",code:"UCJAES2MXXX",swift:"UCJAES2MXXX"}],accountTypes:[{value:"corriente",label:"Cuenta Corriente"},{value:"ahorro",label:"Cuenta de Ahorro"},{value:"nomina",label:"Cuenta N\xf3mina"}],requiredFields:[{field:"iban",label:"IBAN",type:"text",placeholder:"ES91 2100 0418 4502 0005 1332",validation:"IBAN",maxLength:34}]},FR:{countryCode:"FR",countryName:"France",currency:"EUR",flag:"\uD83C\uDDEB\uD83C\uDDF7",banks:[{id:"fr-bnp",name:"BNP Paribas",code:"BNPAFRPPXXX",swift:"BNPAFRPPXXX"},{id:"fr-credit-agricole",name:"Cr\xe9dit Agricole",code:"AGRIFRPPXXX",swift:"AGRIFRPPXXX"},{id:"fr-societe",name:"Soci\xe9t\xe9 G\xe9n\xe9rale",code:"SOGEFRPPXXX",swift:"SOGEFRPPXXX"},{id:"fr-credit-mutuel",name:"Cr\xe9dit Mutuel",code:"CMCIFRPPXXX",swift:"CMCIFRPPXXX"},{id:"fr-banque-postale",name:"La Banque Postale",code:"PSSTFRPPXXX",swift:"PSSTFRPPXXX"},{id:"fr-lcl",name:"LCL",code:"CRLYFRPPXXX",swift:"CRLYFRPPXXX"}],accountTypes:[{value:"courant",label:"Compte Courant"},{value:"epargne",label:"Compte \xc9pargne"},{value:"livret_a",label:"Livret A"}],requiredFields:[{field:"iban",label:"IBAN",type:"text",placeholder:"FR14 2004 1010 0505 0001 3M02 606",validation:"IBAN",maxLength:34}]},IT:{countryCode:"IT",countryName:"Italy",currency:"EUR",flag:"\uD83C\uDDEE\uD83C\uDDF9",banks:[{id:"it-unicredit",name:"UniCredit",code:"UNCRITMMXXX",swift:"UNCRITMMXXX"},{id:"it-intesa",name:"Intesa Sanpaolo",code:"BCITITMM",swift:"BCITITMM"},{id:"it-mps",name:"Monte dei Paschi di Siena",code:"PASCITMMXXX",swift:"PASCITMMXXX"},{id:"it-bnl",name:"BNL (BNP Paribas)",code:"BNLIITRR",swift:"BNLIITRR"},{id:"it-banco-bpm",name:"Banco BPM",code:"BAPPIT21",swift:"BAPPIT21"}],accountTypes:[{value:"corrente",label:"Conto Corrente"},{value:"risparmio",label:"Conto di Risparmio"},{value:"deposito",label:"Conto Deposito"}],requiredFields:[{field:"iban",label:"IBAN",type:"text",placeholder:"IT60 X054 2811 1010 0000 0123 456",validation:"IBAN",maxLength:34}]},MX:{countryCode:"MX",countryName:"Mexico",currency:"MXN",flag:"\uD83C\uDDF2\uD83C\uDDFD",banks:[{id:"mx-bbva",name:"BBVA M\xe9xico",code:"012",swift:"BCMRMXMM"},{id:"mx-santander",name:"Santander M\xe9xico",code:"014",swift:"BMSXMXMM"},{id:"mx-banamex",name:"Citibanamex",code:"002",swift:"BNMXMXMM"},{id:"mx-banorte",name:"Banorte",code:"072",swift:"MENOMXMT"},{id:"mx-hsbc",name:"HSBC M\xe9xico",code:"021",swift:"BIMEMXMM"},{id:"mx-scotiabank",name:"Scotiabank",code:"044",swift:"MBCOMXMM"},{id:"mx-inbursa",name:"Inbursa",code:"036",swift:"INBUMXMM"},{id:"mx-azteca",name:"Banco Azteca",code:"127",swift:"AZTKMXMM"}],accountTypes:[{value:"checking",label:"Cuenta de Cheques"},{value:"savings",label:"Cuenta de Ahorro"},{value:"payroll",label:"Cuenta de N\xf3mina"}],requiredFields:[{field:"clabe",label:"CLABE",type:"text",placeholder:"012345678901234567",validation:"CLABE",maxLength:18}]},GB:{countryCode:"GB",countryName:"United Kingdom",currency:"GBP",flag:"\uD83C\uDDEC\uD83C\uDDE7",banks:[{id:"gb-hsbc",name:"HSBC UK",code:"HBUKGB4B",swift:"HBUKGB4B"},{id:"gb-barclays",name:"Barclays",code:"BUKBGB22",swift:"BUKBGB22"},{id:"gb-lloyds",name:"Lloyds Bank",code:"LOYDGB2L",swift:"LOYDGB2L"},{id:"gb-natwest",name:"NatWest",code:"NWBKGB2L",swift:"NWBKGB2L"},{id:"gb-santander",name:"Santander UK",code:"ABBYGB2L",swift:"ABBYGB2L"},{id:"gb-halifax",name:"Halifax",code:"HLFXGB21",swift:"HLFXGB21"},{id:"gb-nationwide",name:"Nationwide",code:"NAIAGB21",swift:"NAIAGB21"},{id:"gb-metro",name:"Metro Bank",code:"MYMBGB2L",swift:"MYMBGB2L"}],accountTypes:[{value:"current",label:"Current Account"},{value:"savings",label:"Savings Account"},{value:"isa",label:"ISA Account"}],requiredFields:[{field:"sortCode",label:"Sort Code",type:"text",placeholder:"12-34-56",validation:"UK Sort Code",maxLength:8},{field:"accountNumber",label:"Account Number",type:"text",placeholder:"12345678",validation:"UK Account Number",maxLength:8}]}}},84131:(e,a,t)=>{t.d(a,{A:()=>M});var n=t(13486),s=t(60159),r=t.n(s),i=t(76123),c=t(29563),l=t(74941),o=t(23025),d=t(41571),u=t(86629),m=t(20276),h=t(63821),x=t(86e3),f=t(84667);let p=(0,f.A)("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),y=(0,f.A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),b=(0,f.A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var g=t(74439),N=t(58350),v=t(97493),j=t(59327),C=t(59203),k=t(23365);function A({account:e,onVerificationComplete:a,onSkip:t}){let{getToken:r}=(0,i.d)(),[,u]=(0,s.useState)(null),[f,p]=(0,s.useState)(!1),[y,b]=(0,s.useState)(null),[g,N]=(0,s.useState)(null),[v,A]=(0,s.useState)(["",""]),[B,S]=(0,s.useState)("pending"),w=async()=>{p(!0),b(null);try{let a=await r(),t=await fetch(`http://localhost:4000/api/users/me/bank-accounts/${e.id}/verify/micro-deposits`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.message||"Failed to start verification")}u("micro_deposits"),S("deposits_sent"),N("Micro-deposits have been sent to your account. They will appear within 1-2 business days.")}catch(e){console.error("Micro-deposit verification error:",e),b(e instanceof Error?e.message:"Failed to start verification")}finally{p(!1)}},M=async()=>{if(!v[0]||!v[1])return void b("Please enter both deposit amounts");p(!0),b(null),S("verifying");try{let t=await r(),n=await fetch(`http://localhost:4000/api/users/me/bank-accounts/${e.id}/verify/micro-deposits/confirm`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({amounts:v.map(e=>parseFloat(e))})});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error(e.message||"Verification failed")}S("verified"),N("Account verified successfully!"),setTimeout(()=>{a(e.id)},2e3)}catch(e){console.error("Micro-deposit confirmation error:",e),b(e instanceof Error?e.message:"Verification failed"),S("failed")}finally{p(!1)}},X=async()=>{p(!0),b(null);try{N("Instant verification would launch here (Plaid integration)"),setTimeout(()=>{a(e.id)},3e3)}catch(e){console.error("Instant verification error:",e),b("Instant verification is not available for this account")}finally{p(!1)}},T=e=>{switch(e){case"micro_deposits":return{name:"Micro-Deposits",description:"We send small deposits to verify account ownership",icon:(0,n.jsx)(j.A,{className:"h-5 w-5"})};case"instant":return{name:"Instant Verification",description:"Connect securely through your online banking",icon:(0,n.jsx)(h.A,{className:"h-5 w-5"})};default:return{name:"Unknown",description:"Unknown verification method",icon:(0,n.jsx)(x.A,{className:"h-5 w-5"})}}},P=()=>(0,n.jsxs)("div",{className:"text-center space-y-4",children:[(0,n.jsx)(h.A,{className:"h-16 w-16 text-green-500 mx-auto"}),(0,n.jsx)("h3",{className:"text-xl font-semibold text-green-700",children:"Account Verified!"}),(0,n.jsxs)("p",{className:"text-gray-600",children:["Your ",e.bankName," account has been successfully verified. You can now send and receive money."]}),(0,n.jsxs)(m.E,{className:"bg-green-100 text-green-800",children:["Verified ",e.verificationMethod&&T(e.verificationMethod).name]})]});return(0,n.jsxs)(c.Zp,{className:"w-full max-w-2xl mx-auto",children:[(0,n.jsxs)(c.aR,{children:[(0,n.jsx)(c.ZB,{className:"flex items-center space-x-2",children:(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[e.isVerified?(0,n.jsx)(h.A,{className:"h-5 w-5 text-green-500"}):(0,n.jsx)(k.A,{className:"h-5 w-5 text-yellow-500"}),(0,n.jsxs)("span",{children:[e.accountName," (",e.currency,")"]})]})}),(0,n.jsxs)("div",{className:"text-sm text-gray-600",children:[e.bankName," • ",e.accountHolderName]})]}),(0,n.jsxs)(c.Wu,{className:"space-y-6",children:[y&&(0,n.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 text-red-700",children:[(0,n.jsx)(x.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"font-medium",children:"Verification Error"})]}),(0,n.jsx)("p",{className:"text-red-600 mt-1",children:y})]}),g&&(0,n.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 text-green-700",children:[(0,n.jsx)(h.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"font-medium",children:"Success"})]}),(0,n.jsx)("p",{className:"text-green-600 mt-1",children:g})]}),e.isVerified?P():"failed"===B?(0,n.jsxs)("div",{className:"text-center space-y-4",children:[(0,n.jsx)(x.A,{className:"h-16 w-16 text-red-500 mx-auto"}),(0,n.jsx)("h3",{className:"text-xl font-semibold text-red-700",children:"Verification Failed"}),(0,n.jsx)("p",{className:"text-gray-600",children:"The amounts you entered don't match our records. Please check your account statement and try again."}),(0,n.jsxs)("p",{className:"text-sm text-gray-500",children:["Attempts remaining: ",3-e.verificationFailures]}),(0,n.jsxs)("div",{className:"flex space-x-3 justify-center",children:[(0,n.jsx)(l.$,{onClick:()=>{S("deposits_sent"),A(["",""]),b(null)},disabled:e.verificationFailures>=3,children:"Try Again"}),e.verificationFailures>=3&&(0,n.jsx)(l.$,{variant:"outline",onClick:()=>u(null),children:"Choose Different Method"})]})]}):"deposits_sent"===B?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"text-center mb-6",children:[(0,n.jsx)(h.A,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),(0,n.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Micro-Deposits Sent"}),(0,n.jsx)("p",{className:"text-gray-600",children:"We've sent 2 small deposits to your {account.bankName} account ending in {account.accountNumber?.slice(-4) || '****'}."}),(0,n.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Check your account statement and enter the exact amounts below."})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(d.J,{htmlFor:"deposit1",children:"First Deposit Amount"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),(0,n.jsx)(o.p,{id:"deposit1",type:"number",step:"0.01",min:"0",max:"1",placeholder:"0.XX",className:"pl-8",value:v[0],onChange:e=>A([e.target.value,v[1]])})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d.J,{htmlFor:"deposit2",children:"Second Deposit Amount"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),(0,n.jsx)(o.p,{id:"deposit2",type:"number",step:"0.01",min:"0",max:"1",placeholder:"0.XX",className:"pl-8",value:v[1],onChange:e=>A([v[0],e.target.value])})]})]})]}),(0,n.jsxs)("div",{className:"flex space-x-3",children:[(0,n.jsx)(l.$,{onClick:M,disabled:f||!v[0]||!v[1],className:"flex-1",children:f?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Verifying..."]}):"Verify Account"}),(0,n.jsx)(l.$,{variant:"outline",onClick:()=>{u(null),S("pending"),A(["",""])},children:"Back"})]}),(0,n.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm",children:(0,n.jsxs)("p",{className:"text-blue-800",children:[(0,n.jsx)("strong",{children:"Can't find the deposits?"})," They may take up to 2 business days to appear.",'Look for deposits from "Stealth Money" or "SM Verify" in your transaction history.']})})]}):"verified"===B?P():(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"text-center mb-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Verify Your Bank Account"}),(0,n.jsx)("p",{className:"text-gray-600",children:"To send and receive money, we need to verify that you own this account."})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)(c.Zp,{className:"cursor-pointer hover:shadow-md transition-shadow border-2 hover:border-blue-200",onClick:()=>!f&&w(),children:(0,n.jsx)(c.Wu,{className:"p-4",children:(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)(j.A,{className:"h-6 w-6 text-green-600"})}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h4",{className:"font-semibold",children:"Micro-Deposits (Recommended)"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"We'll send 2 small deposits (under $1) to your account. Verify the amounts to complete setup."}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Takes 1-2 business days • Most secure method"})]})]})})}),(0,n.jsx)(c.Zp,{className:"cursor-pointer hover:shadow-md transition-shadow border-2 hover:border-blue-200",onClick:()=>!f&&X(),children:(0,n.jsx)(c.Wu,{className:"p-4",children:(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)(h.A,{className:"h-6 w-6 text-blue-600"})}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h4",{className:"font-semibold",children:"Instant Verification"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Connect through your online banking for immediate verification."}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Instant setup • Powered by Plaid"})]}),(0,n.jsx)(m.E,{variant:"secondary",className:"text-xs",children:"Coming Soon"})]})})})]})]}),t&&!e.isVerified&&"pending"===B&&(0,n.jsx)("div",{className:"pt-4 border-t",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"You can verify this account later, but you won't be able to send or receive money until it's verified."}),(0,n.jsx)(l.$,{variant:"outline",onClick:t,children:"Skip for Now"})]})})]})]})}var B=t(76510),S=t(63859);function w({onComplete:e,onSkip:a,requireVerification:t=!1,requireChileanVerification:r=!1,onAccountAdded:f}){let{getToken:j}=(0,i.d)(),[C,k]=(0,s.useState)([]),[w,M]=(0,s.useState)(!0),[X,T]=(0,s.useState)(!1),[P,U]=(0,s.useState)(null),[F,I]=(0,s.useState)(!1),[E,R]=(0,s.useState)(""),[V,L]=(0,s.useState)(null),[$,q]=(0,s.useState)({accountName:"",country:"",bankId:"",accountHolderName:"",accountType:"",isPrimary:!1}),[H,D]=(0,s.useState)({}),[K,G]=(0,s.useState)(""),[O,Y]=(0,s.useState)(null),z=E?B.qS[E]:null,W=(0,s.useCallback)(e=>{R(e),L(null);let a=B.qS[e];q({accountName:"",country:e,bankId:"",accountHolderName:"",accountType:a?.accountTypes[0]?.value||"",isPrimary:!Array.isArray(C)||0===C.length}),D({})},[C]),J=(0,s.useCallback)(async()=>{try{let e=await j(),a=await fetch("http://localhost:4000/api/users/me/bank-accounts",{headers:{Authorization:`Bearer ${e}`}});if(a.ok){let e=await a.json(),t=e.bankAccounts||e;k(Array.isArray(t)?t:[])}else k([])}catch(e){console.error("Error fetching bank accounts:",e),k([])}finally{M(!1)}},[j]),Z=()=>{let e={};if($.accountName.trim()||(e.accountName="Account name is required"),E||(e.country="Please select a country"),V||(e.bankId="Please select a bank"),$.accountHolderName.trim()||(e.accountHolderName="Account holder name is required"),$.accountType||(e.accountType="Account type is required"),z)for(let a of z.requiredFields){let t=$[a.field];if(!t||"string"!=typeof t||!t.trim()){e[a.field]=`${a.label} is required`;continue}switch(a.validation){case"Chilean RUT":(0,S.validateRUT)(t)||(e[a.field]=(0,S.getRUTValidationError)(t));break;case"IBAN":(0,B.vQ)(t)||(e[a.field]="Invalid IBAN format");break;case"CLABE":(0,B.Ol)(t)||(e[a.field]="CLABE must be 18 digits");break;case"US Routing Number":(0,B.Kt)(t)||(e[a.field]="Routing number must be 9 digits");break;case"UK Sort Code":(0,B.Qc)(t)||(e[a.field]="Sort code must be 6 digits")}}return D(e),0===Object.keys(e).length},_=async e=>{if(e.preventDefault(),Z()&&V&&z){I(!0);try{let e=await j(),a={accountName:$.accountName,currency:z.currency,country:E,bankName:V.name,bankCode:V.code,accountHolderName:$.accountHolderName,accountType:$.accountType,isPrimary:$.isPrimary};z.requiredFields.forEach(e=>{$[e.field]&&(a[e.field]=$[e.field])});let t=P?`http://localhost:4000/api/users/me/bank-accounts/${P.id}`:"http://localhost:4000/api/users/me/bank-accounts",n=P?"PUT":"POST",s=await fetch(t,{method:n,headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(a)});if(s.ok){let e=await s.json();console.log("Bank account created successfully:",e),await J(),ee(),T(!1),U(null),G(`✅ ${e.bankName} account added successfully! Verification required to start sending money.`),setTimeout(()=>G(""),5e3),f&&f(),console.log("Bank account creation completed, form closed")}else{let e=await s.json();console.error("Failed to save bank account:",e),D({general:e.message||"Failed to save bank account"})}}catch(e){console.error("Error saving bank account:",e),D({general:"Failed to save bank account. Please try again."})}finally{I(!1)}}},Q=async e=>{if(confirm("Are you sure you want to delete this bank account?"))try{let a=await j();(await fetch(`http://localhost:4000/api/users/me/bank-accounts/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})).ok?await J():console.error("Failed to delete bank account")}catch(e){console.error("Error deleting bank account:",e)}},ee=()=>{R(""),L(null),q({accountName:"",country:"",bankId:"",accountHolderName:"",accountType:"",isPrimary:!1}),D({}),G("")},ea=e=>{let a=e.country,t=B.qS[a],n=t?.banks.find(a=>a.code===e.bankCode);R(a),L(n||null);let s={accountName:e.accountName,country:a,bankId:n?.id||"",accountHolderName:e.accountHolderName,accountType:e.accountType||"",isPrimary:e.isPrimary};e.iban&&(s.iban=e.iban),e.accountNumber&&(s.accountNumber=e.accountNumber),e.routingNumber&&(s.routingNumber=e.routingNumber),e.rut&&(s.rut=e.rut),e.clabe&&(s.clabe=e.clabe),e.sortCode&&(s.sortCode=e.sortCode),e.ukAccountNumber&&(s.ukAccountNumber=e.ukAccountNumber),q(s),U(e),T(!0)},et=Array.isArray(C)&&C.some(e=>e.isVerified),en=Array.isArray(C)&&C.some(e=>e.isVerified&&"CL"===e.country&&"CLP"===e.currency),es=Array.isArray(C)&&C.length>0&&!et,er=Array.isArray(C)&&C.some(e=>!e.isVerified&&"CL"===e.country&&"CLP"===e.currency),ei=async a=>{console.log("Verification completed for account:",a),Y(null),await J();let t=await fetch("http://localhost:4000/api/users/me/bank-accounts",{headers:{Authorization:`Bearer ${await j()}`}});if(t.ok){let a=await t.json(),n=a.bankAccounts||a,s=!1;r?console.log("Chilean verification requirements met:",s=Array.isArray(n)&&n.some(e=>e.isVerified&&"CL"===e.country&&"CLP"===e.currency)):console.log("General verification requirements met:",s=Array.isArray(n)&&n.some(e=>e.isVerified)),s&&e&&(console.log("All requirements met, calling onComplete"),e())}};return w?(0,n.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):O?(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Verify Bank Account"}),(0,n.jsxs)("p",{className:"text-gray-600",children:["Complete verification for ",O.bankName," to start sending money."]})]}),(0,n.jsx)(A,{account:O,onVerificationComplete:ei,onSkip:()=>Y(null)}),(0,n.jsx)(l.$,{variant:"outline",onClick:()=>Y(null),children:"← Back to Account List"})]}):(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-bold mb-2",children:r?er?"Verify Your Chilean Bank Account":"Chilean Bank Account Setup":es?"Verify Your Bank Account":"Bank Account Setup"}),(0,n.jsx)("p",{className:"text-gray-600",children:r?er?"Complete Chilean bank account verification to start sending money to other Chilean users.":"Add and verify your Chilean bank account to start sending money to other Chilean users.":es?"Complete bank account verification to start sending money globally.":"Add and verify your bank accounts to start sending money globally."})]}),K&&(0,n.jsx)(c.Zp,{className:"border-green-200 bg-green-50",children:(0,n.jsx)(c.Wu,{className:"py-4",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(h.A,{className:"h-5 w-5 text-green-600"}),(0,n.jsx)("span",{className:"font-medium text-green-700",children:K})]})})}),es&&(0,n.jsx)(c.Zp,{className:"border-blue-200 bg-blue-50",children:(0,n.jsx)(c.Wu,{className:"py-6",children:(0,n.jsxs)("div",{className:"text-center space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,n.jsx)(x.A,{className:"h-6 w-6 text-blue-600"}),(0,n.jsx)("span",{className:"text-lg font-semibold text-blue-700",children:"Bank Account Added Successfully!"})]}),(0,n.jsx)("p",{className:"text-blue-600",children:'Your account has been added but needs verification to send money. Click "Verify Account" below to start the verification process.'})]})})}),Array.isArray(C)&&C.length>0&&(0,n.jsx)(c.Zp,{className:(r?en:et)?"border-green-200 bg-green-50":"border-amber-200 bg-amber-50",children:(0,n.jsx)(c.Wu,{className:"py-4",children:(0,n.jsx)("div",{className:"flex items-center gap-2",children:(r?en:et)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.A,{className:"h-5 w-5 text-green-600"}),(0,n.jsx)("span",{className:"font-medium text-green-700",children:r?`You have ${C.filter(e=>e.isVerified&&"CL"===e.country).length} verified Chilean account(s)`:`You have ${C.filter(e=>e.isVerified).length} verified account(s)`})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.A,{className:"h-5 w-5 text-amber-600"}),(0,n.jsx)("span",{className:"font-medium text-amber-700",children:r?"Chilean bank account verification required":"Verification required for your bank account(s)"})]})})})}),Array.isArray(C)&&C.length>0&&(0,n.jsx)("div",{className:"space-y-3",children:C.map(e=>(0,n.jsx)(c.Zp,{className:"relative",children:(0,n.jsx)(c.Wu,{className:"py-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(p,{className:"h-8 w-8 text-gray-400"}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("h4",{className:"font-semibold",children:e.accountName}),e.isPrimary&&(0,n.jsx)(m.E,{variant:"secondary",children:"Primary"}),(0,n.jsx)(m.E,{variant:e.isVerified?"default":"outline",children:e.isVerified?"Verified":"Pending"})]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[e.bankName," • ",e.currency," •","checking"===e.accountType?" Checking":" Savings"]}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:B.qS[e.country]?.countryName}),!e.isVerified&&(0,n.jsxs)("p",{className:"text-xs text-amber-600 mt-1 flex items-center gap-1",children:[(0,n.jsx)(x.A,{className:"h-3 w-3"}),"Verification required to send money"]})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[!e.isVerified&&(0,n.jsx)(l.$,{variant:"outline",size:"sm",className:"border-blue-500 text-blue-600 hover:bg-blue-50",onClick:()=>{Y(e)},children:"Verify Account"}),(0,n.jsx)(l.$,{variant:"ghost",size:"sm",onClick:()=>ea(e),children:(0,n.jsx)(y,{className:"h-4 w-4"})}),(0,n.jsx)(l.$,{variant:"ghost",size:"sm",onClick:()=>Q(e.id),children:(0,n.jsx)(b,{className:"h-4 w-4 text-red-500"})})]})]})})},e.id))}),!X&&(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsxs)(l.$,{onClick:()=>{ee(),T(!0)},className:"flex-1",variant:es?"ghost":"outline",children:[(0,n.jsx)(g.A,{className:"h-4 w-4 mr-2"}),es?"Add Another Account":"Add Bank Account"]}),a&&!t&&!r&&!es&&(0,n.jsx)(l.$,{onClick:a,variant:"ghost",children:"Skip for now"})]}),X&&(0,n.jsxs)(c.Zp,{children:[(0,n.jsxs)(c.aR,{children:[(0,n.jsx)(c.ZB,{children:P?"Edit Bank Account":"Add New Bank Account"}),(0,n.jsx)(c.BT,{children:"Select your country first, then choose your bank and provide account details."})]}),(0,n.jsx)(c.Wu,{children:(0,n.jsxs)("form",{onSubmit:_,className:"space-y-6",children:[H.general&&(0,n.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,n.jsx)("p",{className:"text-sm text-red-600",children:H.general})}),(0,n.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[(0,n.jsx)(N.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{children:"Step 1: Select Your Country"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d.J,{htmlFor:"country",children:"Country"}),(0,n.jsxs)(u.l6,{value:E,onValueChange:W,children:[(0,n.jsx)(u.bq,{className:H.country?"border-red-500":"",children:(0,n.jsx)(u.yv,{placeholder:"Choose your country"})}),(0,n.jsx)(u.gC,{children:Object.values(B.qS).filter(e=>!r||"CL"===e.countryCode).sort((e,a)=>e.countryName.localeCompare(a.countryName)).map(e=>(0,n.jsx)(u.eb,{value:e.countryCode,children:(0,n.jsxs)("span",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{children:e.flag}),(0,n.jsx)("span",{children:e.countryName}),(0,n.jsxs)("span",{className:"text-gray-500",children:["(",e.currency,")"]})]})},e.countryCode))})]}),H.country&&(0,n.jsx)("p",{className:"text-sm text-red-500 mt-1",children:H.country})]})]}),E&&z&&(0,n.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[(0,n.jsx)(p,{className:"h-4 w-4"}),(0,n.jsx)("span",{children:"Step 2: Select Your Bank"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d.J,{htmlFor:"bank",children:"Bank"}),(0,n.jsxs)(u.l6,{value:$.bankId,onValueChange:e=>{z&&(L(z.banks.find(a=>a.id===e)||null),q(a=>({...a,bankId:e})))},children:[(0,n.jsx)(u.bq,{className:H.bankId?"border-red-500":"",children:(0,n.jsx)(u.yv,{placeholder:"Choose your bank"})}),(0,n.jsx)(u.gC,{children:z.banks.map(e=>(0,n.jsx)(u.eb,{value:e.id,children:e.name},e.id))})]}),H.bankId&&(0,n.jsx)("p",{className:"text-sm text-red-500 mt-1",children:H.bankId})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d.J,{htmlFor:"accountType",children:"Account Type"}),(0,n.jsxs)(u.l6,{value:$.accountType,onValueChange:e=>q(a=>({...a,accountType:e})),children:[(0,n.jsx)(u.bq,{className:H.accountType?"border-red-500":"",children:(0,n.jsx)(u.yv,{placeholder:"Select account type"})}),(0,n.jsx)(u.gC,{children:z.accountTypes.map(e=>(0,n.jsx)(u.eb,{value:e.value,children:e.label},e.value))})]}),H.accountType&&(0,n.jsx)("p",{className:"text-sm text-red-500 mt-1",children:H.accountType})]})]}),V&&z&&(0,n.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[(0,n.jsx)(v.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{children:"Step 3: Account Details"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d.J,{htmlFor:"accountName",children:"Account Nickname"}),(0,n.jsx)(o.p,{id:"accountName",value:$.accountName,onChange:e=>q(a=>({...a,accountName:e.target.value})),placeholder:"e.g., My Chilean Account",className:H.accountName?"border-red-500":""}),H.accountName&&(0,n.jsx)("p",{className:"text-sm text-red-500 mt-1",children:H.accountName})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d.J,{htmlFor:"accountHolderName",children:"Account Holder Name"}),(0,n.jsx)(o.p,{id:"accountHolderName",value:$.accountHolderName,onChange:e=>q(a=>({...a,accountHolderName:e.target.value})),placeholder:"Full name as it appears on the account",className:H.accountHolderName?"border-red-500":""}),H.accountHolderName&&(0,n.jsx)("p",{className:"text-sm text-red-500 mt-1",children:H.accountHolderName})]}),z?z.requiredFields.map(e=>(0,n.jsxs)("div",{children:[(0,n.jsx)(d.J,{htmlFor:e.field,children:e.label}),(0,n.jsx)(o.p,{id:e.field,type:e.type,value:String($[e.field]||""),onChange:a=>{let t=a.target.value;"rut"===e.field?t=(0,S.formatRUTInput)(t):"sortCode"===e.field&&(t=(0,B.RB)(t)),q(a=>({...a,[e.field]:t}))},placeholder:e.placeholder,maxLength:e.maxLength,className:H[e.field]?"border-red-500":""}),H[e.field]&&(0,n.jsx)("p",{className:"text-sm text-red-500 mt-1",children:H[e.field]})]},e.field)):null,Array.isArray(C)&&C.length>0&&(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("input",{type:"checkbox",id:"isPrimary",checked:$.isPrimary,onChange:e=>q(a=>({...a,isPrimary:e.target.checked})),className:"rounded border-gray-300"}),(0,n.jsxs)(d.J,{htmlFor:"isPrimary",className:"text-sm font-normal",children:["Set as primary account for ",z.currency]})]})]}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)(l.$,{type:"submit",disabled:F,className:"flex-1",children:F?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):P?"Update Account":"Add Account"}),(0,n.jsx)(l.$,{type:"button",variant:"outline",onClick:()=>{T(!1),U(null),ee()},children:"Cancel"})]})]})})]})]})}function M({children:e,requireVerification:a=!1,onOnboardingComplete:t,skipCheckOnPublicPages:c=!1,blockTransfersUntilVerified:l=!1,requireChileanVerification:o=!1}){let{getToken:d}=(0,i.d)(),[u,m]=(0,s.useState)(!0),[h,x]=(0,s.useState)(!1),[,f]=(0,s.useState)([]),p=r().useCallback(async()=>{try{return m(!0),void x(!1)}catch(e){e instanceof Error&&"AbortError"===e.name?console.warn("Onboarding status check timed out (API may be slow or unavailable)"):console.warn("Onboarding status check error (API may not be running):",e),x(!1)}finally{m(!1)}},[d,o,a,l]);return u?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[200px]",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Checking account status..."})]})}):h?(0,n.jsx)(w,{onComplete:()=>{console.log("OnboardingGate: Onboarding completed, refreshing status..."),p(),t&&t()},onSkip:a||l||o?void 0:()=>{l||o||x(!1)},requireVerification:a||l||o,requireChileanVerification:o,onAccountAdded:()=>{console.log("OnboardingGate: Account added, refreshing status..."),p()}}):(0,n.jsx)(n.Fragment,{children:e})}}};