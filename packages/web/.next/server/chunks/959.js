"use strict";exports.id=959,exports.ids=[959],exports.modules={986:(e,s,a)=>{a.d(s,{A:()=>r});let r=(0,a(84667).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},67959:(e,s,a)=>{a.d(s,{d:()=>D,n:()=>w});var r=a(13486),t=a(60159),c=a(21232),n=a(86698),l=a(49933),i=a(15998),d=a(57956),m=a(63821),x=a(21800);let o=(0,a(84667).A)("building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);var h=a(97493),p=a(86e3),u=a(15577),j=a(986),y=a(74941),g=a(29563),v=a(23025),N=a(41571),f=a(20276);let b=c.Ik({number:c.Yj().min(13,"Card number must be at least 13 digits").max(19,"Card number cannot exceed 19 digits"),expiryMonth:c.ai().min(1,"Invalid month").max(12,"Invalid month"),expiryYear:c.ai().min(new Date().getFullYear(),"Card has expired").max(new Date().getFullYear()+20,"Invalid year"),cvv:c.Yj().min(3,"CVV must be at least 3 digits").max(4,"CVV cannot exceed 4 digits")}),A=c.Ik({cardDetails:b});function w({sendAmount:e,receiveAmount:s,exchangeRate:a,fees:w,rateId:D,onSubmit:C,isLoading:k=!1,transferData:F,recipientUser:I,selectedPaymentMethod:Y,onSuccess:M,onBack:S,onError:$}){let B=!!(F&&I&&Y),T=F||{sendAmount:e,receiveAmount:s,sendCurrency:"USD",receiveCurrency:"EUR",exchangeRate:a,fees:w,rateId:D,rateValidUntil:"",calculatorMode:"send",breakdown:{sendAmountUSD:e,fees:{cardProcessing:0,transfer:0,payout:0,total:w},netAmountUSD:e-w,exchangeRate:a,receiveAmount:s},estimatedArrival:""},[E,J]=(0,t.useState)({number:"",expiryMonth:1,expiryYear:new Date().getFullYear(),cvv:""}),[P,R]=(0,t.useState)({name:"",email:"",bankAccount:{iban:"",bic:"",bankName:"",accountHolderName:"",country:"DE"}}),[V,U]=(0,t.useState)({}),[Z,L]=(0,t.useState)(!1),W=e=>{let s=e.replace(/\s/g,"").replace(/[^0-9]/gi,""),a=s.match(/\d{4,16}/g),r=a&&a[0]||"",t=[];for(let e=0,s=r.length;e<s;e+=4)t.push(r.substring(e,e+4));return t.length?t.join(" "):s},z=(e,s)=>{J(a=>({...a,[e]:s})),V[`cardDetails.${e}`]&&U(s=>{let a={...s};return delete a[`cardDetails.${e}`],a})},H=(e,s)=>{if(e.startsWith("bankAccount.")){let a=e.replace("bankAccount.","");R(e=>({...e,bankAccount:{...e.bankAccount,[a]:s}}))}else R(a=>({...a,[e]:s}));V[`recipientInfo.${e}`]&&U(s=>{let a={...s};return delete a[`recipientInfo.${e}`],a})},O=async()=>"mock-token",_="CLP"===T.sendCurrency&&"CLP"===T.receiveCurrency,G=async e=>{e.preventDefault(),U({}),L(!0);try{if(B){let e={cardDetails:{...E,number:E.number.replace(/\s/g,"")}};A.parse(e);let s="http://localhost:4000",a=_?`${s}/api/transfers/create-chilean-user-transfer`:`${s}/api/transfers/create-user-to-user`,r=_?{sendAmount:T.sendAmount,sendCurrency:T.sendCurrency,receiveCurrency:T.receiveCurrency,rateId:T.rateId,cardDetails:e.cardDetails,recipientUserId:I.id,recipientPaymentMethodId:Y.id,transferType:"chilean_user_to_user"}:{sendAmount:T.sendAmount,sendCurrency:T.sendCurrency,receiveCurrency:T.receiveCurrency,rateId:T.rateId,cardDetails:e.cardDetails,recipientUserId:I.id,recipientPaymentMethodId:Y.id},t=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await O()}`},body:JSON.stringify(r)});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.message||"Failed to create transfer")}let c=await t.json();M&&M(c.transferId)}else{let e={cardDetails:{...E,number:E.number.replace(/\s/g,"")},recipientInfo:{...P,bankAccount:{...P.bankAccount,iban:P.bankAccount.iban.replace(/\s/g,"")}}};c.Ik({cardDetails:b,recipientInfo:c.Ik({name:c.Yj().min(2,"Name must be at least 2 characters").max(100,"Name cannot exceed 100 characters"),email:c.Yj().email("Invalid email address"),bankAccount:c.Ik({iban:c.Yj().min(15,"IBAN must be at least 15 characters").max(34,"IBAN cannot exceed 34 characters"),bic:c.Yj().min(8,"BIC must be at least 8 characters").max(11,"BIC cannot exceed 11 characters"),bankName:c.Yj().min(2,"Bank name must be at least 2 characters").max(100,"Bank name cannot exceed 100 characters"),accountHolderName:c.Yj().min(2,"Account holder name must be at least 2 characters").max(100,"Account holder name cannot exceed 100 characters"),country:c.eu("DE").refine(()=>!0,{message:"Only German bank accounts are supported"})})})}).parse(e),C(e)}}catch(e){if(console.error("Transfer creation error:",e),e instanceof n.G){let s={};e.issues.forEach(e=>{s[e.path.join(".")]=e.message}),U(s)}else{let s=e instanceof Error?e.message:"Failed to create transfer";$&&$(s)}}finally{L(!1)}},X=T.sendAmount+T.fees;return B?(0,r.jsxs)("div",{className:"w-full max-w-4xl mx-auto space-y-6",children:[S&&(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(y.$,{variant:"outline",onClick:S,disabled:k||Z,className:"flex items-center gap-2",children:[(0,r.jsx)(i.A,{className:"h-4 w-4"}),"Back"]}),(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Complete Payment"}),(0,r.jsx)("div",{})," "]}),(0,r.jsxs)(g.Zp,{children:[(0,r.jsx)(g.aR,{children:(0,r.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(d.A,{className:"h-5 w-5"}),"Transfer Summary"]})}),(0,r.jsxs)(g.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"From"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,r.jsx)(d.A,{className:"w-5 h-5 text-blue-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"You"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Sending via card payment"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"To"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[I.profileImageUrl?(0,r.jsx)(l.default,{src:I.profileImageUrl,alt:I.fullName,width:40,height:40,className:"w-10 h-10 rounded-full object-cover"}):(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center",children:(0,r.jsx)(d.A,{className:"w-5 h-5 text-gray-500"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"font-medium",children:I.fullName}),I.isVerified&&(0,r.jsx)(m.A,{className:"w-4 h-4 text-green-500"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[(0,r.jsx)(x.A,{className:"w-3 h-3"}),(0,r.jsx)("span",{children:I.email})]})]})]})]})]}),(0,r.jsx)("div",{className:"border-t pt-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"You Send"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[T.sendAmount.toFixed(2)," ",T.sendCurrency]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["+ ",T.fees.toFixed(2)," ",T.sendCurrency," fees"]}),(0,r.jsxs)("div",{className:"text-lg font-semibold border-t pt-2",children:["Total: ",X.toFixed(2)," ",T.sendCurrency]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"They Receive"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[T.receiveAmount.toFixed(2)," ",T.receiveCurrency]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Exchange rate: 1 ",T.sendCurrency," = ",T.exchangeRate.toFixed(4)," ",T.receiveCurrency]}),T.estimatedArrival&&(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Estimated arrival: ",T.estimatedArrival]})]})]})})]})]}),(0,r.jsxs)(g.Zp,{children:[(0,r.jsxs)(g.aR,{children:[(0,r.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(o,{className:"h-5 w-5"}),"Recipient's Bank Account"]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[I.fullName," will receive the money in their verified account"]})]}),(0,r.jsx)(g.Wu,{children:(0,r.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsx)(h.A,{className:"w-5 h-5 text-gray-500"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"font-medium",children:Y.bankName||`${Y.type.replace("_"," ")}`}),(0,r.jsx)(f.E,{variant:"secondary",className:"text-xs",children:Y.currency}),Y.isDefault&&(0,r.jsx)(f.E,{variant:"outline",className:"text-xs",children:"Default"})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[Y.accountType," • ",Y.country,Y.lastFourDigits&&(0,r.jsxs)("span",{children:[" • ****",Y.lastFourDigits]})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Verified ",new Date(Y.verifiedAt).toLocaleDateString()]})]}),(0,r.jsx)(m.A,{className:"w-5 h-5 text-green-500"})]})})]}),(0,r.jsxs)(g.Zp,{children:[(0,r.jsxs)(g.aR,{children:[(0,r.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(h.A,{className:"h-5 w-5"}),"Your Payment Method"]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Enter your card details to complete the transfer"})]}),(0,r.jsx)(g.Wu,{children:(0,r.jsxs)("form",{onSubmit:G,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"card-number",children:"Card Number"}),(0,r.jsx)(v.p,{id:"card-number",type:"text",placeholder:"1234 5678 9012 3456",value:W(E.number),onChange:e=>z("number",e.target.value.replace(/\s/g,"")),className:V["cardDetails.number"]?"border-red-500":"",maxLength:19}),V["cardDetails.number"]&&(0,r.jsxs)("p",{className:"text-sm text-red-500 mt-1 flex items-center gap-1",children:[(0,r.jsx)(p.A,{className:"h-3 w-3"}),V["cardDetails.number"]]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"expiry-month",children:"Month"}),(0,r.jsx)(v.p,{id:"expiry-month",type:"number",placeholder:"MM",min:"1",max:"12",value:E.expiryMonth,onChange:e=>z("expiryMonth",parseInt(e.target.value)||1),className:V["cardDetails.expiryMonth"]?"border-red-500":""}),V["cardDetails.expiryMonth"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V["cardDetails.expiryMonth"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"expiry-year",children:"Year"}),(0,r.jsx)(v.p,{id:"expiry-year",type:"number",placeholder:"YYYY",min:new Date().getFullYear(),max:new Date().getFullYear()+20,value:E.expiryYear,onChange:e=>z("expiryYear",parseInt(e.target.value)||new Date().getFullYear()),className:V["cardDetails.expiryYear"]?"border-red-500":""}),V["cardDetails.expiryYear"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V["cardDetails.expiryYear"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"cvv",children:"CVV"}),(0,r.jsx)(v.p,{id:"cvv",type:"text",placeholder:"123",maxLength:4,value:E.cvv,onChange:e=>z("cvv",e.target.value.replace(/[^0-9]/g,"")),className:V["cardDetails.cvv"]?"border-red-500":""}),V["cardDetails.cvv"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V["cardDetails.cvv"]})]})]})]}),(0,r.jsx)(y.$,{type:"submit",disabled:k||Z,className:"w-full",size:"lg",children:k||Z?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing Transfer..."]}):`Send ${X.toFixed(2)} ${T.sendCurrency} to ${I.fullName}`}),(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-xs text-muted-foreground",children:[(0,r.jsx)(j.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Secured by Circle • PCI DSS Compliant"})]})]})})]})]}):(0,r.jsxs)(g.Zp,{className:"w-full max-w-2xl mx-auto",children:[(0,r.jsxs)(g.aR,{children:[(0,r.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(h.A,{className:"h-5 w-5"}),"Complete Your Transfer"]}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"You send:"}),(0,r.jsxs)("span",{className:"font-medium",children:["$",T.sendAmount.toFixed(2)," ",T.sendCurrency]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Fees:"}),(0,r.jsxs)("span",{className:"font-medium",children:["$",T.fees.toFixed(2)," ",T.sendCurrency]})]}),(0,r.jsxs)("div",{className:"flex justify-between border-t pt-1 mt-1",children:[(0,r.jsx)("span",{children:"Total to pay:"}),(0,r.jsxs)("span",{className:"font-bold",children:["$",X.toFixed(2)," ",T.sendCurrency]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,r.jsx)("span",{children:"Recipient gets:"}),(0,r.jsxs)("span",{className:"font-bold",children:["€",T.receiveAmount.toFixed(2)," ",T.receiveCurrency]})]})]})]}),(0,r.jsx)(g.Wu,{children:(0,r.jsxs)("form",{onSubmit:G,className:"space-y-8",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)(h.A,{className:"h-4 w-4"}),(0,r.jsx)("h3",{className:"font-semibold",children:"Payment Details"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"card-number",children:"Card Number"}),(0,r.jsx)(v.p,{id:"card-number",type:"text",placeholder:"1234 5678 9012 3456",value:W(E.number),onChange:e=>z("number",e.target.value.replace(/\s/g,"")),className:V["cardDetails.number"]?"border-red-500":"",maxLength:19}),V["cardDetails.number"]&&(0,r.jsxs)("p",{className:"text-sm text-red-500 mt-1 flex items-center gap-1",children:[(0,r.jsx)(p.A,{className:"h-3 w-3"}),V["cardDetails.number"]]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"expiry-month",children:"Month"}),(0,r.jsx)(v.p,{id:"expiry-month",type:"number",placeholder:"MM",min:"1",max:"12",value:E.expiryMonth,onChange:e=>z("expiryMonth",parseInt(e.target.value)||1),className:V["cardDetails.expiryMonth"]?"border-red-500":""}),V["cardDetails.expiryMonth"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V["cardDetails.expiryMonth"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"expiry-year",children:"Year"}),(0,r.jsx)(v.p,{id:"expiry-year",type:"number",placeholder:"YYYY",min:new Date().getFullYear(),max:new Date().getFullYear()+20,value:E.expiryYear,onChange:e=>z("expiryYear",parseInt(e.target.value)||new Date().getFullYear()),className:V["cardDetails.expiryYear"]?"border-red-500":""}),V["cardDetails.expiryYear"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V["cardDetails.expiryYear"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"cvv",children:"CVV"}),(0,r.jsx)(v.p,{id:"cvv",type:"text",placeholder:"123",maxLength:4,value:E.cvv,onChange:e=>z("cvv",e.target.value.replace(/[^0-9]/g,"")),className:V["cardDetails.cvv"]?"border-red-500":""}),V["cardDetails.cvv"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V["cardDetails.cvv"]})]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)(d.A,{className:"h-4 w-4"}),(0,r.jsx)("h3",{className:"font-semibold",children:"Recipient Information"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"recipient-name",children:"Full Name"}),(0,r.jsx)(v.p,{id:"recipient-name",type:"text",placeholder:"John Doe",value:P.name,onChange:e=>H("name",e.target.value),className:V["recipientInfo.name"]?"border-red-500":""}),V["recipientInfo.name"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V["recipientInfo.name"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"recipient-email",children:"Email Address"}),(0,r.jsx)(v.p,{id:"recipient-email",type:"email",placeholder:"john@example.com",value:P.email,onChange:e=>H("email",e.target.value),className:V["recipientInfo.email"]?"border-red-500":""}),V["recipientInfo.email"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V["recipientInfo.email"]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)(o,{className:"h-4 w-4"}),(0,r.jsx)("h3",{className:"font-semibold",children:"Bank Account Details (Germany)"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"iban",children:"IBAN"}),(0,r.jsx)(v.p,{id:"iban",type:"text",placeholder:"DE89 3704 0044 0532 0130 00",value:P.bankAccount.iban.replace(/\s/g,"").toUpperCase().replace(/(.{4})/g,"$1 ").trim(),onChange:e=>H("bankAccount.iban",e.target.value.replace(/\s/g,"")),className:V["recipientInfo.bankAccount.iban"]?"border-red-500":""}),V["recipientInfo.bankAccount.iban"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V["recipientInfo.bankAccount.iban"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"bic",children:"BIC/SWIFT Code"}),(0,r.jsx)(v.p,{id:"bic",type:"text",placeholder:"COBADEFFXXX",value:P.bankAccount.bic,onChange:e=>H("bankAccount.bic",e.target.value.toUpperCase()),className:V["recipientInfo.bankAccount.bic"]?"border-red-500":""}),V["recipientInfo.bankAccount.bic"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V["recipientInfo.bankAccount.bic"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"bank-name",children:"Bank Name"}),(0,r.jsx)(v.p,{id:"bank-name",type:"text",placeholder:"Deutsche Bank",value:P.bankAccount.bankName,onChange:e=>H("bankAccount.bankName",e.target.value),className:V["recipientInfo.bankAccount.bankName"]?"border-red-500":""}),V["recipientInfo.bankAccount.bankName"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V["recipientInfo.bankAccount.bankName"]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"account-holder",children:"Account Holder Name"}),(0,r.jsx)(v.p,{id:"account-holder",type:"text",placeholder:"John Doe",value:P.bankAccount.accountHolderName,onChange:e=>H("bankAccount.accountHolderName",e.target.value),className:V["recipientInfo.bankAccount.accountHolderName"]?"border-red-500":""}),V["recipientInfo.bankAccount.accountHolderName"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:V["recipientInfo.bankAccount.accountHolderName"]})]})]})]}),(0,r.jsx)(y.$,{type:"submit",disabled:k||Z,className:"w-full",size:"lg",children:k||Z?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing Transfer..."]}):`Send ${T.sendAmount.toFixed(2)} USD`}),(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-xs text-muted-foreground",children:[(0,r.jsx)(j.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Secured by Circle • PCI DSS Compliant"})]})]})})]})}function D({transferData:e,recipientUser:s,selectedPaymentMethod:a,onSuccess:c,onBack:b,onError:w,isLoading:D=!1}){let[C,k]=(0,t.useState)({number:"",expiryMonth:1,expiryYear:new Date().getFullYear(),cvv:""}),[F,I]=(0,t.useState)({}),[Y,M]=(0,t.useState)(!1),S=(e,s)=>{k(a=>({...a,[e]:s})),F[`cardDetails.${e}`]&&I(s=>{let a={...s};return delete a[`cardDetails.${e}`],a})},$=async r=>{r.preventDefault(),I({}),M(!0);try{let r={cardDetails:{...C,number:C.number.replace(/\s/g,"")}};A.parse(r);let t=await fetch("http://localhost:4000/api/transfers/create-user-to-user",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await B()}`},body:JSON.stringify({sendAmount:e.sendAmount,sendCurrency:e.sendCurrency,receiveCurrency:e.receiveCurrency,rateId:e.rateId,cardDetails:r.cardDetails,recipientUserId:s.id,recipientPaymentMethodId:a.id})});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.message||"Failed to create transfer")}let n=await t.json();c(n.transferId)}catch(e){if(console.error("Transfer creation error:",e),e instanceof n.G){let s={};e.issues.forEach(e=>{s[e.path.join(".")]=e.message}),I(s)}else w(e instanceof Error?e.message:"Failed to create transfer")}finally{M(!1)}},B=async()=>"mock-token",T=e.sendAmount+e.fees;return(0,r.jsxs)("div",{className:"w-full max-w-4xl mx-auto space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(y.$,{variant:"outline",onClick:b,disabled:D||Y,className:"flex items-center gap-2",children:[(0,r.jsx)(i.A,{className:"h-4 w-4"}),"Back"]}),(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Complete Payment"}),(0,r.jsx)("div",{})," "]}),(0,r.jsxs)(g.Zp,{children:[(0,r.jsx)(g.aR,{children:(0,r.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(d.A,{className:"h-5 w-5"}),"Transfer Summary"]})}),(0,r.jsxs)(g.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"From"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,r.jsx)(d.A,{className:"w-5 h-5 text-blue-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"You"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Sending via card payment"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"To"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[s.profileImageUrl?(0,r.jsx)(l.default,{src:s.profileImageUrl,alt:s.fullName,width:40,height:40,className:"w-10 h-10 rounded-full object-cover"}):(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center",children:(0,r.jsx)(d.A,{className:"w-5 h-5 text-gray-500"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"font-medium",children:s.fullName}),s.isVerified&&(0,r.jsx)(m.A,{className:"w-4 h-4 text-green-500"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[(0,r.jsx)(x.A,{className:"w-3 h-3"}),(0,r.jsx)("span",{children:s.email})]})]})]})]})]}),(0,r.jsx)("div",{className:"border-t pt-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"You Send"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[e.sendAmount.toFixed(2)," ",e.sendCurrency]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["+ ",e.fees.toFixed(2)," ",e.sendCurrency," fees"]}),(0,r.jsxs)("div",{className:"text-lg font-semibold border-t pt-2",children:["Total: ",T.toFixed(2)," ",e.sendCurrency]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:"They Receive"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[e.receiveAmount.toFixed(2)," ",e.receiveCurrency]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Exchange rate: 1 ",e.sendCurrency," = ",e.exchangeRate.toFixed(4)," ",e.receiveCurrency]}),e.estimatedArrival&&(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Estimated arrival: ",e.estimatedArrival]})]})]})})]})]}),(0,r.jsxs)(g.Zp,{children:[(0,r.jsxs)(g.aR,{children:[(0,r.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(o,{className:"h-5 w-5"}),"Recipient's Bank Account"]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[s.fullName," will receive the money in their verified account"]})]}),(0,r.jsx)(g.Wu,{children:(0,r.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsx)(h.A,{className:"w-5 h-5 text-gray-500"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"font-medium",children:a.bankName||`${a.type.replace("_"," ")}`}),(0,r.jsx)(f.E,{variant:"secondary",className:"text-xs",children:a.currency}),a.isDefault&&(0,r.jsx)(f.E,{variant:"outline",className:"text-xs",children:"Default"})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[a.accountType," • ",a.country,a.lastFourDigits&&(0,r.jsxs)("span",{children:[" • ****",a.lastFourDigits]})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Verified ",new Date(a.verifiedAt).toLocaleDateString()]})]}),(0,r.jsx)(m.A,{className:"w-5 h-5 text-green-500"})]})})]}),(0,r.jsxs)(g.Zp,{children:[(0,r.jsxs)(g.aR,{children:[(0,r.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(h.A,{className:"h-5 w-5"}),"Your Payment Method"]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Enter your card details to complete the transfer"})]}),(0,r.jsx)(g.Wu,{children:(0,r.jsxs)("form",{onSubmit:$,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"card-number",children:"Card Number"}),(0,r.jsx)(v.p,{id:"card-number",type:"text",placeholder:"1234 5678 9012 3456",value:(e=>{let s=e.replace(/\s/g,"").replace(/[^0-9]/gi,""),a=s.match(/\d{4,16}/g),r=a&&a[0]||"",t=[];for(let e=0,s=r.length;e<s;e+=4)t.push(r.substring(e,e+4));return t.length?t.join(" "):s})(C.number),onChange:e=>S("number",e.target.value.replace(/\s/g,"")),className:F["cardDetails.number"]?"border-red-500":"",maxLength:19}),F["cardDetails.number"]&&(0,r.jsxs)("p",{className:"text-sm text-red-500 mt-1 flex items-center gap-1",children:[(0,r.jsx)(p.A,{className:"h-3 w-3"}),F["cardDetails.number"]]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"expiry-month",children:"Month"}),(0,r.jsx)(v.p,{id:"expiry-month",type:"number",placeholder:"MM",min:"1",max:"12",value:C.expiryMonth,onChange:e=>S("expiryMonth",parseInt(e.target.value)||1),className:F["cardDetails.expiryMonth"]?"border-red-500":""}),F["cardDetails.expiryMonth"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:F["cardDetails.expiryMonth"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"expiry-year",children:"Year"}),(0,r.jsx)(v.p,{id:"expiry-year",type:"number",placeholder:"YYYY",min:new Date().getFullYear(),max:new Date().getFullYear()+20,value:C.expiryYear,onChange:e=>S("expiryYear",parseInt(e.target.value)||new Date().getFullYear()),className:F["cardDetails.expiryYear"]?"border-red-500":""}),F["cardDetails.expiryYear"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:F["cardDetails.expiryYear"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N.J,{htmlFor:"cvv",children:"CVV"}),(0,r.jsx)(v.p,{id:"cvv",type:"text",placeholder:"123",maxLength:4,value:C.cvv,onChange:e=>S("cvv",e.target.value.replace(/[^0-9]/g,"")),className:F["cardDetails.cvv"]?"border-red-500":""}),F["cardDetails.cvv"]&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:F["cardDetails.cvv"]})]})]})]}),(0,r.jsx)(y.$,{type:"submit",disabled:D||Y,className:"w-full",size:"lg",children:D||Y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing Transfer..."]}):`Send ${T.toFixed(2)} ${e.sendCurrency} to ${s.fullName}`}),(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-xs text-muted-foreground",children:[(0,r.jsx)(j.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Secured by Circle • PCI DSS Compliant"})]})]})})]})]})}}};