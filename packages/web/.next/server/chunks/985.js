"use strict";exports.id=985,exports.ids=[985],exports.modules={12370:(e,a,t)=>{t.d(a,{A:()=>k});var s=t(13486),n=t(60159),l=t(29563),r=t(74941),c=t(23025),i=t(41571),d=t(86629),o=t(20276),m=t(76123),u=t(63821),x=t(86e3),h=t(84667);let p=(0,h.A)("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),b=(0,h.A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),f=(0,h.A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var g=t(74439),y=t(58350),N=t(97493);let j={CL:{countryCode:"CL",countryName:"Chile",currency:"CLP",flag:"\uD83C\uDDE8\uD83C\uDDF1",banks:[{id:"cl-001",name:"Banco de Chile",code:"001"},{id:"cl-012",name:"Banco del Estado (BancoEstado)",code:"012"},{id:"cl-016",name:"Banco de Cr\xe9dito e Inversiones (BCI)",code:"016"},{id:"cl-037",name:"Banco Santander Chile",code:"037"},{id:"cl-039",name:"Banco Ita\xfa Chile",code:"039"},{id:"cl-049",name:"Banco Security",code:"049"},{id:"cl-051",name:"Banco Falabella",code:"051"},{id:"cl-053",name:"Banco Ripley",code:"053"},{id:"cl-054",name:"Banco Consorcio",code:"054"},{id:"cl-055",name:"Banco BICE",code:"055"},{id:"cl-504",name:"Scotiabank Chile",code:"504"}],accountTypes:[{value:"checking",label:"Cuenta Corriente"},{value:"savings",label:"Cuenta de Ahorro"},{value:"vista",label:"Cuenta Vista"},{value:"rut",label:"Cuenta RUT (BancoEstado)"}],requiredFields:[{field:"rut",label:"RUT del Titular",type:"text",placeholder:"12.345.678-9",validation:"Chilean RUT",maxLength:12},{field:"accountNumber",label:"N\xfamero de Cuenta",type:"text",placeholder:"0123456789",maxLength:20}]},US:{countryCode:"US",countryName:"United States",currency:"USD",flag:"\uD83C\uDDFA\uD83C\uDDF8",banks:[{id:"us-boa",name:"Bank of America",code:"BOFAUS3N",swift:"BOFAUS3N"},{id:"us-chase",name:"JPMorgan Chase",code:"CHASUS33",swift:"CHASUS33"},{id:"us-wells",name:"Wells Fargo",code:"WFBIUS6S",swift:"WFBIUS6S"},{id:"us-citi",name:"Citibank",code:"CITIUS33",swift:"CITIUS33"},{id:"us-pnc",name:"PNC Bank",code:"PNCCUS33",swift:"PNCCUS33"},{id:"us-usbank",name:"U.S. Bank",code:"USBKUS44",swift:"USBKUS44"},{id:"us-capital",name:"Capital One",code:"HIBKUS44",swift:"HIBKUS44"},{id:"us-td",name:"TD Bank",code:"NRTHUS33",swift:"NRTHUS33"},{id:"us-regions",name:"Regions Bank",code:"UPNBUS44",swift:"UPNBUS44"},{id:"us-fifth",name:"Fifth Third Bank",code:"FTBCUS3C",swift:"FTBCUS3C"}],accountTypes:[{value:"checking",label:"Checking Account"},{value:"savings",label:"Savings Account"},{value:"money_market",label:"Money Market Account"}],requiredFields:[{field:"routingNumber",label:"Routing Number (ABA)",type:"text",placeholder:"123456789",validation:"US Routing Number",maxLength:9},{field:"accountNumber",label:"Account Number",type:"text",placeholder:"1234567890",maxLength:17}]},DE:{countryCode:"DE",countryName:"Germany",currency:"EUR",flag:"\uD83C\uDDE9\uD83C\uDDEA",banks:[{id:"de-deutsche",name:"Deutsche Bank",code:"DEUTDEFF",swift:"DEUTDEFF"},{id:"de-commerzbank",name:"Commerzbank",code:"COBADEFF",swift:"COBADEFF"},{id:"de-dkb",name:"DKB (Deutsche Kreditbank)",code:"BYLADEM1",swift:"BYLADEM1"},{id:"de-postbank",name:"Postbank",code:"PBNKDEFF",swift:"PBNKDEFF"},{id:"de-sparkasse",name:"Sparkasse",code:"VARIES",swift:"VARIES"},{id:"de-volksbank",name:"Volksbank",code:"VARIES",swift:"VARIES"},{id:"de-hypovereins",name:"HypoVereinsbank",code:"HYVEDEMMXXX",swift:"HYVEDEMMXXX"}],accountTypes:[{value:"girokonto",label:"Girokonto (Checking)"},{value:"sparkonto",label:"Sparkonto (Savings)"},{value:"tagesgeld",label:"Tagesgeldkonto (Daily Savings)"}],requiredFields:[{field:"iban",label:"IBAN",type:"text",placeholder:"DE89 3704 0044 0532 0130 00",validation:"IBAN",maxLength:34}]},ES:{countryCode:"ES",countryName:"Spain",currency:"EUR",flag:"\uD83C\uDDEA\uD83C\uDDF8",banks:[{id:"es-santander",name:"Banco Santander",code:"BSCHESMMXXX",swift:"BSCHESMMXXX"},{id:"es-bbva",name:"BBVA",code:"BBVAESMMXXX",swift:"BBVAESMMXXX"},{id:"es-caixa",name:"CaixaBank",code:"CAIXESBBXXX",swift:"CAIXESBBXXX"},{id:"es-sabadell",name:"Banco Sabadell",code:"BSABESBBXXX",swift:"BSABESBBXXX"},{id:"es-bankinter",name:"Bankinter",code:"BKBKESMMXXX",swift:"BKBKESMMXXX"},{id:"es-unicaja",name:"Unicaja Banco",code:"UCJAES2MXXX",swift:"UCJAES2MXXX"}],accountTypes:[{value:"corriente",label:"Cuenta Corriente"},{value:"ahorro",label:"Cuenta de Ahorro"},{value:"nomina",label:"Cuenta N\xf3mina"}],requiredFields:[{field:"iban",label:"IBAN",type:"text",placeholder:"ES91 2100 0418 4502 0005 1332",validation:"IBAN",maxLength:34}]},FR:{countryCode:"FR",countryName:"France",currency:"EUR",flag:"\uD83C\uDDEB\uD83C\uDDF7",banks:[{id:"fr-bnp",name:"BNP Paribas",code:"BNPAFRPPXXX",swift:"BNPAFRPPXXX"},{id:"fr-credit-agricole",name:"Cr\xe9dit Agricole",code:"AGRIFRPPXXX",swift:"AGRIFRPPXXX"},{id:"fr-societe",name:"Soci\xe9t\xe9 G\xe9n\xe9rale",code:"SOGEFRPPXXX",swift:"SOGEFRPPXXX"},{id:"fr-credit-mutuel",name:"Cr\xe9dit Mutuel",code:"CMCIFRPPXXX",swift:"CMCIFRPPXXX"},{id:"fr-banque-postale",name:"La Banque Postale",code:"PSSTFRPPXXX",swift:"PSSTFRPPXXX"},{id:"fr-lcl",name:"LCL",code:"CRLYFRPPXXX",swift:"CRLYFRPPXXX"}],accountTypes:[{value:"courant",label:"Compte Courant"},{value:"epargne",label:"Compte \xc9pargne"},{value:"livret_a",label:"Livret A"}],requiredFields:[{field:"iban",label:"IBAN",type:"text",placeholder:"FR14 2004 1010 0505 0001 3M02 606",validation:"IBAN",maxLength:34}]},IT:{countryCode:"IT",countryName:"Italy",currency:"EUR",flag:"\uD83C\uDDEE\uD83C\uDDF9",banks:[{id:"it-unicredit",name:"UniCredit",code:"UNCRITMMXXX",swift:"UNCRITMMXXX"},{id:"it-intesa",name:"Intesa Sanpaolo",code:"BCITITMM",swift:"BCITITMM"},{id:"it-mps",name:"Monte dei Paschi di Siena",code:"PASCITMMXXX",swift:"PASCITMMXXX"},{id:"it-bnl",name:"BNL (BNP Paribas)",code:"BNLIITRR",swift:"BNLIITRR"},{id:"it-banco-bpm",name:"Banco BPM",code:"BAPPIT21",swift:"BAPPIT21"}],accountTypes:[{value:"corrente",label:"Conto Corrente"},{value:"risparmio",label:"Conto di Risparmio"},{value:"deposito",label:"Conto Deposito"}],requiredFields:[{field:"iban",label:"IBAN",type:"text",placeholder:"IT60 X054 2811 1010 0000 0123 456",validation:"IBAN",maxLength:34}]},MX:{countryCode:"MX",countryName:"Mexico",currency:"MXN",flag:"\uD83C\uDDF2\uD83C\uDDFD",banks:[{id:"mx-bbva",name:"BBVA M\xe9xico",code:"012",swift:"BCMRMXMM"},{id:"mx-santander",name:"Santander M\xe9xico",code:"014",swift:"BMSXMXMM"},{id:"mx-banamex",name:"Citibanamex",code:"002",swift:"BNMXMXMM"},{id:"mx-banorte",name:"Banorte",code:"072",swift:"MENOMXMT"},{id:"mx-hsbc",name:"HSBC M\xe9xico",code:"021",swift:"BIMEMXMM"},{id:"mx-scotiabank",name:"Scotiabank",code:"044",swift:"MBCOMXMM"},{id:"mx-inbursa",name:"Inbursa",code:"036",swift:"INBUMXMM"},{id:"mx-azteca",name:"Banco Azteca",code:"127",swift:"AZTKMXMM"}],accountTypes:[{value:"checking",label:"Cuenta de Cheques"},{value:"savings",label:"Cuenta de Ahorro"},{value:"payroll",label:"Cuenta de N\xf3mina"}],requiredFields:[{field:"clabe",label:"CLABE",type:"text",placeholder:"012345678901234567",validation:"CLABE",maxLength:18}]},GB:{countryCode:"GB",countryName:"United Kingdom",currency:"GBP",flag:"\uD83C\uDDEC\uD83C\uDDE7",banks:[{id:"gb-hsbc",name:"HSBC UK",code:"HBUKGB4B",swift:"HBUKGB4B"},{id:"gb-barclays",name:"Barclays",code:"BUKBGB22",swift:"BUKBGB22"},{id:"gb-lloyds",name:"Lloyds Bank",code:"LOYDGB2L",swift:"LOYDGB2L"},{id:"gb-natwest",name:"NatWest",code:"NWBKGB2L",swift:"NWBKGB2L"},{id:"gb-santander",name:"Santander UK",code:"ABBYGB2L",swift:"ABBYGB2L"},{id:"gb-halifax",name:"Halifax",code:"HLFXGB21",swift:"HLFXGB21"},{id:"gb-nationwide",name:"Nationwide",code:"NAIAGB21",swift:"NAIAGB21"},{id:"gb-metro",name:"Metro Bank",code:"MYMBGB2L",swift:"MYMBGB2L"}],accountTypes:[{value:"current",label:"Current Account"},{value:"savings",label:"Savings Account"},{value:"isa",label:"ISA Account"}],requiredFields:[{field:"sortCode",label:"Sort Code",type:"text",placeholder:"12-34-56",validation:"UK Sort Code",maxLength:8},{field:"accountNumber",label:"Account Number",type:"text",placeholder:"12345678",validation:"UK Account Number",maxLength:8}]}};function v({onComplete:e,onSkip:a,requireVerification:t=!1}){let{getToken:h}=(0,m.d)(),[v,k]=(0,n.useState)([]),[B,A]=(0,n.useState)(!0),[w,C]=(0,n.useState)(!1),[S,X]=(0,n.useState)(null),[M,T]=(0,n.useState)(!1),[I,P]=(0,n.useState)(""),[F,E]=(0,n.useState)(null),[U,R]=(0,n.useState)({accountName:"",country:"",bankId:"",accountHolderName:"",accountType:"",isPrimary:!1}),[L,$]=(0,n.useState)({}),[D,H]=(0,n.useState)(""),V=I?j[I]:null,q=async()=>{try{let e=await h(),a=await fetch("http://localhost:4000/api/users/me/bank-accounts",{headers:{Authorization:`Bearer ${e}`}});if(a.ok){let e=await a.json();k(Array.isArray(e)?e:[])}else k([])}catch(e){console.error("Error fetching bank accounts:",e),k([])}finally{A(!1)}},K=()=>{let e={};if(U.accountName.trim()||(e.accountName="Account name is required"),I||(e.country="Please select a country"),F||(e.bankId="Please select a bank"),U.accountHolderName.trim()||(e.accountHolderName="Account holder name is required"),U.accountType||(e.accountType="Account type is required"),V)for(let a of V.requiredFields){let t=U[a.field];if(!t||"string"!=typeof t||!t.trim()){e[a.field]=`${a.label} is required`;continue}switch(a.validation){case"Chilean RUT":!function(e){let a=e.replace(/\./g,"").replace(/-/g,"");if(a.length<8||a.length>9)return!1;let t=a.slice(0,-1),s=a.slice(-1).toUpperCase(),n=0,l=2;for(let e=t.length-1;e>=0;e--)n+=parseInt(t[e])*l,l=7===l?2:l+1;let r=11-n%11;return s===(11===r?"0":10===r?"K":r.toString())}(t)&&(e[a.field]="Invalid RUT format");break;case"IBAN":!function(e){let a=e.replace(/\s/g,"").toUpperCase();if(!/^[A-Z]{2}[0-9]{2}[A-Z0-9]+$/.test(a))return!1;let t={DE:22,ES:24,FR:27,IT:27,GB:22},s=a.substring(0,2);return!t[s]||a.length===t[s]}(t)&&(e[a.field]="Invalid IBAN format");break;case"CLABE":!function(e){let a=e.replace(/\s/g,"");return!!/^\d{18}$/.test(a)}(t)&&(e[a.field]="CLABE must be 18 digits");break;case"US Routing Number":/^\d{9}$/.test(t)||(e[a.field]="Routing number must be 9 digits");break;case"UK Sort Code":!function(e){let a=e.replace(/-/g,"");return/^\d{6}$/.test(a)}(t)&&(e[a.field]="Sort code must be 6 digits")}}return $(e),0===Object.keys(e).length},G=async e=>{if(e.preventDefault(),K()&&F&&V){T(!0);try{let e=await h(),a={accountName:U.accountName,currency:V.currency,country:I,bankName:F.name,bankCode:F.code,accountHolderName:U.accountHolderName,accountType:U.accountType,isPrimary:U.isPrimary};V.requiredFields.forEach(e=>{U[e.field]&&(a[e.field]=U[e.field])});let t=S?`http://localhost:4000/api/users/me/bank-accounts/${S.id}`:"http://localhost:4000/api/users/me/bank-accounts",s=S?"PUT":"POST",n=await fetch(t,{method:s,headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(a)});if(n.ok){let e=await n.json();console.log("Bank account created successfully:",e),await q(),Y(),C(!1),X(null),H(`✅ ${e.bankName} account added successfully! Verification required to start sending money.`),setTimeout(()=>H(""),5e3),console.log("Bank account creation completed, form closed")}else{let e=await n.json();console.error("Failed to save bank account:",e),$({general:e.message||"Failed to save bank account"})}}catch(e){console.error("Error saving bank account:",e),$({general:"Failed to save bank account. Please try again."})}finally{T(!1)}}},O=async e=>{if(confirm("Are you sure you want to delete this bank account?"))try{let a=await h();(await fetch(`http://localhost:4000/api/users/me/bank-accounts/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})).ok?await q():console.error("Failed to delete bank account")}catch(e){console.error("Error deleting bank account:",e)}},Y=()=>{P(""),E(null),R({accountName:"",country:"",bankId:"",accountHolderName:"",accountType:"",isPrimary:!1}),$({}),H("")},z=e=>{let a=e.country,t=j[a],s=t?.banks.find(a=>a.code===e.bankCode);P(a),E(s||null);let n={accountName:e.accountName,country:a,bankId:s?.id||"",accountHolderName:e.accountHolderName,accountType:e.accountType||"",isPrimary:e.isPrimary};e.iban&&(n.iban=e.iban),e.accountNumber&&(n.accountNumber=e.accountNumber),e.routingNumber&&(n.routingNumber=e.routingNumber),e.rut&&(n.rut=e.rut),e.clabe&&(n.clabe=e.clabe),e.sortCode&&(n.sortCode=e.sortCode),e.ukAccountNumber&&(n.ukAccountNumber=e.ukAccountNumber),R(n),X(e),C(!0)},Z=Array.isArray(v)&&v.some(e=>e.isVerified);return B?(0,s.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Bank Account Setup"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Add and verify your bank accounts to start sending money globally."})]}),D&&(0,s.jsx)(l.Zp,{className:"border-green-200 bg-green-50",children:(0,s.jsx)(l.Wu,{className:"py-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.A,{className:"h-5 w-5 text-green-600"}),(0,s.jsx)("span",{className:"font-medium text-green-700",children:D})]})})}),Array.isArray(v)&&v.length>0&&(0,s.jsx)(l.Zp,{className:Z?"border-green-200 bg-green-50":"border-amber-200 bg-amber-50",children:(0,s.jsx)(l.Wu,{className:"py-4",children:(0,s.jsx)("div",{className:"flex items-center gap-2",children:Z?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.A,{className:"h-5 w-5 text-green-600"}),(0,s.jsxs)("span",{className:"font-medium text-green-700",children:["You have ",v.filter(e=>e.isVerified).length," verified account(s)"]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.A,{className:"h-5 w-5 text-amber-600"}),(0,s.jsx)("span",{className:"font-medium text-amber-700",children:"Verification required for your bank account(s)"})]})})})}),Array.isArray(v)&&v.length>0&&(0,s.jsx)("div",{className:"space-y-3",children:v.map(e=>(0,s.jsx)(l.Zp,{className:"relative",children:(0,s.jsx)(l.Wu,{className:"py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(p,{className:"h-8 w-8 text-gray-400"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("h4",{className:"font-semibold",children:e.accountName}),e.isPrimary&&(0,s.jsx)(o.E,{variant:"secondary",children:"Primary"}),(0,s.jsx)(o.E,{variant:e.isVerified?"default":"outline",children:e.isVerified?"Verified":"Pending"})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[e.bankName," • ",e.currency," •","checking"===e.accountType?" Checking":" Savings"]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:j[e.country]?.countryName}),!e.isVerified&&(0,s.jsxs)("p",{className:"text-xs text-amber-600 mt-1 flex items-center gap-1",children:[(0,s.jsx)(x.A,{className:"h-3 w-3"}),"Verification required to send money"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[!e.isVerified&&(0,s.jsx)(r.$,{variant:"outline",size:"sm",className:"border-blue-500 text-blue-600 hover:bg-blue-50",onClick:()=>{alert("Verification flow would start here. This connects to the verification system.")},children:"Verify Account"}),(0,s.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>z(e),children:(0,s.jsx)(b,{className:"h-4 w-4"})}),(0,s.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>O(e.id),children:(0,s.jsx)(f,{className:"h-4 w-4 text-red-500"})})]})]})})},e.id))}),!w&&(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(r.$,{onClick:()=>{Y(),C(!0)},className:"flex-1",variant:"outline",children:[(0,s.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Add Bank Account"]}),a&&!t&&(0,s.jsx)(r.$,{onClick:a,variant:"ghost",children:"Skip for now"})]}),w&&(0,s.jsxs)(l.Zp,{children:[(0,s.jsxs)(l.aR,{children:[(0,s.jsx)(l.ZB,{children:S?"Edit Bank Account":"Add New Bank Account"}),(0,s.jsx)(l.BT,{children:"Select your country first, then choose your bank and provide account details."})]}),(0,s.jsx)(l.Wu,{children:(0,s.jsxs)("form",{onSubmit:G,className:"space-y-6",children:[L.general&&(0,s.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,s.jsx)("p",{className:"text-sm text-red-600",children:L.general})}),(0,s.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[(0,s.jsx)(y.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Step 1: Select Your Country"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.J,{htmlFor:"country",children:"Country"}),(0,s.jsxs)(d.l6,{value:I,onValueChange:e=>{P(e),E(null);let a=j[e];R({accountName:"",country:e,bankId:"",accountHolderName:"",accountType:a?.accountTypes[0]?.value||"",isPrimary:!Array.isArray(v)||0===v.length}),$({})},children:[(0,s.jsx)(d.bq,{className:L.country?"border-red-500":"",children:(0,s.jsx)(d.yv,{placeholder:"Choose your country"})}),(0,s.jsx)(d.gC,{children:Object.values(j).sort((e,a)=>e.countryName.localeCompare(a.countryName)).map(e=>(0,s.jsx)(d.eb,{value:e.countryCode,children:(0,s.jsxs)("span",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{children:e.flag}),(0,s.jsx)("span",{children:e.countryName}),(0,s.jsxs)("span",{className:"text-gray-500",children:["(",e.currency,")"]})]})},e.countryCode))})]}),L.country&&(0,s.jsx)("p",{className:"text-sm text-red-500 mt-1",children:L.country})]})]}),I&&V&&(0,s.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[(0,s.jsx)(p,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Step 2: Select Your Bank"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.J,{htmlFor:"bank",children:"Bank"}),(0,s.jsxs)(d.l6,{value:U.bankId,onValueChange:e=>{V&&(E(V.banks.find(a=>a.id===e)||null),R(a=>({...a,bankId:e})))},children:[(0,s.jsx)(d.bq,{className:L.bankId?"border-red-500":"",children:(0,s.jsx)(d.yv,{placeholder:"Choose your bank"})}),(0,s.jsx)(d.gC,{children:V.banks.map(e=>(0,s.jsx)(d.eb,{value:e.id,children:e.name},e.id))})]}),L.bankId&&(0,s.jsx)("p",{className:"text-sm text-red-500 mt-1",children:L.bankId})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.J,{htmlFor:"accountType",children:"Account Type"}),(0,s.jsxs)(d.l6,{value:U.accountType,onValueChange:e=>R(a=>({...a,accountType:e})),children:[(0,s.jsx)(d.bq,{className:L.accountType?"border-red-500":"",children:(0,s.jsx)(d.yv,{placeholder:"Select account type"})}),(0,s.jsx)(d.gC,{children:V.accountTypes.map(e=>(0,s.jsx)(d.eb,{value:e.value,children:e.label},e.value))})]}),L.accountType&&(0,s.jsx)("p",{className:"text-sm text-red-500 mt-1",children:L.accountType})]})]}),F&&V&&(0,s.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[(0,s.jsx)(N.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Step 3: Account Details"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.J,{htmlFor:"accountName",children:"Account Nickname"}),(0,s.jsx)(c.p,{id:"accountName",value:U.accountName,onChange:e=>R(a=>({...a,accountName:e.target.value})),placeholder:"e.g., My Chilean Account",className:L.accountName?"border-red-500":""}),L.accountName&&(0,s.jsx)("p",{className:"text-sm text-red-500 mt-1",children:L.accountName})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.J,{htmlFor:"accountHolderName",children:"Account Holder Name"}),(0,s.jsx)(c.p,{id:"accountHolderName",value:U.accountHolderName,onChange:e=>R(a=>({...a,accountHolderName:e.target.value})),placeholder:"Full name as it appears on the account",className:L.accountHolderName?"border-red-500":""}),L.accountHolderName&&(0,s.jsx)("p",{className:"text-sm text-red-500 mt-1",children:L.accountHolderName})]}),V?V.requiredFields.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsx)(i.J,{htmlFor:e.field,children:e.label}),(0,s.jsx)(c.p,{id:e.field,type:e.type,value:U[e.field]||"",onChange:a=>{let t=a.target.value;"rut"===e.field?t=function(e){let a=e.replace(/\./g,"").replace(/-/g,"");if(a.length<2)return a;let t=a.slice(0,-1),s=a.slice(-1),n=t.replace(/\B(?=(\d{3})+(?!\d))/g,".");return`${n}-${s}`}(t):"sortCode"===e.field&&(t=function(e){let a=e.replace(/-/g,"");return a.length>=4?`${a.slice(0,2)}-${a.slice(2,4)}-${a.slice(4,6)}`:a}(t)),R(a=>({...a,[e.field]:t}))},placeholder:e.placeholder,maxLength:e.maxLength,className:L[e.field]?"border-red-500":""}),L[e.field]&&(0,s.jsx)("p",{className:"text-sm text-red-500 mt-1",children:L[e.field]})]},e.field)):null,Array.isArray(v)&&v.length>0&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",id:"isPrimary",checked:U.isPrimary,onChange:e=>R(a=>({...a,isPrimary:e.target.checked})),className:"rounded border-gray-300"}),(0,s.jsxs)(i.J,{htmlFor:"isPrimary",className:"text-sm font-normal",children:["Set as primary account for ",V.currency]})]})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(r.$,{type:"submit",disabled:M,className:"flex-1",children:M?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):S?"Update Account":"Add Account"}),(0,s.jsx)(r.$,{type:"button",variant:"outline",onClick:()=>{C(!1),X(null),Y()},children:"Cancel"})]})]})})]})]})}function k({children:e,requireVerification:a=!1,onOnboardingComplete:t,skipCheckOnPublicPages:l=!1,blockTransfersUntilVerified:r=!1}){let[c,i]=(0,n.useState)(!0),[d,o]=(0,n.useState)(!1),[m,u]=(0,n.useState)([]);return c?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[200px]",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Checking account status..."})]})}):d?(0,s.jsx)(v,{onComplete:()=>{o(!1),t&&t()},onSkip:a||r?void 0:()=>{r||o(!1)},requireVerification:a||r}):(0,s.jsx)(s.Fragment,{children:e})}},23365:(e,a,t)=>{t.d(a,{A:()=>s});let s=(0,t(84667).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},31461:(e,a,t)=>{t.d(a,{A:()=>s});let s=(0,t(84667).A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},58350:(e,a,t)=>{t.d(a,{A:()=>s});let s=(0,t(84667).A)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},62367:(e,a,t)=>{t.d(a,{Y:()=>u});var s=t(13486),n=t(60159),l=t(23365),r=t(59203),c=t(31461),i=t(63821),d=t(86e3),o=t(29563),m=t(74941);function u({transferId:e,onRefresh:a,autoRefresh:t=!0,refreshInterval:u=5e3}){let[x,h]=(0,n.useState)(null),[p,b]=(0,n.useState)(!0),[f,g]=(0,n.useState)(null),[y,N]=(0,n.useState)(new Date),[j,v]=(0,n.useState)(!1),k=async(a=!0)=>{try{a&&b(!0),g(null);let t=await fetch(`http://localhost:4000/api/transfers/${e}/status`);if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.message||"Failed to fetch transfer status")}let s=await t.json();h(s),N(new Date),v(!0)}catch(e){console.error("Transfer status fetch error:",e),g(e instanceof Error?e.message:"Failed to fetch transfer status"),v(!1)}finally{a&&b(!1)}},B=()=>{k(!0),a&&a()},A=(e,a)=>new Intl.NumberFormat("en-US",{style:"currency",currency:a,minimumFractionDigits:2,maximumFractionDigits:2}).format(e),w=e=>new Date(e).toLocaleString(),C=e=>{switch(e){case"success":return{color:"text-green-600",icon:i.A};case"pending":return{color:"text-yellow-600",icon:l.A};case"failed":return{color:"text-red-600",icon:d.A};default:return{color:"text-gray-600",icon:l.A}}};if(p&&!x)return(0,s.jsx)(o.Zp,{className:"w-full max-w-2xl mx-auto",children:(0,s.jsxs)(o.Wu,{className:"flex items-center justify-center py-8",children:[(0,s.jsx)(r.A,{className:"h-6 w-6 animate-spin text-muted-foreground mr-2"}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"Loading transfer status..."})]})});if(f&&!x)return(0,s.jsx)(o.Zp,{className:"w-full max-w-2xl mx-auto",children:(0,s.jsx)(o.Wu,{className:"py-8",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(d.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"Error Loading Transfer"}),(0,s.jsx)("p",{className:"text-red-600 mb-4",children:f}),(0,s.jsxs)(m.$,{onClick:B,variant:"outline",children:[(0,s.jsx)(r.A,{className:"h-4 w-4 mr-2"}),"Try Again"]})]})})});if(!x)return(0,s.jsx)(o.Zp,{className:"w-full max-w-2xl mx-auto",children:(0,s.jsx)(o.Wu,{className:"py-8",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(d.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Transfer Not Found"}),(0,s.jsxs)("p",{className:"text-gray-600",children:["No transfer data available for ID: ",e]})]})})});let S=(e=>{switch(e){case"initiated":return{color:"text-blue-600",bgColor:"bg-blue-50",icon:l.A,label:"Initiated"};case"payment_processing":return{color:"text-yellow-600",bgColor:"bg-yellow-50",icon:r.A,label:"Processing Payment"};case"transferring":return{color:"text-blue-600",bgColor:"bg-blue-50",icon:c.A,label:"Transferring"};case"paying_out":return{color:"text-purple-600",bgColor:"bg-purple-50",icon:r.A,label:"Paying Out"};case"completed":return{color:"text-green-600",bgColor:"bg-green-50",icon:i.A,label:"Completed"};case"failed":return{color:"text-red-600",bgColor:"bg-red-50",icon:d.A,label:"Failed"};default:return{color:"text-gray-600",bgColor:"bg-gray-50",icon:l.A,label:"Unknown"}}})(x.status),X=S.icon,M=(e=>{switch(e){case"initiated":return 20;case"payment_processing":return 40;case"transferring":return 60;case"paying_out":return 80;case"completed":return 100;default:return 0}})(x.status);return(0,s.jsxs)(o.Zp,{className:"w-full max-w-2xl mx-auto shadow-sm",children:[(0,s.jsxs)(o.aR,{className:"pb-4",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,s.jsxs)(o.ZB,{className:"flex items-center gap-2 text-lg",children:[(0,s.jsx)(X,{className:`h-5 w-5 ${S.color}`}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Transfer Status"}),(0,s.jsx)("span",{className:"sm:hidden",children:"Status"})]}),(0,s.jsxs)(m.$,{onClick:B,variant:"outline",size:"sm",disabled:p,className:"self-start sm:self-auto",children:[(0,s.jsx)(r.A,{className:`h-4 w-4 mr-2 ${p?"animate-spin":""}`}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Refresh"}),(0,s.jsx)("span",{className:"sm:hidden",children:"Update"})]})]}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground break-all sm:break-normal",children:["ID: ",x.transferId]})]}),(0,s.jsxs)(o.Wu,{className:"space-y-6",children:[(0,s.jsx)("div",{className:`rounded-lg p-4 ${S.bgColor}`,children:(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(X,{className:`h-6 w-6 ${S.color}`}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:`font-semibold ${S.color}`,children:S.label}),x.estimatedCompletion&&"completed"!==x.status&&(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Estimated completion: ",w(x.estimatedCompletion)]}),x.completedAt&&(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Completed: ",w(x.completedAt)]})]})]})})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm text-muted-foreground",children:[(0,s.jsx)("span",{children:"Progress"}),(0,s.jsxs)("span",{children:[M,"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:`h-2 rounded-full transition-all duration-500 ${"failed"===x.status?"bg-red-500":"bg-blue-500"}`,style:{width:`${M}%`}})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"You sent"}),(0,s.jsx)("p",{className:"font-semibold",children:A(x.sendAmount,"USD")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Recipient gets"}),(0,s.jsx)("p",{className:"font-semibold text-green-600",children:A(x.receiveAmount,"EUR")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Exchange rate"}),(0,s.jsxs)("p",{className:"font-semibold",children:["1 USD = ",x.exchangeRate.toFixed(4)," EUR"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Fees"}),(0,s.jsx)("p",{className:"font-semibold",children:A(x.fees,"USD")})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Timeline"}),j&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-xs text-green-600",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Live updates"]})]}),(0,s.jsx)("div",{className:"relative",children:0===x.timeline.length?(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,s.jsx)(l.A,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,s.jsx)("p",{children:"No timeline events yet"})]}):(0,s.jsx)("div",{className:"space-y-4",children:x.timeline.map((e,a)=>{let t=C(e.status),n=t.icon,l=a===x.timeline.length-1,r=new Date(e.timestamp)>new Date(Date.now()-3e5);return(0,s.jsxs)("div",{className:`flex items-start gap-3 p-3 rounded-lg transition-all duration-300 ${r?"bg-blue-50 border border-blue-200":"hover:bg-gray-50"}`,children:[(0,s.jsxs)("div",{className:"flex flex-col items-center relative",children:[(0,s.jsx)("div",{className:`p-1 rounded-full ${"success"===e.status?"bg-green-100":"pending"===e.status?"bg-yellow-100":"bg-red-100"}`,children:(0,s.jsx)(n,{className:`h-4 w-4 ${t.color}`})}),!l&&(0,s.jsx)("div",{className:`w-px h-8 mt-2 ${"success"===e.status?"bg-green-300":"bg-gray-300"}`})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1",children:[(0,s.jsx)("p",{className:"font-medium text-sm sm:text-base",children:e.message}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[r&&(0,s.jsx)("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full",children:"New"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:w(e.timestamp)})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,s.jsx)("p",{className:`text-xs capitalize font-medium ${t.color}`,children:e.status}),e.metadata&&Object.keys(e.metadata).length>0&&(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"• Additional details available"})]})]})]},e.id)})})})]}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground text-center border-t pt-4",children:["Last updated: ",w(x.lastUpdated),t&&"completed"!==x.status&&"failed"!==x.status&&(0,s.jsxs)("span",{className:"ml-2",children:["• Auto-refreshing every ",u/1e3,"s"]})]})]})]})}},74439:(e,a,t)=>{t.d(a,{A:()=>s});let s=(0,t(84667).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},93858:(e,a,t)=>{t.d(a,{Z:()=>d});var s=t(13486),n=t(68551),l=t(57956),r=t(97493),c=t(63821);let i=[{key:"calculator",label:"Calculate",shortLabel:"Calc",icon:n.A,description:"Enter transfer amount"},{key:"recipient",label:"Recipient",shortLabel:"Recipient",icon:l.A,description:"Add recipient details"},{key:"payment",label:"Payment",shortLabel:"Pay",icon:r.A,description:"Complete payment"},{key:"status",label:"Status",shortLabel:"Status",icon:c.A,description:"Track transfer"}];function d({currentStep:e,completedSteps:a,onStepClick:t}){let n=i.findIndex(a=>a.key===e),l=(t,s)=>a.includes(t.key)?"completed":t.key===e?"current":s<n?"completed":"upcoming",r=(e,a)=>{let t="relative flex items-center justify-center w-10 h-10 rounded-full border-2 transition-all duration-200",s=a?"cursor-pointer hover:scale-105":"";switch(e){case"completed":return`${t} ${s} bg-green-500 border-green-500 text-white`;case"current":return`${t} ${s} bg-blue-500 border-blue-500 text-white ring-4 ring-blue-100`;default:return`${t} bg-gray-100 border-gray-300 text-gray-400`}},d=e=>{let t=e<n||a.includes(i[e].key);return`flex-1 h-0.5 mx-2 transition-colors duration-300 ${t?"bg-green-500":"bg-gray-300"}`},o=s=>{t&&(a.includes(s.key)||s.key===e)&&t(s.key)};return(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("div",{className:"hidden md:block",children:(0,s.jsx)("div",{className:"flex items-center justify-between",children:i.map((t,n)=>{let m=l(t,n),u=a.includes(t.key)||t.key===e,x=t.icon;return(0,s.jsxs)("div",{className:"flex items-center flex-1",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("div",{className:r(m,u),onClick:()=>o(t),role:u?"button":void 0,tabIndex:u?0:void 0,onKeyDown:e=>{u&&("Enter"===e.key||" "===e.key)&&(e.preventDefault(),o(t))},children:"completed"===m?(0,s.jsx)(c.A,{className:"w-5 h-5"}):(0,s.jsx)(x,{className:"w-5 h-5"})}),(0,s.jsxs)("div",{className:"mt-2 text-center",children:[(0,s.jsx)("div",{className:`text-sm font-medium ${"current"===m?"text-blue-600":"completed"===m?"text-green-600":"text-gray-500"}`,children:t.label}),(0,s.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:t.description})]})]}),n<i.length-1&&(0,s.jsx)("div",{className:d(n)})]},t.key)})})}),(0,s.jsxs)("div",{className:"md:hidden",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-4",children:i.map((t,d)=>{let m=l(t,d),u=a.includes(t.key)||t.key===e,x=t.icon;return(0,s.jsxs)("div",{className:"flex items-center flex-1",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("div",{className:r(m,u),onClick:()=>o(t),role:u?"button":void 0,tabIndex:u?0:void 0,onKeyDown:e=>{u&&("Enter"===e.key||" "===e.key)&&(e.preventDefault(),o(t))},children:"completed"===m?(0,s.jsx)(c.A,{className:"w-4 h-4"}):(0,s.jsx)(x,{className:"w-4 h-4"})}),(0,s.jsx)("div",{className:"mt-1 text-center",children:(0,s.jsx)("div",{className:`text-xs font-medium ${"current"===m?"text-blue-600":"completed"===m?"text-green-600":"text-gray-500"}`,children:t.shortLabel})})]}),d<i.length-1&&(0,s.jsx)("div",{className:`flex-1 h-0.5 mx-1 ${d<n||a.includes(i[d].key)?"bg-green-500":"bg-gray-300"}`})]},t.key)})}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["Step ",n+1," of ",i.length,": ",i[n]?.description]})})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[(0,s.jsx)("span",{children:"Progress"}),(0,s.jsxs)("span",{children:[Math.round((n+1)/i.length*100),"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${(n+1)/i.length*100}%`}})})]})]})}}};