"use strict";exports.id=560,exports.ids=[560],exports.modules={9431:(e,s,a)=>{a.d(s,{A:()=>r});let r=(0,a(84667).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},34560:(e,s,a)=>{a.d(s,{E:()=>b});var r=a(13486),t=a(60159),l=a(74941),c=a(29563),n=a(23025),i=a(41571),d=a(20276),x=a(57956),m=a(63821),h=a(83991),o=a(21800),u=a(23365),j=a(86e3),p=a(97493),y=a(9431);let N=(0,a(84667).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);var f=a(15577),g=a(15998),v=a(31461);function b({transferData:e,onRecipientSelected:s,onBack:a,currentUserId:b,isLoading:w=!1}){let[C,A]=(0,t.useState)(""),[k,S]=(0,t.useState)([]),[F,R]=(0,t.useState)(!1),[Z,$]=(0,t.useState)(null),[P,D]=(0,t.useState)(!1),[E,M]=(0,t.useState)([]),[W,L]=(0,t.useState)(!1),[T,U]=(0,t.useState)(null),[B,z]=(0,t.useState)(null),[q,I]=(0,t.useState)(null),[V,Y]=(0,t.useState)("recent");(0,t.useCallback)(async()=>{if(b){L(!0),U(null);try{let e=await fetch("http://localhost:4000/api/users/me/recipients",{headers:{Authorization:`Bearer ${await H()}`,"Content-Type":"application/json"}});if(!e.ok)throw Error("Failed to load recent recipients");let s=await e.json();M(s.recipients||[])}catch(e){console.error("Error loading recent recipients:",e),U("Failed to load recent recipients"),M([])}finally{L(!1)}}},[b]),(0,t.useCallback)(async s=>{R(!0),$(null);try{let a=new URLSearchParams({q:s,currency:e.receiveCurrency,limit:"10"}),r=await fetch(`http://localhost:4000/api/users/search?${a}`,{headers:{Authorization:`Bearer ${await H()}`,"Content-Type":"application/json"}});if(!r.ok)throw Error("Failed to search users");let t=(await r.json()).users.filter(e=>e.id!==b);S(t),D(!0)}catch(e){console.error("Error searching users:",e),$("Failed to search users. Please try again."),S([])}finally{R(!1)}},[e.receiveCurrency,b]);let H=async()=>"",J=s=>{z(s);let a=s.verifiedPaymentMethods.filter(s=>s.currency===e.receiveCurrency),r=a.find(e=>e.isDefault)||a[0];r&&I(r)},_=e=>{I(e)},G=(s,a=!1,t)=>{let l=s.verifiedPaymentMethods.filter(s=>s.currency===e.receiveCurrency),n=B?.id===s.id;return(0,r.jsx)(c.Zp,{className:`cursor-pointer transition-all hover:shadow-md ${n?"ring-2 ring-blue-500 bg-blue-50":""}`,onClick:()=>J(s),children:(0,r.jsx)(c.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:s.profileImageUrl?(0,r.jsx)("img",{src:s.profileImageUrl,alt:s.fullName,className:"w-12 h-12 rounded-full object-cover"}):(0,r.jsx)("div",{className:"w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center",children:(0,r.jsx)(x.A,{className:"w-6 h-6 text-gray-500"})})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:s.fullName}),s.isVerified&&(0,r.jsx)(m.A,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),a&&t?.isFavorite&&(0,r.jsx)(h.A,{className:"w-4 h-4 text-yellow-500 flex-shrink-0"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mb-2",children:[s.email&&(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(o.A,{className:"w-3 h-3"}),(0,r.jsx)("span",{className:"truncate",children:s.email})]}),s.username&&(0,r.jsx)("div",{className:"flex items-center space-x-1",children:(0,r.jsxs)("span",{children:["@",s.username]})})]}),a&&t&&(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(u.A,{className:"w-3 h-3"}),(0,r.jsxs)("span",{children:["Last: ",new Date(t.lastTransferAt).toLocaleDateString()]})]}),(0,r.jsxs)("div",{children:[t.transferCount," transfer",1!==t.transferCount?"s":""]})]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mb-2",children:s.supportedCurrencies.map(s=>(0,r.jsx)(d.E,{variant:s===e.receiveCurrency?"default":"secondary",className:"text-xs",children:s},s))}),l.length>0?(0,r.jsxs)("div",{className:"text-xs text-green-600",children:["✓ ",l.length," verified account",1!==l.length?"s":""," for ",e.receiveCurrency]}):(0,r.jsxs)("div",{className:"text-xs text-red-600",children:["✗ No verified accounts for ",e.receiveCurrency]})]})]})})},s.id)};return(0,r.jsxs)("div",{className:"w-full max-w-4xl mx-auto space-y-6",children:[(0,r.jsx)(c.Zp,{children:(0,r.jsxs)(c.aR,{children:[(0,r.jsxs)(c.ZB,{className:"flex items-center space-x-2",children:[(0,r.jsx)(y.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:"Send to User"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Send ",e.sendAmount," ",e.sendCurrency," to a registered user"]})]})}),(0,r.jsx)(c.Zp,{className:"bg-gray-50",children:(0,r.jsxs)(c.Wu,{className:"p-4",children:[(0,r.jsx)("h3",{className:"font-semibold mb-2",children:"Transfer Summary"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"You Send:"}),(0,r.jsxs)("span",{className:"font-medium",children:[e.sendAmount," ",e.sendCurrency]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"They Receive:"}),(0,r.jsxs)("span",{className:"font-medium",children:[e.receiveAmount," ",e.receiveCurrency]})]}),(0,r.jsxs)("div",{className:"flex justify-between col-span-2",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Exchange Rate:"}),(0,r.jsxs)("span",{className:"font-medium",children:["1 ",e.sendCurrency," = ",e.exchangeRate.toFixed(4)," ",e.receiveCurrency]})]})]})]})}),(0,r.jsxs)("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:[(0,r.jsxs)("button",{className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${"recent"===V?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,onClick:()=>Y("recent"),children:[(0,r.jsx)(u.A,{className:"w-4 h-4 inline mr-2"}),"Recent Recipients"]}),(0,r.jsxs)("button",{className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${"search"===V?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,onClick:()=>Y("search"),children:[(0,r.jsx)(N,{className:"w-4 h-4 inline mr-2"}),"Search Users"]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:["search"===V&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(i.J,{htmlFor:"user-search",children:"Search by email, username, or phone"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)(n.p,{id:"user-search",placeholder:"Enter email, username, or phone number...",className:"pl-10",value:C,onChange:e=>A(e.target.value)}),F&&(0,r.jsx)(f.A,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 animate-spin text-gray-400"})]})]}),Z&&(0,r.jsx)(c.Zp,{className:"border-red-200 bg-red-50",children:(0,r.jsx)(c.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-red-700",children:[(0,r.jsx)(j.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:Z})]})})}),P&&!F&&0===k.length&&!Z&&(0,r.jsx)(c.Zp,{children:(0,r.jsxs)(c.Wu,{className:"p-8 text-center",children:[(0,r.jsx)(y.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No users found"}),(0,r.jsxs)("p",{className:"text-gray-600",children:['No users found matching "',C,'". Try a different search term.']})]})}),k.length>0&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("h3",{className:"text-sm font-medium text-gray-700",children:["Search Results (",k.length,")"]}),k.map(e=>G(e))]})]}),"recent"===V&&(0,r.jsxs)(r.Fragment,{children:[T&&(0,r.jsx)(c.Zp,{className:"border-red-200 bg-red-50",children:(0,r.jsx)(c.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-red-700",children:[(0,r.jsx)(j.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:T})]})})}),W?(0,r.jsx)(c.Zp,{children:(0,r.jsxs)(c.Wu,{className:"p-8 text-center",children:[(0,r.jsx)(f.A,{className:"w-8 h-8 animate-spin text-gray-400 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading recent recipients..."})]})}):0===E.length?(0,r.jsx)(c.Zp,{children:(0,r.jsxs)(c.Wu,{className:"p-8 text-center",children:[(0,r.jsx)(u.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No recent recipients"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"You haven't sent money to any users yet. Use the search tab to find someone to send money to."}),(0,r.jsxs)(l.$,{variant:"outline",onClick:()=>Y("search"),children:[(0,r.jsx)(N,{className:"w-4 h-4 mr-2"}),"Search Users"]})]})}):(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("h3",{className:"text-sm font-medium text-gray-700",children:["Recent Recipients (",E.length,")"]}),E.map(e=>G(e.userProfile,!0,e))]})]})]}),B&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Selected Recipient"}),G(B),(()=>{if(!B)return null;let s=B.verifiedPaymentMethods.filter(s=>s.currency===e.receiveCurrency);return 0===s.length?(0,r.jsx)(c.Zp,{className:"border-red-200 bg-red-50",children:(0,r.jsxs)(c.Wu,{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-red-700",children:[(0,r.jsx)(j.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"font-medium",children:"No Compatible Payment Methods"})]}),(0,r.jsxs)("p",{className:"text-red-600 text-sm mt-1",children:[B.fullName," doesn't have any verified accounts that can receive ",e.receiveCurrency,"."]})]})}):(0,r.jsxs)(c.Zp,{children:[(0,r.jsxs)(c.aR,{children:[(0,r.jsx)(c.ZB,{className:"text-sm",children:"Select Payment Method"}),(0,r.jsxs)("p",{className:"text-xs text-gray-600",children:["Choose how ",B.fullName," should receive the ",e.receiveCurrency]})]}),(0,r.jsx)(c.Wu,{className:"space-y-2",children:s.map(e=>(0,r.jsx)("div",{className:`p-3 border rounded-lg cursor-pointer transition-all ${q?.id===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>_(e),children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(p.A,{className:"w-4 h-4 text-gray-500"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:e.bankName||`${e.type.replace("_"," ")}`}),e.isDefault&&(0,r.jsx)(d.E,{variant:"secondary",className:"text-xs",children:"Default"})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[e.accountType," • ",e.currency," • ",e.country,e.lastFourDigits&&` • ****${e.lastFourDigits}`]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400",children:["Verified ",new Date(e.verifiedAt).toLocaleDateString()]})]}),q?.id===e.id&&(0,r.jsx)(m.A,{className:"w-4 h-4 text-blue-500"})]})},e.id))})]})})()]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)(l.$,{variant:"outline",onClick:a,disabled:w,children:[(0,r.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Back"]}),(0,r.jsx)(l.$,{onClick:()=>{B&&q&&s(B,q)},disabled:!B||!q||w,children:w?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):(0,r.jsxs)(r.Fragment,{children:["Continue to Payment",(0,r.jsx)(v.A,{className:"ml-2 h-4 w-4"})]})})]})]})}},83991:(e,s,a)=>{a.d(s,{A:()=>r});let r=(0,a(84667).A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])}};